<!DOCTYPE html><html><head><title>Twilio Chat</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Twilio Chat"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Twilio Chat</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>Learn to implement a simple chat application using Twilio Chat Client</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Twilio Chat Objective-C" class="chapter"><div data-title="Introduction" data-file="twiliochat/AppDelegate.m" class="step"><h2 id="introduction">Introduction</h2>
<p>Ready to implement a chat application using Twilio Programmable Chat Client?
Here is how it works at a high level:</p>
<ol>
<li><p><a href="//www.twilio.com/chat">Twilio Programmable Chat</a> is the core product
we&#39;ll be using to handle all the chat functionality.</p>
</li>
<li><p>We use a server side app to generate <a href="//www.twilio.com/docs/api/chat/guides/identity#server-create-an-access-token">user access
tokens</a> which contains
all your Twilio account information. The Chat Client uses this token
to connect with the API</p>
</li>
<li><p><a href="//media.twiliocdn.com/sdk/ios/accessmanager/releases/0.1.2/docs/Classes/TwilioAccessManager.html">Twilio Access Manager</a>
is the part of the SDK than handles access tokens and even refreshes them upon token
expiration.</p>
</li>
</ol>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="//www.twilio.com/docs/api/chat">Programmable Chat API</a></li>
<li><a href="//www.twilio.com/docs/api/chat/guides/quickstart-ios">iOS QuickStart</a></li>
<li><a href="//www.twilio.com/docs/api/chat/guides/channels">Channels and Messages</a></li>
<li><a href="//www.twilio.com/docs/api/chat/guides/identity">User Identity &amp; Access Tokens</a></li>
<li><a href="//media.twiliocdn.com/sdk/ios/chat/releases/0.16.0/docs/">Twilio Chat Client Reference</a></li>
<li><a href="//media.twiliocdn.com/sdk/ios/accessmanager/releases/0.1.2/docs/">Twilio Access Manager Reference</a></li>
</ul>
</div><div data-title="Initializing the Client" data-file="twiliochat/MessagingManager.m" data-highlight="86-119" class="step"><h2 id="initializing-the-chat-client">Initializing the Chat Client</h2>
<p>The only thing you need to create a client is an access token. This token
holds information about your Twilio account and Chat API keys. We have created a web
version of Twilio chat in different languages. You can use any of these to generate the token:</p>
<ul>
<li><a href="//github.com/TwilioDevEd/twiliochat-laravel">PHP - Laravel</a></li>
<li><a href="//github.com/TwilioDevEd/twiliochat-csharp">C# - .NET MVC</a></li>
<li><a href="//github.com/TwilioDevEd/twiliochat-servlets">Java - Servlets</a></li>
<li><a href="//github.com/TwilioDevEd/twiliochat-node">JS - Node</a></li>
</ul>
<p>We use <a href="//github.com/AFNetworking/AFNetworking">AFNetworking</a>
to make a request to our server and get the access token.</p>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="//github.com/AFNetworking/AFNetworking#creating-a-data-task">AFNetworking Data Task</a></li>
</ul>
</div><div data-title="Synchronizing the Client" data-file="twiliochat/MessagingManager.m" data-highlight="185-195" data-mode="swift" class="step"><h2 id="synchronizing-the-chat-client">Synchronizing the Chat Client</h2>
<p>In the previous step we initialized the
<a href="//media.twiliocdn.com/sdk/ios/chat/releases/0.16.0/docs/Classes/TwilioChatClient.html">Chat client</a>
with an <a href="//media.twiliocdn.com/sdk/ios/accessmanager/releases/0.1.2/docs/Classes/TwilioAccessManager.html">Access Manager</a>
and set the client&#39;s delegate to the shared instance of our <code>MessagingManager</code>.</p>
<p>The <code>synchronizationStatusChanged</code>
<a href="//media.twiliocdn.com/sdk/ios/chat/releases/0.16.0/docs/Protocols/TwilioChatClientDelegate.html">delegate</a>
method will allow us to know when the client has loaded all the required information.
You can change the default initialization values for the client using a
<a href="//media.twiliocdn.com/sdk/ios/chat/releases/0.16.0/docs/Classes/TwilioChatClientProperties.html">TwilioChatClientProperties</a>
instance as the <code>options</code> parameter in the previews step.</p>
<p>We need the client to be synchronized before trying to get the channel list (next step).
Otherwise, calling <a href="//media.twiliocdn.com/sdk/ios/chat/releases/0.16.0/docs/Classes/TwilioChatClient.html#//api/name/channelsList">client.channelsList()</a>
will return <code>nil</code>.</p>
</div><div data-title="Getting the Channel List" data-file="twiliochat/ChannelManager.m" data-highlight="92-113" class="step"><h2 id="getting-the-channel-list">Getting the Channel List</h2>
<p>Our <code>ChannelManager</code> class takes care of everything related to channels.
In the previous step, we waited for the client to synchronize channel information,
and assigned an instance of
<a href="//media.twiliocdn.com/sdk/ios/chat/releases/0.16.0/docs/Classes/TCHChannels.html">TCHChannelList</a>
to our <code>ChannelManager</code>. Now we must get an actual array of channels using
the <code>userChannelsWithCompletion</code> and <code>publicChannelsWithCompletion</code> methods.</p>
</div><div data-title="Listen to Client Events" data-file="twiliochat/ChannelManager.m" data-highlight="164-188" class="step"><h2 id="listen-to-client-events">Listen to Client Events</h2>
<p>The Chat Client will trigger events such as <code>channelAdded</code> or <code>channelDeleted</code>
on our application. Given the creation or deletion of a channel, we&#39;ll reload the
channel list in the reveal controller. If a channel is deleted and we were currently joined to that
channel, the application will automatically join the general channel.</p>
<p><code>ChannelManager</code> is a <code>TwilioChatClientDelegate</code>. In this class we
implement the delegate methods, but we also allow <code>MenuViewController</code>
class to be a delegate of ChannelManager, so it can listen to client events too.</p>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="//media.twiliocdn.com/sdk/ios/chat/releases/0.16.0/docs/Protocols/TwilioChatClientDelegate.html">TwilioChatClientDelegate Protocol Reference</a></li>
</ul>
</div><div data-title="Join the General Channel" data-file="twiliochat/ChannelManager.m" data-highlight="31-83" class="step"><h2 id="join-the-general-channel">Join the General Channel</h2>
<p>This application will try to join a channel called &quot;General Channel&quot; when it starts.
If the channel doesn&#39;t exist, it&#39;ll create one with that name. The scope of
this example application will show you how to work only with public channels,
but the Chat client allows you to create private channels and handle
invitations.</p>
<p>Once you have joined a channel, you can register a class as the <code>TCHChannelDelegate</code>
so you can start listening to events such as <code>messageAdded</code> or <code>memberJoined</code>.
We&#39;ll show you how to do this in the next step.</p>
</div><div data-title="Listen to Channel Events" data-file="twiliochat/MainChatViewController.m" data-highlight="258-296" class="step"><h2 id="listen-to-channel-events">Listen to Channel Events</h2>
<p>We registered <code>MainChatViewController</code> as the <code>TCHChannelDelegate</code>, and here
we implemented the following methods that listen to channel events:</p>
<ul>
<li><code>channelDeleted</code>: When someone deletes a channel.</li>
<li><code>memberJoined</code>: When someone joins the channel.</li>
<li><code>memberLeft</code>: When someone leaves the channel.</li>
<li><code>messageAdded</code>: When someone sends a message to the channel you are connected to.</li>
<li><code>synchronizationStatusChanged</code>: When channel synchronization status changes.</li>
</ul>
<p>As you may have noticed, each one of these methods include useful objects
as parameters. One example is the actual message that was added to the channel.</p>
</div><div data-title="Joining Other Channels" data-file="twiliochat/MainChatViewController.m" data-highlight="90-130" class="step"><h2 id="joining-other-channels">Joining Other Channels</h2>
<p>The application uses <a href="//github.com/John-Lluch/SWRevealViewController">SWRevealViewController</a>
to show a sidebar that contains a list of the channels created for that Twilio account.</p>
<p>When you tap on the name of a channel from the sidebar, that channel is set
on the <code>MainChatViewController</code>. The <code>setChannel</code> method takes care of joining
to the selected channel and loading the messages.</p>
</div><div data-title="Creating a Channel" data-file="twiliochat/ChannelManager.m" data-highlight="139-162" class="step"><h2 id="creating-a-channel">Creating a Channel</h2>
<p>We use an input dialog so the user can type the name of the new channel.
The only restriction here is that the user can&#39;t create a channel called
&quot;General Channel&quot;. Other than that, creating a channel is as simple as calling
<code>createChannelWithOptions</code> and passing a dictionary with the new channel information.</p>
</div><div data-title="Deleting a Channel" data-file="twiliochat/MenuViewController.m" data-highlight="83-95" class="step"><h2 id="deleting-a-channel">Deleting a Channel</h2>
<p>Deleting a channel is easier than creating one. We&#39;ll use the <code>UITableView</code>
ability to delete a cell. Once you have figured out what channel is meant
to be deleted (from the selected cell index path), deleting it is as simple
as calling the channel&#39;s method <code>destroyWithCompletion</code>.</p>
</div><div data-title="Where to Next?" class="step"><h2 id="where-to-next-">Where to Next?</h2>
<p>That&#39;s it! We&#39;ve just implemented a simple chat application in objective-c.
If you are am iOS developer working with Twilio, you might want
to check out these other projects:</p>
<p><a href="//github.com/TwilioDevEd/client-quickstart-objc"><strong>Client Quickstart</strong></a></p>
<p>Twilio Client for iOS Quickstart using Swift</p>
<p><a href="//github.com/TwilioDevEd/notifications-quickstart-objc"><strong>Notifications Quickstart</strong></a></p>
<p>Twilio Notifications for iOS Quickstart using Swift</p>
<h2 id="did-this-help-">Did this help?</h2>
<p>Thanks for checking this tutorial out! If you have any feedback to share with us,
we&#39;d love to hear it. <a href="mailto:deved-oss@twilio.com">Contact the Twilio Developer Education Team</a>
to let us know what you think.</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="twiliochat/AppDelegate.m" data-mode="objectivec">I2ltcG9ydCAiQXBwRGVsZWdhdGUuaCIKI2ltcG9ydCAiTWVzc2FnaW5nTWFuYWdlci5oIgpAaW1wb3J0IEZvdW5kYXRpb247CgoKQGludGVyZmFjZSBBcHBEZWxlZ2F0ZSAoKQoKQGVuZAoKQGltcGxlbWVudGF0aW9uIEFwcERlbGVnYXRlCi0gKEJPT0wpYXBwbGljYXRpb246KFVJQXBwbGljYXRpb24gKilhcHBsaWNhdGlvbiBkaWRGaW5pc2hMYXVuY2hpbmdXaXRoT3B0aW9uczooTlNEaWN0aW9uYXJ5ICopbGF1bmNoT3B0aW9ucyB7CiAgW1tNZXNzYWdpbmdNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdIHByZXNlbnRMYXVuY2hTY3JlZW5dOwogIFtbTWVzc2FnaW5nTWFuYWdlciBzaGFyZWRNYW5hZ2VyXSBwcmVzZW50Um9vdFZpZXdDb250cm9sbGVyXTsKICAKICByZXR1cm4gWUVTOwp9CgotICh2b2lkKWFwcGxpY2F0aW9uV2lsbFJlc2lnbkFjdGl2ZTooVUlBcHBsaWNhdGlvbiAqKWFwcGxpY2F0aW9uIHsKICAvLyBTZW50IHdoZW4gdGhlIGFwcGxpY2F0aW9uIGlzIGFib3V0IHRvIG1vdmUgZnJvbSBhY3RpdmUgdG8gaW5hY3RpdmUgc3RhdGUuIFRoaXMgY2FuIG9jY3VyIGZvciBjZXJ0YWluIHR5cGVzIG9mIHRlbXBvcmFyeSBpbnRlcnJ1cHRpb25zIChzdWNoIGFzIGFuIGluY29taW5nIHBob25lIGNhbGwgb3IgU01TIG1lc3NhZ2UpIG9yIHdoZW4gdGhlIHVzZXIgcXVpdHMgdGhlIGFwcGxpY2F0aW9uIGFuZCBpdCBiZWdpbnMgdGhlIHRyYW5zaXRpb24gdG8gdGhlIGJhY2tncm91bmQgc3RhdGUuCiAgLy8gVXNlIHRoaXMgbWV0aG9kIHRvIHBhdXNlIG9uZ29pbmcgdGFza3MsIGRpc2FibGUgdGltZXJzLCBhbmQgdGhyb3R0bGUgZG93biBPcGVuR0wgRVMgZnJhbWUgcmF0ZXMuIEdhbWVzIHNob3VsZCB1c2UgdGhpcyBtZXRob2QgdG8gcGF1c2UgdGhlIGdhbWUuCn0KCi0gKHZvaWQpYXBwbGljYXRpb25EaWRFbnRlckJhY2tncm91bmQ6KFVJQXBwbGljYXRpb24gKilhcHBsaWNhdGlvbiB7CiAgLy8gVXNlIHRoaXMgbWV0aG9kIHRvIHJlbGVhc2Ugc2hhcmVkIHJlc291cmNlcywgc2F2ZSB1c2VyIGRhdGEsIGludmFsaWRhdGUgdGltZXJzLCBhbmQgc3RvcmUgZW5vdWdoIGFwcGxpY2F0aW9uIHN0YXRlIGluZm9ybWF0aW9uIHRvIHJlc3RvcmUgeW91ciBhcHBsaWNhdGlvbiB0byBpdHMgY3VycmVudCBzdGF0ZSBpbiBjYXNlIGl0IGlzIHRlcm1pbmF0ZWQgbGF0ZXIuCiAgLy8gSWYgeW91ciBhcHBsaWNhdGlvbiBzdXBwb3J0cyBiYWNrZ3JvdW5kIGV4ZWN1dGlvbiwgdGhpcyBtZXRob2QgaXMgY2FsbGVkIGluc3RlYWQgb2YgYXBwbGljYXRpb25XaWxsVGVybWluYXRlOiB3aGVuIHRoZSB1c2VyIHF1aXRzLgp9CgotICh2b2lkKWFwcGxpY2F0aW9uV2lsbEVudGVyRm9yZWdyb3VuZDooVUlBcHBsaWNhdGlvbiAqKWFwcGxpY2F0aW9uIHsKICAvLyBDYWxsZWQgYXMgcGFydCBvZiB0aGUgdHJhbnNpdGlvbiBmcm9tIHRoZSBiYWNrZ3JvdW5kIHRvIHRoZSBpbmFjdGl2ZSBzdGF0ZTsgaGVyZSB5b3UgY2FuIHVuZG8gbWFueSBvZiB0aGUgY2hhbmdlcyBtYWRlIG9uIGVudGVyaW5nIHRoZSBiYWNrZ3JvdW5kLgp9CgotICh2b2lkKWFwcGxpY2F0aW9uRGlkQmVjb21lQWN0aXZlOihVSUFwcGxpY2F0aW9uICopYXBwbGljYXRpb24gewogIC8vIFJlc3RhcnQgYW55IHRhc2tzIHRoYXQgd2VyZSBwYXVzZWQgKG9yIG5vdCB5ZXQgc3RhcnRlZCkgd2hpbGUgdGhlIGFwcGxpY2F0aW9uIHdhcyBpbmFjdGl2ZS4gSWYgdGhlIGFwcGxpY2F0aW9uIHdhcyBwcmV2aW91c2x5IGluIHRoZSBiYWNrZ3JvdW5kLCBvcHRpb25hbGx5IHJlZnJlc2ggdGhlIHVzZXIgaW50ZXJmYWNlLgp9CgotICh2b2lkKWFwcGxpY2F0aW9uV2lsbFRlcm1pbmF0ZTooVUlBcHBsaWNhdGlvbiAqKWFwcGxpY2F0aW9uIHsKICAvLyBDYWxsZWQgd2hlbiB0aGUgYXBwbGljYXRpb24gaXMgYWJvdXQgdG8gdGVybWluYXRlLiBTYXZlIGRhdGEgaWYgYXBwcm9wcmlhdGUuIFNlZSBhbHNvIGFwcGxpY2F0aW9uRGlkRW50ZXJCYWNrZ3JvdW5kOi4KfQoKQGVuZAo=</textarea>
<textarea class="saurus-file" data-file="twiliochat/MessagingManager.m" data-mode="objectivec">I2ltcG9ydCAiTWVzc2FnaW5nTWFuYWdlci5oIgojaW1wb3J0ICJDaGFubmVsTWFuYWdlci5oIgojaW1wb3J0ICJTZXNzaW9uTWFuYWdlci5oIgojaW1wb3J0ICJUb2tlblJlcXVlc3RIYW5kbGVyLmgiCgpAaW50ZXJmYWNlIE1lc3NhZ2luZ01hbmFnZXIgKCkKQHByb3BlcnR5IChzdHJvbmcsIG5vbmF0b21pYykgVHdpbGlvQ2hhdENsaWVudCAqY2xpZW50OwpAcHJvcGVydHkgKG5vbmF0b21pYywgZ2V0dGVyPWlzQ29ubmVjdGVkKSBCT09MIGNvbm5lY3RlZDsKQGVuZAoKc3RhdGljIE5TU3RyaW5nICogY29uc3QgVFdDTG9naW5WaWV3Q29udHJvbGxlck5hbWUgPSBAIkxvZ2luVmlld0NvbnRyb2xsZXIiOwpzdGF0aWMgTlNTdHJpbmcgKiBjb25zdCBUV0NNYWluVmlld0NvbnRyb2xsZXJOYW1lID0gQCJSZXZlYWxWaWV3Q29udHJvbGxlciI7CgpzdGF0aWMgTlNTdHJpbmcgKiBjb25zdCBUV0NUb2tlbktleSA9IEAidG9rZW4iOwoKQGltcGxlbWVudGF0aW9uIE1lc3NhZ2luZ01hbmFnZXIKKyAoaW5zdGFuY2V0eXBlKXNoYXJlZE1hbmFnZXIgewogIHN0YXRpYyBNZXNzYWdpbmdNYW5hZ2VyICpzaGFyZWRNeU1hbmFnZXIgPSBuaWw7CiAgc3RhdGljIGRpc3BhdGNoX29uY2VfdCBvbmNlVG9rZW47CiAgZGlzcGF0Y2hfb25jZSgmb25jZVRva2VuLCBeewogICAgc2hhcmVkTXlNYW5hZ2VyID0gW1tzZWxmIGFsbG9jXSBpbml0XTsKICB9KTsKICByZXR1cm4gc2hhcmVkTXlNYW5hZ2VyOwp9CgotIChpbnN0YW5jZXR5cGUpaW5pdCB7CiAgc2VsZi5kZWxlZ2F0ZSA9IFtDaGFubmVsTWFuYWdlciBzaGFyZWRNYW5hZ2VyXTsKICByZXR1cm4gc2VsZjsKfQoKIyBwcmFnbWEgbWFyayBQcmVzZW50IHZpZXcgY29udHJvbGxlcnMKCi0gKHZvaWQpcHJlc2VudFJvb3RWaWV3Q29udHJvbGxlciB7CiAgaWYgKCFzZWxmLmlzTG9nZ2VkSW4pIHsKICAgIFtzZWxmIHByZXNlbnRWaWV3Q29udHJvbGxlckJ5TmFtZTpUV0NMb2dpblZpZXdDb250cm9sbGVyTmFtZV07CiAgICByZXR1cm47CiAgfQogIGlmICghc2VsZi5pc0Nvbm5lY3RlZCkgewogICAgW3NlbGYgY29ubmVjdENsaWVudFdpdGhDb21wbGV0aW9uOl4oQk9PTCBzdWNjZXNzLCBOU0Vycm9yICplcnJvcikgewogICAgICBpZiAoc3VjY2VzcykgewogICAgICAgIFtzZWxmIHByZXNlbnRWaWV3Q29udHJvbGxlckJ5TmFtZTpUV0NNYWluVmlld0NvbnRyb2xsZXJOYW1lXTsKICAgICAgfQogICAgfV07CiAgfQoKfQoKLSAodm9pZClwcmVzZW50Vmlld0NvbnRyb2xsZXJCeU5hbWU6KE5TU3RyaW5nICopdmlld0NvbnRyb2xsZXIgewogIFtzZWxmIHByZXNlbnRWaWV3Q29udHJvbGxlcjpbW3NlbGYgc3Rvcnlib2FyZFdpdGhOYW1lOkAiTWFpbiJdIGluc3RhbnRpYXRlVmlld0NvbnRyb2xsZXJXaXRoSWRlbnRpZmllcjp2aWV3Q29udHJvbGxlcl1dOwp9CgotICh2b2lkKXByZXNlbnRMYXVuY2hTY3JlZW4gewogIFtzZWxmIHByZXNlbnRWaWV3Q29udHJvbGxlcjpbW3NlbGYgc3Rvcnlib2FyZFdpdGhOYW1lOkAiTGF1bmNoU2NyZWVuIl0gaW5zdGFudGlhdGVJbml0aWFsVmlld0NvbnRyb2xsZXJdXTsKfQoKLSAodm9pZClwcmVzZW50Vmlld0NvbnRyb2xsZXI6KFVJVmlld0NvbnRyb2xsZXIgKil2aWV3Q29udHJvbGxlciB7CiAgVUlXaW5kb3cgKndpbmRvdyA9IFtbVUlBcHBsaWNhdGlvbiBzaGFyZWRBcHBsaWNhdGlvbl0uZGVsZWdhdGUgd2luZG93XTsKICB3aW5kb3cucm9vdFZpZXdDb250cm9sbGVyID0gdmlld0NvbnRyb2xsZXI7Cn0KCi0gKFVJU3Rvcnlib2FyZCAqKXN0b3J5Ym9hcmRXaXRoTmFtZTooTlNTdHJpbmcgKiluYW1lIHsKICByZXR1cm4gW1VJU3Rvcnlib2FyZCBzdG9yeWJvYXJkV2l0aE5hbWU6IG5hbWUgYnVuZGxlOiBbTlNCdW5kbGUgbWFpbkJ1bmRsZV1dOwp9CgojIHByYWdtYSBtYXJrIFVzZXIgYW5kIHNlc3Npb24gbWFuYWdlbWVudAoKLSAoQk9PTClpc0xvZ2dlZEluIHsKICByZXR1cm4gW1Nlc3Npb25NYW5hZ2VyIGlzTG9nZ2VkSW5dOwp9CgotICh2b2lkKWxvZ2luV2l0aFVzZXJuYW1lOihOU1N0cmluZyAqKXVzZXJuYW1lCiAgICBjb21wbGV0aW9uOihTdGF0dXNXaXRoRXJyb3JIYW5kbGVyKWNvbXBsZXRpb24gewogIFtTZXNzaW9uTWFuYWdlciBsb2dpbldpdGhVc2VybmFtZTp1c2VybmFtZV07CiAgW3NlbGYgY29ubmVjdENsaWVudFdpdGhDb21wbGV0aW9uOl4oQk9PTCBzdWNjZXNzLCBOU0Vycm9yICplcnJvcikgewogICAgaWYgKHN1Y2Nlc3MpIHsKICAgICAgW3NlbGYgcHJlc2VudFZpZXdDb250cm9sbGVyQnlOYW1lOlRXQ01haW5WaWV3Q29udHJvbGxlck5hbWVdOwogICAgfQogICAgY29tcGxldGlvbihzdWNjZXNzLCBlcnJvcik7CiAgfV07Cn0KCi0gKHZvaWQpbG9nb3V0IHsKICBbU2Vzc2lvbk1hbmFnZXIgbG9nb3V0XTsKICBzZWxmLmNvbm5lY3RlZCA9IE5POwoKICBkaXNwYXRjaF9hc3luYyhkaXNwYXRjaF9nZXRfZ2xvYmFsX3F1ZXVlKERJU1BBVENIX1FVRVVFX1BSSU9SSVRZX0RFRkFVTFQsIDApLCBeewogICAgW3NlbGYuY2xpZW50IHNodXRkb3duXTsKICAgIHNlbGYuY2xpZW50ID0gbmlsOwogIH0pOwp9CgojIHByYWdtYSBtYXJrIFR3aWxpbyBDbGllbnQKCi0gKHZvaWQpY29ubmVjdENsaWVudFdpdGhDb21wbGV0aW9uOihTdGF0dXNXaXRoRXJyb3JIYW5kbGVyKWNvbXBsZXRpb24gewogIGlmIChzZWxmLmNsaWVudCkgewogICAgW3NlbGYgbG9nb3V0XTsKICB9CgogIFtzZWxmIHJlcXVlc3RUb2tlbldpdGhDb21wbGV0aW9uOl4oQk9PTCBzdWNjZWVkZWQsIE5TU3RyaW5nICp0b2tlbikgewogICAgaWYgKHN1Y2NlZWRlZCkgewogICAgICBbc2VsZiBpbml0aWFsaXplQ2xpZW50V2l0aFRva2VuOnRva2VuXTsKICAgICAgaWYgKGNvbXBsZXRpb24pIGNvbXBsZXRpb24oc3VjY2VlZGVkLCBuaWwpOwogICAgfQogICAgZWxzZSB7CiAgICAgIE5TRXJyb3IgKmVycm9yID0gW3NlbGYgZXJyb3JXaXRoRGVzY3JpcHRpb246QCJDb3VsZCBub3QgZ2V0IGFjY2VzcyB0b2tlbiIgY29kZTozMDFdOwogICAgICBpZiAoY29tcGxldGlvbikgY29tcGxldGlvbihzdWNjZWVkZWQsIGVycm9yKTsKICAgIH0KICB9XTsKfQoKLSAodm9pZClpbml0aWFsaXplQ2xpZW50V2l0aFRva2VuOihOU1N0cmluZyAqKXRva2VuIHsKICBzZWxmLmNsaWVudCA9IFtUd2lsaW9DaGF0Q2xpZW50IGNoYXRDbGllbnRXaXRoVG9rZW46dG9rZW4gcHJvcGVydGllczpuaWwgZGVsZWdhdGU6c2VsZl07CiAgW1VJQXBwbGljYXRpb24gc2hhcmVkQXBwbGljYXRpb25dLm5ldHdvcmtBY3Rpdml0eUluZGljYXRvclZpc2libGUgPSBZRVM7CiAgc2VsZi5jb25uZWN0ZWQgPSBZRVM7Cn0KCi0gKHZvaWQpcmVxdWVzdFRva2VuV2l0aENvbXBsZXRpb246KFN0YXR1c1dpdGhUb2tlbkhhbmRsZXIpY29tcGxldGlvbiB7CiAgTlNTdHJpbmcgKnV1aWQgPSBbW1VJRGV2aWNlIGN1cnJlbnREZXZpY2VdIGlkZW50aWZpZXJGb3JWZW5kb3JdLlVVSURTdHJpbmc7CiAgTlNEaWN0aW9uYXJ5ICpwYXJhbWV0ZXJzID0gQHtAImRldmljZSI6IHV1aWQsIEAiaWRlbnRpdHkiOiBbU2Vzc2lvbk1hbmFnZXIgZ2V0VXNlcm5hbWVdfTsKCiAgW1Rva2VuUmVxdWVzdEhhbmRsZXIgZmV0Y2hUb2tlbldpdGhQYXJhbXM6cGFyYW1ldGVycyBjb21wbGV0aW9uOl4oTlNEaWN0aW9uYXJ5ICpyZXN1bHRzLCBOU0Vycm9yICplcnJvcikgewogICAgTlNTdHJpbmcgKnRva2VuID0gW3Jlc3VsdHMgb2JqZWN0Rm9yS2V5OlRXQ1Rva2VuS2V5XTsKICAgIEJPT0wgZXJyb3JDb25kaXRpb24gPSBlcnJvciB8fCAhdG9rZW47CgogICAgaWYgKGNvbXBsZXRpb24pIGNvbXBsZXRpb24oIWVycm9yQ29uZGl0aW9uLCB0b2tlbik7CiAgfV07Cn0KCi0gKHZvaWQpbG9hZEdlbmVyYWxDaGF0Um9vbVdpdGhDb21wbGV0aW9uOihTdGF0dXNXaXRoRXJyb3JIYW5kbGVyKWNvbXBsZXRpb24gewogIFtbQ2hhbm5lbE1hbmFnZXIgc2hhcmVkTWFuYWdlcl0gam9pbkdlbmVyYWxDaGF0Um9vbVdpdGhDb21wbGV0aW9uOl4oQk9PTCBzdWNjZWVkZWQpIHsKICAgIGlmIChzdWNjZWVkZWQpCiAgICB7CiAgICAgIGlmIChjb21wbGV0aW9uKSBjb21wbGV0aW9uKHN1Y2NlZWRlZCwgbmlsKTsKICAgIH0KICAgIGVsc2UgewogICAgICBOU0Vycm9yICplcnJvciA9IFtzZWxmIGVycm9yV2l0aERlc2NyaXB0aW9uOkAiQ291bGQgbm90IGpvaW4gR2VuZXJhbCBjaGFubmVsIiBjb2RlOjMwMF07CiAgICAgIGlmIChjb21wbGV0aW9uKSBjb21wbGV0aW9uKHN1Y2NlZWRlZCwgZXJyb3IpOwogICAgfQogIH1dOwp9CgotIChOU0Vycm9yICopZXJyb3JXaXRoRGVzY3JpcHRpb246KE5TU3RyaW5nICopZGVzY3JpcHRpb24gY29kZTooTlNJbnRlZ2VyKWNvZGUgewogIE5TRGljdGlvbmFyeSAqdXNlckluZm8gPSBAe05TTG9jYWxpemVkRGVzY3JpcHRpb25LZXk6IGRlc2NyaXB0aW9ufTsKICBOU0Vycm9yICplcnJvciA9IFtOU0Vycm9yIGVycm9yV2l0aERvbWFpbjpAImFwcCIgY29kZTpjb2RlIHVzZXJJbmZvOnVzZXJJbmZvXTsKICByZXR1cm4gZXJyb3I7Cn0KCiMgcHJhZ21hIG1hcmsgVHdpbGlvQWNjZXNzTWFuYWdlckRlbGVnYXRlCgotICh2b2lkKWFjY2Vzc01hbmFnZXJUb2tlbkV4cGlyZWQ6KFR3aWxpb0FjY2Vzc01hbmFnZXIgKilhY2Nlc3NNYW5hZ2VyIHsKICBbc2VsZiByZXF1ZXN0VG9rZW5XaXRoQ29tcGxldGlvbjpeKEJPT0wgc3VjY2VlZGVkLCBOU1N0cmluZyAqdG9rZW4pIHsKICAgIGlmIChzdWNjZWVkZWQpIHsKICAgICAgW2FjY2Vzc01hbmFnZXIgdXBkYXRlVG9rZW46dG9rZW5dOwogICAgfQogICAgZWxzZSB7CiAgICAgIE5TTG9nKEAiRXJyb3Igd2hpbGUgdHJ5aW5nIHRvIGdldCBuZXcgYWNjZXNzIHRva2VuIik7CiAgICB9CiAgfV07Cn0KCi0gKHZvaWQpYWNjZXNzTWFuYWdlcjooVHdpbGlvQWNjZXNzTWFuYWdlciAqKWFjY2Vzc01hbmFnZXIgZXJyb3I6KE5TRXJyb3IgKillcnJvciB7CiAgTlNMb2coQCJBY2Nlc3MgbWFuYWdlciBlcnJvcjogJUAiLCBbZXJyb3IgbG9jYWxpemVkRGVzY3JpcHRpb25dKTsKfQoKI3ByYWdtYSBtYXJrIEludGVybmFsIGhlbHBlcnMKCi0gKE5TU3RyaW5nICopdXNlcklkZW50aXR5IHsKICByZXR1cm4gW1Nlc3Npb25NYW5hZ2VyIGdldFVzZXJuYW1lXTsKfQoKI3ByYWdtYSBtYXJrIFR3aWxpb0NoYXRDbGllbnREZWxlZ2F0ZQoKLSAodm9pZCljaGF0Q2xpZW50OihUd2lsaW9DaGF0Q2xpZW50ICopY2xpZW50IGNoYW5uZWxBZGRlZDooVENIQ2hhbm5lbCAqKWNoYW5uZWwgewogIFtzZWxmLmRlbGVnYXRlIGNoYXRDbGllbnQ6Y2xpZW50IGNoYW5uZWxBZGRlZDpjaGFubmVsXTsKfQoKLSAodm9pZCljaGF0Q2xpZW50OihUd2lsaW9DaGF0Q2xpZW50ICopY2xpZW50IGNoYW5uZWxDaGFuZ2VkOihUQ0hDaGFubmVsICopY2hhbm5lbCB7CiAgW3NlbGYuZGVsZWdhdGUgY2hhdENsaWVudDpjbGllbnQgY2hhbm5lbENoYW5nZWQ6Y2hhbm5lbF07Cn0KCi0gKHZvaWQpY2hhdENsaWVudDooVHdpbGlvQ2hhdENsaWVudCAqKWNsaWVudCBjaGFubmVsRGVsZXRlZDooVENIQ2hhbm5lbCAqKWNoYW5uZWwgewogIFtzZWxmLmRlbGVnYXRlIGNoYXRDbGllbnQ6Y2xpZW50IGNoYW5uZWxEZWxldGVkOmNoYW5uZWxdOwp9CgotICh2b2lkKWNoYXRDbGllbnQ6KFR3aWxpb0NoYXRDbGllbnQgKiljbGllbnQgc3luY2hyb25pemF0aW9uU3RhdHVzQ2hhbmdlZDooVENIQ2xpZW50U3luY2hyb25pemF0aW9uU3RhdHVzKXN0YXR1cyB7CiAgaWYgKHN0YXR1cyA9PSBUQ0hDbGllbnRTeW5jaHJvbml6YXRpb25TdGF0dXNDb21wbGV0ZWQpIHsKICAgIFtVSUFwcGxpY2F0aW9uIHNoYXJlZEFwcGxpY2F0aW9uXS5uZXR3b3JrQWN0aXZpdHlJbmRpY2F0b3JWaXNpYmxlID0gTk87CiAgICBbQ2hhbm5lbE1hbmFnZXIgc2hhcmVkTWFuYWdlcl0uY2hhbm5lbHNMaXN0ID0gY2xpZW50LmNoYW5uZWxzTGlzdDsKICAgIFtbQ2hhbm5lbE1hbmFnZXIgc2hhcmVkTWFuYWdlcl0gcG9wdWxhdGVDaGFubmVsc107CiAgICBbc2VsZiBsb2FkR2VuZXJhbENoYXRSb29tV2l0aENvbXBsZXRpb246XihCT09MIHN1Y2Nlc3MsIE5TRXJyb3IgKmVycm9yKSB7CiAgICAgIGlmIChzdWNjZXNzKSBbc2VsZiBwcmVzZW50Um9vdFZpZXdDb250cm9sbGVyXTsKICAgIH1dOwogIH0KICBbc2VsZi5kZWxlZ2F0ZSBjaGF0Q2xpZW50OmNsaWVudCBzeW5jaHJvbml6YXRpb25TdGF0dXNDaGFuZ2VkOnN0YXR1c107Cn0KCkBlbmQK</textarea>
<textarea class="saurus-file" data-file="twiliochat/ChannelManager.m" data-mode="objectivec">I2ltcG9ydCAiQ2hhbm5lbE1hbmFnZXIuaCIKI2ltcG9ydCAiTWVzc2FnaW5nTWFuYWdlci5oIgoKI2RlZmluZSBfIFVuZGVyc2NvcmUKCkBpbnRlcmZhY2UgQ2hhbm5lbE1hbmFnZXIgKCkKQHByb3BlcnR5IChzdHJvbmcsIG5vbmF0b21pYykgVENIQ2hhbm5lbCAqZ2VuZXJhbENoYW5uZWw7CkBlbmQKCnN0YXRpYyBOU1N0cmluZyAqIGNvbnN0IFRXQ0RlZmF1bHRDaGFubmVsVW5pcXVlTmFtZSA9IEAiZ2VuZXJhbCI7CnN0YXRpYyBOU1N0cmluZyAqIGNvbnN0IFRXQ0RlZmF1bHRDaGFubmVsTmFtZSA9IEAiR2VuZXJhbCBDaGFubmVsIjsKCnN0YXRpYyBOU1N0cmluZyAqIGNvbnN0IFRXQ0ZyaWVuZGx5TmFtZUtleSA9IEAiZnJpZW5kbHlOYW1lIjsKCkBpbXBsZW1lbnRhdGlvbiBDaGFubmVsTWFuYWdlcgoKKyAoaW5zdGFuY2V0eXBlKXNoYXJlZE1hbmFnZXIgewogIHN0YXRpYyBDaGFubmVsTWFuYWdlciAqc2hhcmVkTXlNYW5hZ2VyID0gbmlsOwogIHN0YXRpYyBkaXNwYXRjaF9vbmNlX3Qgb25jZVRva2VuOwogIGRpc3BhdGNoX29uY2UoJm9uY2VUb2tlbiwgXnsKICAgIHNoYXJlZE15TWFuYWdlciA9IFtbc2VsZiBhbGxvY10gaW5pdF07CiAgfSk7CiAgcmV0dXJuIHNoYXJlZE15TWFuYWdlcjsKfQoKLSAoaW5zdGFuY2V0eXBlKWluaXQgewogIHNlbGYuY2hhbm5lbHMgPSBbW05TTXV0YWJsZU9yZGVyZWRTZXQgYWxsb2NdIGluaXRdOwogIHJldHVybiBzZWxmOwp9CgojcHJhZ21hIG1hcmsgR2VuZXJhbCBjaGFubmVsCgotICh2b2lkKWpvaW5HZW5lcmFsQ2hhdFJvb21XaXRoQ29tcGxldGlvbjooU3VjY2VlZEhhbmRsZXIpY29tcGxldGlvbiB7CiAgW3NlbGYuY2hhbm5lbHNMaXN0IGNoYW5uZWxXaXRoU2lkT3JVbmlxdWVOYW1lOlRXQ0RlZmF1bHRDaGFubmVsVW5pcXVlTmFtZSBjb21wbGV0aW9uOl4oVENIUmVzdWx0ICpyZXN1bHQsIFRDSENoYW5uZWwgKmNoYW5uZWwpIHsKICAgIGlmIChbcmVzdWx0IGlzU3VjY2Vzc2Z1bF0pIHsKICAgICAgc2VsZi5nZW5lcmFsQ2hhbm5lbCA9IGNoYW5uZWw7CiAgICB9CgogICAgaWYgKHNlbGYuZ2VuZXJhbENoYW5uZWwpIHsKICAgICAgW3NlbGYgam9pbkdlbmVyYWxDaGF0Um9vbVdpdGhVbmlxdWVOYW1lOm5pbCBjb21wbGV0aW9uOmNvbXBsZXRpb25dOwogICAgfQogICAgZWxzZSB7CiAgICAgIFtzZWxmIGNyZWF0ZUdlbmVyYWxDaGF0Um9vbVdpdGhDb21wbGV0aW9uOl4oQk9PTCBzdWNjZWVkZWQpIHsKICAgICAgICBpZiAoc3VjY2VlZGVkKSB7CiAgICAgICAgICBbc2VsZiBqb2luR2VuZXJhbENoYXRSb29tV2l0aFVuaXF1ZU5hbWU6VFdDRGVmYXVsdENoYW5uZWxVbmlxdWVOYW1lIGNvbXBsZXRpb246Y29tcGxldGlvbl07CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChjb21wbGV0aW9uKSBjb21wbGV0aW9uKE5PKTsKICAgICAgfV07CiAgICB9OwogIH1dOwp9CgotICh2b2lkKWpvaW5HZW5lcmFsQ2hhdFJvb21XaXRoVW5pcXVlTmFtZTooTlNTdHJpbmcgKil1bmlxdWVOYW1lIGNvbXBsZXRpb246KFN1Y2NlZWRIYW5kbGVyKWNvbXBsZXRpb24gewogIFtzZWxmLmdlbmVyYWxDaGFubmVsIGpvaW5XaXRoQ29tcGxldGlvbjpeKFRDSFJlc3VsdCAqcmVzdWx0KSB7CiAgICBpZiAoW3Jlc3VsdCBpc1N1Y2Nlc3NmdWxdKSB7CiAgICAgIGlmICh1bmlxdWVOYW1lKSB7CiAgICAgICAgW3NlbGYgc2V0R2VuZXJhbENoYXRSb29tVW5pcXVlTmFtZVdpdGhDb21wbGV0aW9uOmNvbXBsZXRpb25dOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfQogICAgaWYgKGNvbXBsZXRpb24pIGNvbXBsZXRpb24oW3Jlc3VsdCBpc1N1Y2Nlc3NmdWxdKTsKICB9XTsKfQoKLSAodm9pZCljcmVhdGVHZW5lcmFsQ2hhdFJvb21XaXRoQ29tcGxldGlvbjooU3VjY2VlZEhhbmRsZXIpY29tcGxldGlvbiB7CiAgTlNEaWN0aW9uYXJ5ICpvcHRpb25zID0gWwogICAgICAgICAgICAgICAgICAgICAgICAgICBOU0RpY3Rpb25hcnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgZGljdGlvbmFyeVdpdGhPYmplY3RzQW5kS2V5czpUV0NEZWZhdWx0Q2hhbm5lbE5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIFRDSENoYW5uZWxPcHRpb25GcmllbmRseU5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIFRDSENoYW5uZWxUeXBlUHVibGljLAogICAgICAgICAgICAgICAgICAgICAgICAgICBUQ0hDaGFubmVsT3B0aW9uVHlwZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgbmlsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIF07CgogIFtzZWxmLmNoYW5uZWxzTGlzdCBjcmVhdGVDaGFubmVsV2l0aE9wdGlvbnM6b3B0aW9ucwogICAgY29tcGxldGlvbjpeKFRDSFJlc3VsdCAqcmVzdWx0LCBUQ0hDaGFubmVsICpjaGFubmVsKSB7CiAgICAgIGlmIChbcmVzdWx0IGlzU3VjY2Vzc2Z1bF0pIHsKICAgICAgICBzZWxmLmdlbmVyYWxDaGFubmVsID0gY2hhbm5lbDsKICAgICAgfQogICAgICBpZiAoY29tcGxldGlvbikgY29tcGxldGlvbihbcmVzdWx0IGlzU3VjY2Vzc2Z1bF0pOwogICAgfV07Cn0KCi0gKHZvaWQpc2V0R2VuZXJhbENoYXRSb29tVW5pcXVlTmFtZVdpdGhDb21wbGV0aW9uOihTdWNjZWVkSGFuZGxlciljb21wbGV0aW9uIHsKICBbc2VsZi5nZW5lcmFsQ2hhbm5lbCBzZXRVbmlxdWVOYW1lOlRXQ0RlZmF1bHRDaGFubmVsVW5pcXVlTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRpb246XihUQ0hSZXN1bHQgKnJlc3VsdCkgewogICAgaWYgKGNvbXBsZXRpb24pIGNvbXBsZXRpb24oW3Jlc3VsdCBpc1N1Y2Nlc3NmdWxdKTsKICB9XTsKfQoKI3ByYWdtYSBtYXJrIFBvcHVsYXRlIGNoYW5uZWxzCgotICh2b2lkKXBvcHVsYXRlQ2hhbm5lbHMgewogIHNlbGYuY2hhbm5lbHMgPSBbW05TTXV0YWJsZU9yZGVyZWRTZXQgYWxsb2NdIGluaXRdOwogIFtzZWxmLmNoYW5uZWxzTGlzdCB1c2VyQ2hhbm5lbHNXaXRoQ29tcGxldGlvbjpeKFRDSFJlc3VsdCAqcmVzdWx0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRDSENoYW5uZWxQYWdpbmF0b3IgKmNoYW5uZWxQYWdpbmF0b3IpIHsKICAgIFtzZWxmLmNoYW5uZWxzIGFkZE9iamVjdHNGcm9tQXJyYXk6W2NoYW5uZWxQYWdpbmF0b3IgaXRlbXNdXTsKICAgIFtzZWxmIHNvcnRBbmREZWR1cGVDaGFubmVsc107CiAgICBpZiAoc2VsZi5kZWxlZ2F0ZSkgewogICAgICBbc2VsZi5kZWxlZ2F0ZSByZWxvYWRDaGFubmVsTGlzdF07CiAgICB9CiAgfV07CgogIFtzZWxmLmNoYW5uZWxzTGlzdCBwdWJsaWNDaGFubmVsc1dpdGhDb21wbGV0aW9uOl4oVENIUmVzdWx0ICpyZXN1bHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVENIQ2hhbm5lbERlc2NyaXB0b3JQYWdpbmF0b3IgKmNoYW5uZWxEZXNjUGFnaW5hdG9yKSB7CiAgICBbc2VsZi5jaGFubmVscyBhZGRPYmplY3RzRnJvbUFycmF5OiBbY2hhbm5lbERlc2NQYWdpbmF0b3IgaXRlbXNdXTsKICAgIFtzZWxmIHNvcnRBbmREZWR1cGVDaGFubmVsc107CiAgICBpZiAoc2VsZi5kZWxlZ2F0ZSkgewogICAgICBbc2VsZi5kZWxlZ2F0ZSByZWxvYWRDaGFubmVsTGlzdF07CiAgICB9CiAgfV07Cn0KCi0gKHZvaWQpc29ydEFuZERlZHVwZUNoYW5uZWxzIHsKICBOU011dGFibGVEaWN0aW9uYXJ5ICpjaGFubmVsc0RpY3QgPSBbW05TTXV0YWJsZURpY3Rpb25hcnkgYWxsb2NdIGluaXRdOwoKICBmb3IoVENIQ2hhbm5lbCAqY2hhbm5lbCBpbiBzZWxmLmNoYW5uZWxzKSB7CiAgICBpZiAoIVtjaGFubmVsc0RpY3Qgb2JqZWN0Rm9yS2V5OiBjaGFubmVsLnNpZF0gfHwKICAgICAgICAhW1tjaGFubmVsc0RpY3Qgb2JqZWN0Rm9yS2V5OiBjaGFubmVsLnNpZF0gaXNLaW5kT2ZDbGFzczogW05TTnVsbCBjbGFzc11dKSB7CiAgICAgIFtjaGFubmVsc0RpY3Qgc2V0T2JqZWN0OmNoYW5uZWwgZm9yS2V5OmNoYW5uZWwuc2lkXTsKICAgIH0KICB9CgogIE5TTXV0YWJsZU9yZGVyZWRTZXQgKmRlZHVwZWRDaGFubmVscyA9IFtOU011dGFibGVPcmRlcmVkU2V0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyZWRTZXRXaXRoQXJyYXk6W2NoYW5uZWxzRGljdCBhbGxWYWx1ZXNdXTsKCiAgU0VMIHNvcnRTZWxlY3RvciA9IEBzZWxlY3Rvcihsb2NhbGl6ZWRDYXNlSW5zZW5zaXRpdmVDb21wYXJlOik7CgogIE5TU29ydERlc2NyaXB0b3IgKmRlc2NyaXB0b3IgPSBbW05TU29ydERlc2NyaXB0b3IgYWxsb2NdIGluaXRXaXRoS2V5OlRXQ0ZyaWVuZGx5TmFtZUtleQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNjZW5kaW5nOllFUwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOnNvcnRTZWxlY3Rvcl07CgogIFtkZWR1cGVkQ2hhbm5lbHMgc29ydFVzaW5nRGVzY3JpcHRvcnM6QFtkZXNjcmlwdG9yXV07CgogIHNlbGYuY2hhbm5lbHMgPSBkZWR1cGVkQ2hhbm5lbHM7Cn0KCiMgcHJhZ21hIG1hcmsgQ3JlYXRlIGNoYW5uZWwKCi0gKHZvaWQpY3JlYXRlQ2hhbm5lbFdpdGhOYW1lOihOU1N0cmluZyAqKW5hbWUgY29tcGxldGlvbjooQ2hhbm5lbEhhbmRsZXIpY29tcGxldGlvbiB7CiAgaWYgKFtuYW1lIGlzRXF1YWxUb1N0cmluZzpUV0NEZWZhdWx0Q2hhbm5lbE5hbWVdKSB7CiAgICBpZiAoY29tcGxldGlvbikgY29tcGxldGlvbihOTywgbmlsKTsKICAgIHJldHVybjsKICB9CgogIE5TRGljdGlvbmFyeSAqb3B0aW9ucyA9IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgTlNEaWN0aW9uYXJ5CiAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpY3Rpb25hcnlXaXRoT2JqZWN0c0FuZEtleXM6bmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgVENIQ2hhbm5lbE9wdGlvbkZyaWVuZGx5TmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgVENIQ2hhbm5lbFR5cGVQdWJsaWMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIFRDSENoYW5uZWxPcHRpb25UeXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICBuaWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgXTsKICBbc2VsZi5jaGFubmVsc0xpc3QKICAgIGNyZWF0ZUNoYW5uZWxXaXRoT3B0aW9uczpvcHRpb25zCiAgICBjb21wbGV0aW9uOl4oVENIUmVzdWx0ICpyZXN1bHQsIFRDSENoYW5uZWwgKmNoYW5uZWwpIHsKICAgICAgW3NlbGYuY2hhbm5lbHMgYWRkT2JqZWN0OmNoYW5uZWxdOwogICAgICBbc2VsZiBzb3J0QW5kRGVkdXBlQ2hhbm5lbHNdOwogICAgICBpZiAoY29tcGxldGlvbikgY29tcGxldGlvbihbcmVzdWx0IGlzU3VjY2Vzc2Z1bF0sIGNoYW5uZWwpOwogICAgfV07Cn0KCiMgcHJhZ21hIG1hcmsgVHdpbGlvQ2hhdENsaWVudERlbGVnYXRlCgotICh2b2lkKWNoYXRDbGllbnQ6KFR3aWxpb0NoYXRDbGllbnQgKiljbGllbnQgY2hhbm5lbEFkZGVkOihUQ0hDaGFubmVsICopY2hhbm5lbHsKICBkaXNwYXRjaF9hc3luYyhkaXNwYXRjaF9nZXRfbWFpbl9xdWV1ZSgpLCBeewogICAgW3NlbGYuY2hhbm5lbHMgYWRkT2JqZWN0OmNoYW5uZWxdOwogICAgW3NlbGYgc29ydEFuZERlZHVwZUNoYW5uZWxzXTsKICAgIFtzZWxmLmRlbGVnYXRlIGNoYXRDbGllbnQ6Y2xpZW50IGNoYW5uZWxBZGRlZDpjaGFubmVsXTsKICB9KTsKfQoKLSAodm9pZCljaGF0Q2xpZW50OihUd2lsaW9DaGF0Q2xpZW50ICopY2xpZW50IGNoYW5uZWxDaGFuZ2VkOihUQ0hDaGFubmVsICopY2hhbm5lbCB7CiAgZGlzcGF0Y2hfYXN5bmMoZGlzcGF0Y2hfZ2V0X21haW5fcXVldWUoKSwgXnsKICAgIFtzZWxmLmRlbGVnYXRlIGNoYXRDbGllbnQ6Y2xpZW50IGNoYW5uZWxDaGFuZ2VkOmNoYW5uZWxdOwogIH0pOwp9CgotICh2b2lkKWNoYXRDbGllbnQ6KFR3aWxpb0NoYXRDbGllbnQgKiljbGllbnQgY2hhbm5lbERlbGV0ZWQ6KFRDSENoYW5uZWwgKiljaGFubmVsIHsKICBkaXNwYXRjaF9hc3luYyhkaXNwYXRjaF9nZXRfbWFpbl9xdWV1ZSgpLCBeewogICAgW1tDaGFubmVsTWFuYWdlciBzaGFyZWRNYW5hZ2VyXS5jaGFubmVscyByZW1vdmVPYmplY3Q6Y2hhbm5lbF07CiAgICBbc2VsZi5kZWxlZ2F0ZSBjaGF0Q2xpZW50OmNsaWVudCBjaGFubmVsRGVsZXRlZDpjaGFubmVsXTsKICB9KTsKfQoKLSAodm9pZCljaGF0Q2xpZW50OihUd2lsaW9DaGF0Q2xpZW50ICopY2xpZW50IHN5bmNocm9uaXphdGlvblN0YXR1c0NoYW5nZWQ6KFRDSENsaWVudFN5bmNocm9uaXphdGlvblN0YXR1cylzdGF0dXMgewp9CgpAZW5kCg==</textarea>
<textarea class="saurus-file" data-file="twiliochat/MainChatViewController.m" data-mode="objectivec">I2ltcG9ydCA8VHdpbGlvQ2hhdENsaWVudC9Ud2lsaW9DaGF0Q2xpZW50Lmg+CiNpbXBvcnQgIk1haW5DaGF0Vmlld0NvbnRyb2xsZXIuaCIKI2ltcG9ydCAiQ2hhdFRhYmxlQ2VsbC5oIgojaW1wb3J0ICJOU0RhdGUrSVNPODYwMVBhcnNlci5oIgojaW1wb3J0ICJTV1JldmVhbFZpZXdDb250cm9sbGVyLmgiCiNpbXBvcnQgIkNoYW5uZWxNYW5hZ2VyLmgiCiNpbXBvcnQgIlN0YXR1c0VudHJ5LmgiCiNpbXBvcnQgIkRhdGVUb2RheUZvcm1hdHRlci5oIgojaW1wb3J0ICJNZW51Vmlld0NvbnRyb2xsZXIuaCIKCkBpbnRlcmZhY2UgTWFpbkNoYXRWaWV3Q29udHJvbGxlciAoKQpAcHJvcGVydHkgKHdlYWssIG5vbmF0b21pYykgSUJPdXRsZXQgVUlCYXJCdXR0b25JdGVtICpyZXZlYWxCdXR0b25JdGVtOwpAcHJvcGVydHkgKHdlYWssIG5vbmF0b21pYykgSUJPdXRsZXQgVUlCYXJCdXR0b25JdGVtICphY3Rpb25CdXR0b25JdGVtOwoKQHByb3BlcnR5IChzdHJvbmcsIG5vbmF0b21pYykgTlNNdXRhYmxlT3JkZXJlZFNldCAqbWVzc2FnZXM7CgpAZW5kCgpzdGF0aWMgTlNTdHJpbmcgKiBjb25zdCBUV0NDaGF0Q2VsbElkZW50aWZpZXIgPSBAIkNoYXRUYWJsZUNlbGwiOwpzdGF0aWMgTlNTdHJpbmcgKiBjb25zdCBUV0NDaGF0U3RhdHVzQ2VsbElkZW50aWZpZXIgPSBAIkNoYXRTdGF0dXNUYWJsZUNlbGwiOwoKc3RhdGljIE5TU3RyaW5nICogY29uc3QgVFdDT3BlbkdlbmVyYWxDaGFubmVsU2VndWUgPSBAIk9wZW5HZW5lcmFsQ2hhdCI7CnN0YXRpYyBOU0ludGVnZXIgY29uc3QgVFdDTGFiZWxUYWcgPSAyMDA7CgpAaW1wbGVtZW50YXRpb24gTWFpbkNoYXRWaWV3Q29udHJvbGxlcgoKI3ByYWdtYSBtYXJrIEluaXRpYWxpemF0aW9uCgotICh2b2lkKXZpZXdEaWRMb2FkIHsKICBbc3VwZXIgdmlld0RpZExvYWRdOwogIAogIGlmIChzZWxmLnJldmVhbFZpZXdDb250cm9sbGVyKQogIHsKICAgIFtzZWxmLnJldmVhbEJ1dHRvbkl0ZW0gc2V0VGFyZ2V0OiBzZWxmLnJldmVhbFZpZXdDb250cm9sbGVyXTsKICAgIFtzZWxmLnJldmVhbEJ1dHRvbkl0ZW0gc2V0QWN0aW9uOiBAc2VsZWN0b3IoIHJldmVhbFRvZ2dsZTogKV07CiAgICBbc2VsZi5uYXZpZ2F0aW9uQ29udHJvbGxlci5uYXZpZ2F0aW9uQmFyIGFkZEdlc3R1cmVSZWNvZ25pemVyOiBzZWxmLnJldmVhbFZpZXdDb250cm9sbGVyLnBhbkdlc3R1cmVSZWNvZ25pemVyXTsKICAgIHNlbGYucmV2ZWFsVmlld0NvbnRyb2xsZXIucmVhclZpZXdSZXZlYWxPdmVyZHJhdyA9IDAuZjsKICB9CiAgCiAgc2VsZi5ib3VuY2VzID0gWUVTOwogIHNlbGYuc2hha2VUb0NsZWFyRW5hYmxlZCA9IFlFUzsKICBzZWxmLmtleWJvYXJkUGFubmluZ0VuYWJsZWQgPSBZRVM7CiAgc2VsZi5zaG91bGRTY3JvbGxUb0JvdHRvbUFmdGVyS2V5Ym9hcmRTaG93cyA9IE5POwogIHNlbGYuaW52ZXJ0ZWQgPSBZRVM7CiAgCiAgVUlOaWIgKmNlbGxOaWIgPSBbVUlOaWIgbmliV2l0aE5pYk5hbWU6VFdDQ2hhdENlbGxJZGVudGlmaWVyIGJ1bmRsZTpuaWxdOwogIFtzZWxmLnRhYmxlVmlldyByZWdpc3Rlck5pYjpjZWxsTmliCiAgICAgICBmb3JDZWxsUmV1c2VJZGVudGlmaWVyOlRXQ0NoYXRDZWxsSWRlbnRpZmllcl07CiAgCiAgVUlOaWIgKmNlbGxTdGF0dXNOaWIgPSBbVUlOaWIgbmliV2l0aE5pYk5hbWU6VFdDQ2hhdFN0YXR1c0NlbGxJZGVudGlmaWVyIGJ1bmRsZTpuaWxdOwogIFtzZWxmLnRhYmxlVmlldyByZWdpc3Rlck5pYjpjZWxsU3RhdHVzTmliCiAgICAgICBmb3JDZWxsUmV1c2VJZGVudGlmaWVyOlRXQ0NoYXRTdGF0dXNDZWxsSWRlbnRpZmllcl07CiAgCiAgc2VsZi50ZXh0SW5wdXRiYXIuYXV0b0hpZGVSaWdodEJ1dHRvbiA9IFlFUzsKICBzZWxmLnRleHRJbnB1dGJhci5tYXhDaGFyQ291bnQgPSAyNTY7CiAgc2VsZi50ZXh0SW5wdXRiYXIuY291bnRlclN0eWxlID0gU0xLQ291bnRlclN0eWxlU3BsaXQ7CiAgc2VsZi50ZXh0SW5wdXRiYXIuY291bnRlclBvc2l0aW9uID0gU0xLQ291bnRlclBvc2l0aW9uVG9wOwogIAogIFVJRm9udCAqZm9udCA9IFtVSUZvbnQgZm9udFdpdGhOYW1lOkAiQXZlbmlyLUxpZ2h0IiBzaXplOjE0XTsKICBzZWxmLnRleHRWaWV3LmZvbnQgPSBmb250OwogIAogIFtzZWxmLnJpZ2h0QnV0dG9uIHNldFRpdGxlQ29sb3I6W1VJQ29sb3IgY29sb3JXaXRoUmVkOjAuOTczIGdyZWVuOjAuNTU3IGJsdWU6MC41MDIgYWxwaGE6MV0KICAgICAgICAgICAgICAgICAgICAgICAgIGZvclN0YXRlOlVJQ29udHJvbFN0YXRlTm9ybWFsXTsKICAKICBmb250ID0gW1VJRm9udCBmb250V2l0aE5hbWU6QCJBdmVuaXItSGVhdnkiIHNpemU6MTddOwogIHNlbGYubmF2aWdhdGlvbkNvbnRyb2xsZXIubmF2aWdhdGlvbkJhci50aXRsZVRleHRBdHRyaWJ1dGVzID0gQHtOU0ZvbnRBdHRyaWJ1dGVOYW1lOmZvbnR9OwoKICBzZWxmLnRhYmxlVmlldy5hbGxvd3NTZWxlY3Rpb24gPSBOTzsKICBzZWxmLnRhYmxlVmlldy5lc3RpbWF0ZWRSb3dIZWlnaHQgPSA3MDsKICBzZWxmLnRhYmxlVmlldy5yb3dIZWlnaHQgPSBVSVRhYmxlVmlld0F1dG9tYXRpY0RpbWVuc2lvbjsKICBzZWxmLnRhYmxlVmlldy5zZXBhcmF0b3JTdHlsZSA9IFVJVGFibGVWaWV3Q2VsbFNlcGFyYXRvclN0eWxlTm9uZTsKICAKICBpZiAoIXNlbGYuY2hhbm5lbCkgewogICAgc2VsZi5jaGFubmVsID0gW0NoYW5uZWxNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdLmdlbmVyYWxDaGFubmVsOwogIH0KfQoKLSAodm9pZCl2aWV3RGlkQXBwZWFyOihCT09MKWFuaW1hdGVkIHsKICBbc3VwZXIgdmlld0RpZEFwcGVhcjphbmltYXRlZF07CiAgW3NlbGYgc2Nyb2xsVG9Cb3R0b21NZXNzYWdlXTsKfQoKLSAoTlNNdXRhYmxlT3JkZXJlZFNldCAqKW1lc3NhZ2VzIHsKICBpZiAoIV9tZXNzYWdlcykgewogICAgX21lc3NhZ2VzID0gW1tOU011dGFibGVPcmRlcmVkU2V0IGFsbG9jXSBpbml0XTsKICB9CiAgcmV0dXJuIF9tZXNzYWdlczsKfQoKLSAodm9pZClzZXRDaGFubmVsOihUQ0hDaGFubmVsICopY2hhbm5lbCB7CiAgaWYgKFtjaGFubmVsIGlzS2luZE9mQ2xhc3M6W1RDSENoYW5uZWxEZXNjcmlwdG9yIGNsYXNzXV0pIHsKICAgIFRDSENoYW5uZWxEZXNjcmlwdG9yICpjaGFubmVsRGVzY3JpcHRvciA9IChUQ0hDaGFubmVsRGVzY3JpcHRvciopY2hhbm5lbDsKICAgIFtjaGFubmVsRGVzY3JpcHRvciBjaGFubmVsV2l0aENvbXBsZXRpb246XihUQ0hSZXN1bHQgKnN1Y2Nlc3MsIFRDSENoYW5uZWwgKmNoYW5uZWwpIHsKICAgICAgaWYgKHN1Y2Nlc3MpIHsKICAgICAgICBbc2VsZiBhY3R1YWxseVNldENoYW5uZWw6Y2hhbm5lbF07CiAgICAgIH0KICAgIH1dOwogIH0gZWxzZSB7CiAgICBbc2VsZiBhY3R1YWxseVNldENoYW5uZWw6Y2hhbm5lbF07CiAgfQp9CgotICh2b2lkKWFjdHVhbGx5U2V0Q2hhbm5lbDooVENIQ2hhbm5lbCAqKWNoYW5uZWwgewogIF9jaGFubmVsID0gY2hhbm5lbDsKICBzZWxmLnRpdGxlID0gc2VsZi5jaGFubmVsLmZyaWVuZGx5TmFtZTsKICBzZWxmLmNoYW5uZWwuZGVsZWdhdGUgPSBzZWxmOwogIAogIGlmIChzZWxmLmNoYW5uZWwgPT0gW0NoYW5uZWxNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdLmdlbmVyYWxDaGFubmVsKSB7CiAgICBzZWxmLm5hdmlnYXRpb25JdGVtLnJpZ2h0QmFyQnV0dG9uSXRlbSA9IG5pbDsKICB9CiAgCiAgW3NlbGYgc2V0Vmlld09uSG9sZDpZRVNdOwogIAogIGlmIChzZWxmLmNoYW5uZWwuc3RhdHVzICE9IFRDSENoYW5uZWxTdGF0dXNKb2luZWQpIHsKICAgIFtzZWxmLmNoYW5uZWwgam9pbldpdGhDb21wbGV0aW9uOl4oVENIUmVzdWx0KiByZXN1bHQpIHsKICAgICAgTlNMb2coQCIlQCIsIEAiQ2hhbm5lbCBKb2luZWQiKTsKICAgIH1dOwogIH0KICBpZiAoc2VsZi5jaGFubmVsLnN5bmNocm9uaXphdGlvblN0YXR1cyAhPSBUQ0hDaGFubmVsU3luY2hyb25pemF0aW9uU3RhdHVzQWxsKSB7CiAgICBbc2VsZi5jaGFubmVsIHN5bmNocm9uaXplV2l0aENvbXBsZXRpb246XihUQ0hSZXN1bHQgKnJlc3VsdCkgewogICAgICBpZiAoW3Jlc3VsdCBpc1N1Y2Nlc3NmdWxdKSB7CiAgICAgICAgTlNMb2coQCIlQCIsIEAiU3luY2hyb25pemF0aW9uIHN0YXJ0ZWQuIERlbGVnYXRlIG1ldGhvZCB3aWxsIGxvYWQgbWVzc2FnZXMiKTsKICAgICAgfQogICAgfV07CiAgfQogIGVsc2UgewogICAgW3NlbGYgbG9hZE1lc3NhZ2VzXTsKICAgIFtzZWxmIHNldFZpZXdPbkhvbGQ6Tk9dOwogIH0KfQoKLy8gRGlzYWJsZSB1c2VyIGlucHV0IGFuZCBzaG93IGFjdGl2aXR5IGluZGljYXRvcgotICh2b2lkKXNldFZpZXdPbkhvbGQ6KEJPT0wpb25Ib2xkIHsKICBzZWxmLnRleHRJbnB1dGJhckhpZGRlbiA9IG9uSG9sZDsKICBbVUlBcHBsaWNhdGlvbiBzaGFyZWRBcHBsaWNhdGlvbl0ubmV0d29ya0FjdGl2aXR5SW5kaWNhdG9yVmlzaWJsZSA9IG9uSG9sZDsKfQoKLSAoTlNJbnRlZ2VyKW51bWJlck9mU2VjdGlvbnNJblRhYmxlVmlldzooVUlUYWJsZVZpZXcgKil0YWJsZVZpZXcgewogIHJldHVybiAxOwp9CgotIChOU0ludGVnZXIpdGFibGVWaWV3OihVSVRhYmxlVmlldyAqKXRhYmxlVmlldyBudW1iZXJPZlJvd3NJblNlY3Rpb246KE5TSW50ZWdlcilzZWN0aW9uIHsKICByZXR1cm4gc2VsZi5tZXNzYWdlcy5jb3VudDsKfQoKLSAoVUlUYWJsZVZpZXdDZWxsICopdGFibGVWaWV3OihVSVRhYmxlVmlldyAqKXRhYmxlVmlldyBjZWxsRm9yUm93QXRJbmRleFBhdGg6KE5TSW5kZXhQYXRoICopaW5kZXhQYXRoIHsKICBVSVRhYmxlVmlld0NlbGwgKmNlbGwgPSBuaWw7CiAgCiAgaWQgbWVzc2FnZSA9IFtzZWxmLm1lc3NhZ2VzIG9iamVjdEF0SW5kZXg6aW5kZXhQYXRoLnJvd107CiAgCiAgaWYgKFttZXNzYWdlIGlzS2luZE9mQ2xhc3M6W1RDSE1lc3NhZ2UgY2xhc3NdXSkgewogICAgY2VsbCA9IFtzZWxmIGdldENoYXRDZWxsRm9yVGFibGVWaWV3OnRhYmxlVmlldyBmb3JJbmRleFBhdGg6aW5kZXhQYXRoIG1lc3NhZ2U6bWVzc2FnZV07CiAgfQogIGVsc2UgewogICAgY2VsbCA9IFtzZWxmIGdldFN0YXR1Q2VsbEZvclRhYmxlVmlldzp0YWJsZVZpZXcgZm9ySW5kZXhQYXRoOmluZGV4UGF0aCBtZXNzYWdlOm1lc3NhZ2VdOwogIH0KICAKICBjZWxsLnRyYW5zZm9ybSA9IHRhYmxlVmlldy50cmFuc2Zvcm07CiAgcmV0dXJuIGNlbGw7Cn0KCi0gKENoYXRUYWJsZUNlbGwgKilnZXRDaGF0Q2VsbEZvclRhYmxlVmlldzooVUlUYWJsZVZpZXcgKil0YWJsZVZpZXcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ySW5kZXhQYXRoOihOU0luZGV4UGF0aCAqKWluZGV4UGF0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6KFRDSE1lc3NhZ2UgKiltZXNzYWdlIHsKICBVSVRhYmxlVmlld0NlbGwgKmNlbGwgPSBbc2VsZi50YWJsZVZpZXcKICAgIGRlcXVldWVSZXVzYWJsZUNlbGxXaXRoSWRlbnRpZmllcjpUV0NDaGF0Q2VsbElkZW50aWZpZXIgZm9ySW5kZXhQYXRoOmluZGV4UGF0aF07CgogIENoYXRUYWJsZUNlbGwgKmNoYXRDZWxsID0gKENoYXRUYWJsZUNlbGwgKiljZWxsOwogIGNoYXRDZWxsLnVzZXIgPSBtZXNzYWdlLmF1dGhvcjsKICBjaGF0Q2VsbC5kYXRlID0gW1tbRGF0ZVRvZGF5Rm9ybWF0dGVyIGFsbG9jXSBpbml0XQogICAgc3RyaW5nRnJvbURhdGU6W05TRGF0ZSBkYXRlV2l0aElTTzg2MDFTdHJpbmc6bWVzc2FnZS50aW1lc3RhbXBdXTsKCiAgY2hhdENlbGwubWVzc2FnZSA9IG1lc3NhZ2UuYm9keTsKICAKICByZXR1cm4gY2hhdENlbGw7Cn0KCi0gKFVJVGFibGVWaWV3Q2VsbCAqKWdldFN0YXR1Q2VsbEZvclRhYmxlVmlldzooVUlUYWJsZVZpZXcgKil0YWJsZVZpZXcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ySW5kZXhQYXRoOihOU0luZGV4UGF0aCAqKWluZGV4UGF0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6KFN0YXR1c0VudHJ5ICopbWVzc2FnZSB7CiAgVUlUYWJsZVZpZXdDZWxsICpjZWxsID0gW3NlbGYudGFibGVWaWV3CiAgICBkZXF1ZXVlUmV1c2FibGVDZWxsV2l0aElkZW50aWZpZXI6VFdDQ2hhdFN0YXR1c0NlbGxJZGVudGlmaWVyIGZvckluZGV4UGF0aDppbmRleFBhdGhdOwogIAogIFVJTGFiZWwgKmxhYmVsID0gW2NlbGwgdmlld1dpdGhUYWc6VFdDTGFiZWxUYWddOwogIGxhYmVsLnRleHQgPSBbTlNTdHJpbmcgc3RyaW5nV2l0aEZvcm1hdDpAIlVzZXIgJUAgaGFzICVAIiwKICAgICBtZXNzYWdlLm1lbWJlci51c2VySW5mby5pZGVudGl0eSwgKG1lc3NhZ2Uuc3RhdHVzID09IFRXQ01lbWJlclN0YXR1c0pvaW5lZCkgPyBAImpvaW5lZCIgOiBAImxlZnQiXTsKICAKICByZXR1cm4gY2VsbDsKfQoKLSAodm9pZClkaWRQcmVzc1JpZ2h0QnV0dG9uOihpZClzZW5kZXIgewogIFtzZWxmLnRleHRWaWV3IHJlZnJlc2hGaXJzdFJlc3BvbmRlcl07CiAgW3NlbGYgc2VuZE1lc3NhZ2U6IFtzZWxmLnRleHRWaWV3LnRleHQgY29weV1dOwogIFtzdXBlciBkaWRQcmVzc1JpZ2h0QnV0dG9uOnNlbmRlcl07Cn0KCiNwcmFnbWEgbWFyayBDaGF0IFNlcnZpY2UKLSAodm9pZClzZW5kTWVzc2FnZTogKE5TU3RyaW5nICopaW5wdXRNZXNzYWdlIHsKICBUQ0hNZXNzYWdlICptZXNzYWdlID0gW3NlbGYuY2hhbm5lbC5tZXNzYWdlcyBjcmVhdGVNZXNzYWdlV2l0aEJvZHk6aW5wdXRNZXNzYWdlXTsKICBbc2VsZi5jaGFubmVsLm1lc3NhZ2VzIHNlbmRNZXNzYWdlOm1lc3NhZ2UgY29tcGxldGlvbjpuaWxdOwp9CgoKCi0gKHZvaWQpYWRkTWVzc2FnZXM6KE5TQXJyYXkgKiltZXNzYWdlcyB7CiAgW3NlbGYubWVzc2FnZXMgYWRkT2JqZWN0c0Zyb21BcnJheTptZXNzYWdlc107CiAgW3NlbGYgc29ydE1lc3NhZ2VzXTsKICBkaXNwYXRjaF9hc3luYyhkaXNwYXRjaF9nZXRfbWFpbl9xdWV1ZSgpLCBeewogICAgW3NlbGYudGFibGVWaWV3IHJlbG9hZERhdGFdOwogICAgaWYgKHNlbGYubWVzc2FnZXMuY291bnQgPiAwKSB7CiAgICAgIFtzZWxmIHNjcm9sbFRvQm90dG9tTWVzc2FnZV07CiAgICB9CiAgfSk7Cn0KCgotICh2b2lkKXNvcnRNZXNzYWdlcyB7CiAgW3NlbGYubWVzc2FnZXMgc29ydFVzaW5nRGVzY3JpcHRvcnM6QFtbW05TU29ydERlc2NyaXB0b3IgYWxsb2NdCiAgICBpbml0V2l0aEtleTpAInRpbWVzdGFtcCIgYXNjZW5kaW5nOk5PXV1dOwp9CgotICh2b2lkKXNjcm9sbFRvQm90dG9tTWVzc2FnZSB7CiAgaWYgKHNlbGYubWVzc2FnZXMuY291bnQgPT0gMCkgewogICAgcmV0dXJuOwogIH0KICAKICBOU0luZGV4UGF0aCAqYm90dG9tTWVzc2FnZUluZGV4ID0gW05TSW5kZXhQYXRoIGluZGV4UGF0aEZvclJvdzowCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpblNlY3Rpb246MF07CiAgW3NlbGYudGFibGVWaWV3IHNjcm9sbFRvUm93QXRJbmRleFBhdGg6Ym90dG9tTWVzc2FnZUluZGV4CiAgICBhdFNjcm9sbFBvc2l0aW9uOlVJVGFibGVWaWV3U2Nyb2xsUG9zaXRpb25Cb3R0b20gYW5pbWF0ZWQ6Tk9dOwp9CgotICh2b2lkKWxvYWRNZXNzYWdlcyB7CiAgW3NlbGYubWVzc2FnZXMgcmVtb3ZlQWxsT2JqZWN0c107CiAgaWYgKHNlbGYuY2hhbm5lbC5zeW5jaHJvbml6YXRpb25TdGF0dXMgPT0gVENIQ2hhbm5lbFN5bmNocm9uaXphdGlvblN0YXR1c0FsbCkgewogICAgW3NlbGYuY2hhbm5lbC5tZXNzYWdlcwogICAgIGdldExhc3RNZXNzYWdlc1dpdGhDb3VudDoxMDAKICAgICBjb21wbGV0aW9uOl4oVENIUmVzdWx0ICpyZXN1bHQsIE5TQXJyYXkgKm1lc3NhZ2VzKSB7CiAgICAgIGlmIChbcmVzdWx0IGlzU3VjY2Vzc2Z1bF0pIHsKICAgICAgICBbc2VsZiBhZGRNZXNzYWdlczogbWVzc2FnZXNdOwogICAgICB9CiAgICB9XTsKICB9Cn0KCi0gKHZvaWQpbGVhdmVDaGFubmVsIHsKICBbc2VsZi5jaGFubmVsIGxlYXZlV2l0aENvbXBsZXRpb246XihUQ0hSZXN1bHQqIHJlc3VsdCkgewogICAgaWYgKFtyZXN1bHQgaXNTdWNjZXNzZnVsXSkgewogICAgICBbKE1lbnVWaWV3Q29udHJvbGxlciAqKXNlbGYucmV2ZWFsVmlld0NvbnRyb2xsZXIucmVhclZpZXdDb250cm9sbGVyIGRlc2VsZWN0U2VsZWN0ZWRDaGFubmVsXTsKICAgICAgW3NlbGYucmV2ZWFsVmlld0NvbnRyb2xsZXIucmVhclZpZXdDb250cm9sbGVyCiAgICAgICAgcGVyZm9ybVNlZ3VlV2l0aElkZW50aWZpZXI6VFdDT3BlbkdlbmVyYWxDaGFubmVsU2VndWUgc2VuZGVyOm5pbF07CiAgICB9CiAgfV07Cn0KCiNwcmFnbWEgbWFyayAtIFRNTWVzc2FnZURlbGVnYXRlCgotICh2b2lkKWNoYXRDbGllbnQ6KFR3aWxpb0NoYXRDbGllbnQgKiljbGllbnQKICAgICAgICAgICAgICAgICAgY2hhbm5lbDooVENIQ2hhbm5lbCAqKWNoYW5uZWwKICAgICAgICAgICAgIG1lc3NhZ2VBZGRlZDooVENITWVzc2FnZSAqKW1lc3NhZ2UgewogIGlmICghW3NlbGYubWVzc2FnZXMgY29udGFpbnNPYmplY3Q6bWVzc2FnZV0pIHsKICAgIFtzZWxmIGFkZE1lc3NhZ2VzOkBbbWVzc2FnZV1dOwogIH0KfQoKLSAodm9pZCljaGF0Q2xpZW50OihUd2lsaW9DaGF0Q2xpZW50ICopY2xpZW50CiAgICAgICAgICAgY2hhbm5lbERlbGV0ZWQ6KFRDSENoYW5uZWwgKiljaGFubmVsIHsKICBkaXNwYXRjaF9hc3luYyhkaXNwYXRjaF9nZXRfbWFpbl9xdWV1ZSgpLCBeewogICAgaWYgKGNoYW5uZWwgPT0gc2VsZi5jaGFubmVsKSB7CiAgICAgIFtzZWxmLnJldmVhbFZpZXdDb250cm9sbGVyLnJlYXJWaWV3Q29udHJvbGxlcgogICAgICAgIHBlcmZvcm1TZWd1ZVdpdGhJZGVudGlmaWVyOlRXQ09wZW5HZW5lcmFsQ2hhbm5lbFNlZ3VlIHNlbmRlcjpuaWxdOwogICAgfQogIH0pOwp9CgotICh2b2lkKWNoYXRDbGllbnQ6KFR3aWxpb0NoYXRDbGllbnQgKiljbGllbnQKICAgICAgICAgICAgICAgICAgY2hhbm5lbDooVENIQ2hhbm5lbCAqKWNoYW5uZWwKICAgICAgICAgICAgIG1lbWJlckpvaW5lZDooVENITWVtYmVyICopbWVtYmVyIHsKICBbc2VsZiBhZGRNZXNzYWdlczpAW1tTdGF0dXNFbnRyeSBzdGF0dXNFbnRyeVdpdGhNZW1iZXI6bWVtYmVyIHN0YXR1czpUV0NNZW1iZXJTdGF0dXNKb2luZWRdXV07Cn0KCi0gKHZvaWQpY2hhdENsaWVudDooVHdpbGlvQ2hhdENsaWVudCAqKWNsaWVudAogICAgICAgICAgICAgICAgICBjaGFubmVsOihUQ0hDaGFubmVsICopY2hhbm5lbAogICAgICAgICAgICAgICBtZW1iZXJMZWZ0OihUQ0hNZW1iZXIgKiltZW1iZXIgewogIFtzZWxmIGFkZE1lc3NhZ2VzOkBbW1N0YXR1c0VudHJ5IHN0YXR1c0VudHJ5V2l0aE1lbWJlcjptZW1iZXIgc3RhdHVzOlRXQ01lbWJlclN0YXR1c0xlZnRdXV07Cn0KCi0gKHZvaWQpY2hhdENsaWVudDooVHdpbGlvQ2hhdENsaWVudCAqKWNsaWVudCBjaGFubmVsOihUQ0hDaGFubmVsICopY2hhbm5lbCBzeW5jaHJvbml6YXRpb25TdGF0dXNDaGFuZ2VkOihUQ0hDaGFubmVsU3luY2hyb25pemF0aW9uU3RhdHVzKXN0YXR1cyB7CiAgaWYgKHN0YXR1cyA9PSBUQ0hDaGFubmVsU3luY2hyb25pemF0aW9uU3RhdHVzQWxsKSB7CiAgICBbc2VsZiBsb2FkTWVzc2FnZXNdOwogICAgZGlzcGF0Y2hfYXN5bmMoZGlzcGF0Y2hfZ2V0X21haW5fcXVldWUoKSwgXnsKICAgICAgW3NlbGYudGFibGVWaWV3IHJlbG9hZERhdGFdOwogICAgICBbc2VsZiBzZXRWaWV3T25Ib2xkOk5PXTsKICAgIH0pOwogIH0KfQoKI3ByYWdtYSBtYXJrIC0gQWN0aW9ucwoKLSAoSUJBY3Rpb24pYWN0aW9uQnV0dG9uVG91Y2hlZDooVUlCYXJCdXR0b25JdGVtICopc2VuZGVyIHsKICBbc2VsZiBsZWF2ZUNoYW5uZWxdOwp9CgotIChJQkFjdGlvbilyZXZlYWxCdXR0b25Ub3VjaGVkOihVSUJhckJ1dHRvbkl0ZW0gKilzZW5kZXIgewogIFtzZWxmLnJldmVhbFZpZXdDb250cm9sbGVyIHJldmVhbFRvZ2dsZUFuaW1hdGVkOllFU107Cn0KCkBlbmQK</textarea>
<textarea class="saurus-file" data-file="twiliochat/MenuViewController.m" data-mode="objectivec">I2ltcG9ydCA8U1dSZXZlYWxWaWV3Q29udHJvbGxlci9TV1JldmVhbFZpZXdDb250cm9sbGVyLmg+CiNpbXBvcnQgIk1lbnVWaWV3Q29udHJvbGxlci5oIgojaW1wb3J0ICJNZW51VGFibGVDZWxsLmgiCiNpbXBvcnQgIklucHV0RGlhbG9nQ29udHJvbGxlci5oIgojaW1wb3J0ICJNYWluQ2hhdFZpZXdDb250cm9sbGVyLmgiCiNpbXBvcnQgIk1lc3NhZ2luZ01hbmFnZXIuaCIKI2ltcG9ydCAiQWxlcnREaWFsb2dDb250cm9sbGVyLmgiCiNpbXBvcnQgIkNoYW5uZWxNYW5hZ2VyLmgiCiNpbXBvcnQgIlNlc3Npb25NYW5hZ2VyLmgiCgpAaW50ZXJmYWNlIE1lbnVWaWV3Q29udHJvbGxlciAoKQpAcHJvcGVydHkgKHdlYWssIG5vbmF0b21pYykgSUJPdXRsZXQgVUlMYWJlbCAqdXNlcm5hbWVMYWJlbDsKQHByb3BlcnR5ICh3ZWFrLCBub25hdG9taWMpIElCT3V0bGV0IFVJVGFibGVWaWV3ICp0YWJsZVZpZXc7CkBwcm9wZXJ0eSAoc3Ryb25nLCBub25hdG9taWMpIFVJUmVmcmVzaENvbnRyb2wgKnJlZnJlc2hDb250cm9sOwoKQHByb3BlcnR5IChzdHJvbmcsIG5vbmF0b21pYykgVENIQ2hhbm5lbCAqcmVjZW50bHlBZGRlZENoYW5uZWw7CkBlbmQKCnN0YXRpYyBOU1N0cmluZyAqIGNvbnN0IFRXQ09wZW5DaGFubmVsU2VndWUgPSBAIk9wZW5DaGF0IjsKc3RhdGljIE5TSW50ZWdlciBjb25zdCBUV0NSZWZyZXNoQ29udHJvbFhPZmZzZXQgPSAxMjA7CgoKQGltcGxlbWVudGF0aW9uIE1lbnVWaWV3Q29udHJvbGxlcgoKI3ByYWdtYSBtYXJrIEluaXRpYWxpemF0aW9uCgotICh2b2lkKXZpZXdEaWRMb2FkIHsKICBbc3VwZXIgdmlld0RpZExvYWRdOwogIAogIFVJSW1hZ2VWaWV3ICpiZ0ltYWdlID0gW1tVSUltYWdlVmlldyBhbGxvY10gaW5pdFdpdGhJbWFnZTpbVUlJbWFnZSBpbWFnZU5hbWVkOkAiaG9tZS1iZyJdXTsKICBiZ0ltYWdlLmZyYW1lID0gc2VsZi50YWJsZVZpZXcuZnJhbWU7CiAgc2VsZi50YWJsZVZpZXcuYmFja2dyb3VuZFZpZXcgPSBiZ0ltYWdlOwogIAogIHNlbGYudXNlcm5hbWVMYWJlbC50ZXh0ID0gW1Nlc3Npb25NYW5hZ2VyIGdldFVzZXJuYW1lXTsKICAKICBzZWxmLnJlZnJlc2hDb250cm9sID0gW1tVSVJlZnJlc2hDb250cm9sIGFsbG9jXSBpbml0XTsKICBbc2VsZi50YWJsZVZpZXcgYWRkU3VidmlldzpzZWxmLnJlZnJlc2hDb250cm9sXTsKICBbc2VsZi5yZWZyZXNoQ29udHJvbCBhZGRUYXJnZXQ6c2VsZgogICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbjpAc2VsZWN0b3IocmVmcmVzaENoYW5uZWxzKQogICAgICAgICAgICAgICAgZm9yQ29udHJvbEV2ZW50czpVSUNvbnRyb2xFdmVudFZhbHVlQ2hhbmdlZF07CiAgc2VsZi5yZWZyZXNoQ29udHJvbC50aW50Q29sb3IgPSBbVUlDb2xvciB3aGl0ZUNvbG9yXTsKICAKICBDR1JlY3QgZnJhbWUgPSBzZWxmLnJlZnJlc2hDb250cm9sLmZyYW1lOwogIGZyYW1lLm9yaWdpbi54ID0gQ0dSZWN0R2V0TWluWChmcmFtZSkgLSBUV0NSZWZyZXNoQ29udHJvbFhPZmZzZXQ7CiAgc2VsZi5yZWZyZXNoQ29udHJvbC5mcmFtZSA9IGZyYW1lOwogIAogIFtDaGFubmVsTWFuYWdlciBzaGFyZWRNYW5hZ2VyXS5kZWxlZ2F0ZSA9IHNlbGY7CiAgW3NlbGYgcmVsb2FkQ2hhbm5lbExpc3RdOwp9CgojcHJhZ21hIG1hcmsgLSBUYWJsZSB2aWV3IGRhdGEgc291cmNlCgotIChOU0ludGVnZXIpdGFibGVWaWV3OihVSVRhYmxlVmlldyAqKXRhYmxlVmlldyBudW1iZXJPZlJvd3NJblNlY3Rpb246KE5TSW50ZWdlcilzZWN0aW9uIHsKICBpZiAoIVtDaGFubmVsTWFuYWdlciBzaGFyZWRNYW5hZ2VyXS5jaGFubmVscykgewogICAgcmV0dXJuIDE7CiAgfQogIAogIHJldHVybiBbQ2hhbm5lbE1hbmFnZXIgc2hhcmVkTWFuYWdlcl0uY2hhbm5lbHMuY291bnQ7Cn0KCi0gKFVJVGFibGVWaWV3Q2VsbCAqKXRhYmxlVmlldzooVUlUYWJsZVZpZXcgKil0YWJsZVZpZXcgY2VsbEZvclJvd0F0SW5kZXhQYXRoOihOU0luZGV4UGF0aCAqKWluZGV4UGF0aCB7CiAgVUlUYWJsZVZpZXdDZWxsICpjZWxsID0gbmlsOwogIAogIGlmICghW0NoYW5uZWxNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdLmNoYW5uZWxzKSB7CiAgICBjZWxsID0gW3NlbGYgbG9hZGluZ0NlbGxGb3JUYWJsZVZpZXc6dGFibGVWaWV3XTsKICB9CiAgZWxzZSB7CiAgICBjZWxsID0gW3NlbGYgY2hhbm5lbENlbGxGb3JUYWJsZVZpZXc6dGFibGVWaWV3IGF0SW5kZXhQYXRoOmluZGV4UGF0aF07CiAgfQogIFtjZWxsIGxheW91dElmTmVlZGVkXTsKICAKICByZXR1cm4gY2VsbDsKfQoKI3ByYWdtYSBtYXJrIC0gVGFibGUgdmlldyBkZWxlZ2F0ZQoKLSAoQk9PTCl0YWJsZVZpZXc6KFVJVGFibGVWaWV3ICopdGFibGVWaWV3IGNhbkVkaXRSb3dBdEluZGV4UGF0aDooTlNJbmRleFBhdGggKilpbmRleFBhdGggewogIFRDSENoYW5uZWwgKmNoYW5uZWwgPSBbW0NoYW5uZWxNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdLmNoYW5uZWxzIG9iamVjdEF0SW5kZXg6aW5kZXhQYXRoLnJvd107CiAgcmV0dXJuIGNoYW5uZWwgIT0gW0NoYW5uZWxNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdLmdlbmVyYWxDaGFubmVsOwp9CgoKLSAodm9pZCl0YWJsZVZpZXc6KFVJVGFibGVWaWV3ICopdGFibGVWaWV3IGNvbW1pdEVkaXRpbmdTdHlsZTooVUlUYWJsZVZpZXdDZWxsRWRpdGluZ1N0eWxlKWVkaXRpbmdTdHlsZSBmb3JSb3dBdEluZGV4UGF0aDooTlNJbmRleFBhdGggKilpbmRleFBhdGggewogIGlmIChlZGl0aW5nU3R5bGUgPT0gVUlUYWJsZVZpZXdDZWxsRWRpdGluZ1N0eWxlRGVsZXRlKSB7CiAgICBUQ0hDaGFubmVsICpjaGFubmVsID0gW1tDaGFubmVsTWFuYWdlciBzaGFyZWRNYW5hZ2VyXS5jaGFubmVscyBvYmplY3RBdEluZGV4OmluZGV4UGF0aC5yb3ddOwogICAgW2NoYW5uZWwgZGVzdHJveVdpdGhDb21wbGV0aW9uOl4oVENIUmVzdWx0ICpyZXN1bHQpIHsKICAgICAgaWYgKFtyZXN1bHQgaXNTdWNjZXNzZnVsXSkgewogICAgICAgIFt0YWJsZVZpZXcgcmVsb2FkRGF0YV07CiAgICAgIH0KICAgICAgZWxzZSB7CiAgICAgICAgW0FsZXJ0RGlhbG9nQ29udHJvbGxlciBzaG93QWxlcnRXaXRoTWVzc2FnZTpAIllvdSBjYW4gbm90IGRlbGV0ZSB0aGlzIGNoYW5uZWwiIHRpdGxlOm5pbCBwcmVzZW50ZXI6c2VsZl07CiAgICAgIH0KICAgIH1dOwogIH0KfQoKLSAodm9pZCl0YWJsZVZpZXc6KFVJVGFibGVWaWV3ICopdGFibGVWaWV3IGRpZFNlbGVjdFJvd0F0SW5kZXhQYXRoOihOU0luZGV4UGF0aCAqKWluZGV4UGF0aCB7CiAgW3NlbGYgcGVyZm9ybVNlZ3VlV2l0aElkZW50aWZpZXI6VFdDT3BlbkNoYW5uZWxTZWd1ZSBzZW5kZXI6aW5kZXhQYXRoXTsKfQoKI3ByYWdtYSBtYXJrIC0gSW50ZXJuYWwgbWV0aG9kcwoKLSAoVUlUYWJsZVZpZXdDZWxsICopbG9hZGluZ0NlbGxGb3JUYWJsZVZpZXc6KFVJVGFibGVWaWV3ICopdGFibGVWaWV3IHsKICByZXR1cm4gW3RhYmxlVmlldyBkZXF1ZXVlUmV1c2FibGVDZWxsV2l0aElkZW50aWZpZXI6QCJsb2FkaW5nQ2VsbCJdOwp9CgotIChVSVRhYmxlVmlld0NlbGwgKiljaGFubmVsQ2VsbEZvclRhYmxlVmlldzooVUlUYWJsZVZpZXcgKil0YWJsZVZpZXcgYXRJbmRleFBhdGg6KE5TSW5kZXhQYXRoICopaW5kZXhQYXRoIHsKICBNZW51VGFibGVDZWxsICptZW51Q2VsbCA9IChNZW51VGFibGVDZWxsICopW3RhYmxlVmlldyBkZXF1ZXVlUmV1c2FibGVDZWxsV2l0aElkZW50aWZpZXI6QCJjaGFubmVsQ2VsbCIgZm9ySW5kZXhQYXRoOmluZGV4UGF0aF07CiAgCiAgVENIQ2hhbm5lbCAqY2hhbm5lbCA9IFtbQ2hhbm5lbE1hbmFnZXIgc2hhcmVkTWFuYWdlcl0uY2hhbm5lbHMgb2JqZWN0QXRJbmRleDppbmRleFBhdGgucm93XTsKICBOU1N0cmluZyAqZnJpZW5kbHlOYW1lID0gY2hhbm5lbC5mcmllbmRseU5hbWU7CiAgaWYgKGNoYW5uZWwuZnJpZW5kbHlOYW1lLmxlbmd0aCA9PSAwKSB7CiAgICBmcmllbmRseU5hbWUgPSBAIihubyBmcmllbmRseSBuYW1lKSI7CiAgfQogIG1lbnVDZWxsLmNoYW5uZWxOYW1lID0gZnJpZW5kbHlOYW1lOwogIAogIHJldHVybiBtZW51Q2VsbDsKfQoKLSAodm9pZClyZWxvYWRDaGFubmVsTGlzdCB7CiAgW3NlbGYudGFibGVWaWV3IHJlbG9hZERhdGFdOwogIFtzZWxmLnJlZnJlc2hDb250cm9sIGVuZFJlZnJlc2hpbmddOwp9CgotICh2b2lkKXJlZnJlc2hDaGFubmVscyB7CiAgW3NlbGYucmVmcmVzaENvbnRyb2wgYmVnaW5SZWZyZXNoaW5nXTsKICBbc2VsZiByZWxvYWRDaGFubmVsTGlzdF07Cn0KCi0gKHZvaWQpZGVzZWxlY3RTZWxlY3RlZENoYW5uZWwgewogIE5TSW5kZXhQYXRoICpzZWxlY3RlZFJvdyA9IFtzZWxmLnRhYmxlVmlldyBpbmRleFBhdGhGb3JTZWxlY3RlZFJvd107CgogIGlmIChzZWxlY3RlZFJvdykgewogICAgW3NlbGYudGFibGVWaWV3IGRlc2VsZWN0Um93QXRJbmRleFBhdGg6c2VsZWN0ZWRSb3cgYW5pbWF0ZWQ6WUVTXTsKICB9Cn0KCiNwcmFnbWEgbWFyayAtIENoYW5uZWwKCi0gKHZvaWQpY3JlYXRlTmV3Q2hhbm5lbERpYWxvZyB7CiAgW0lucHV0RGlhbG9nQ29udHJvbGxlciBzaG93V2l0aFRpdGxlOkAiTmV3IENoYW5uZWwiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOkAiRW50ZXIgYSBuYW1lIGZvciB0aGlzIGNoYW5uZWwuIgogICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjpAIk5hbWUiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlc2VudGVyOnNlbGYgaGFuZGxlcjpeKE5TU3RyaW5nICp0ZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbW0NoYW5uZWxNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdIGNyZWF0ZUNoYW5uZWxXaXRoTmFtZTp0ZXh0IGNvbXBsZXRpb246XihCT09MIHN1Y2Nlc3MsIFRDSENoYW5uZWwgKmNoYW5uZWwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbc2VsZiByZWZyZXNoQ2hhbm5lbHNdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XTsKfQoKI3ByYWdtYSBtYXJrIC0gVHdpbGlvQ2hhdENsaWVudERlbGVnYXRlIGRlbGVnYXRlCgotICh2b2lkKWNoYXRDbGllbnQ6KFR3aWxpb0NoYXRDbGllbnQgKiljbGllbnQgY2hhbm5lbEFkZGVkOihUQ0hDaGFubmVsICopY2hhbm5lbCB7CiAgW3NlbGYudGFibGVWaWV3IHJlbG9hZERhdGFdOwp9CgotICh2b2lkKWNoYXRDbGllbnQ6KFR3aWxpb0NoYXRDbGllbnQgKiljbGllbnQgY2hhbm5lbENoYW5nZWQ6KFRDSENoYW5uZWwgKiljaGFubmVsIHsKICBbc2VsZi50YWJsZVZpZXcgcmVsb2FkRGF0YV07Cn0KCi0gKHZvaWQpY2hhdENsaWVudDooVHdpbGlvQ2hhdENsaWVudCAqKWNsaWVudCBjaGFubmVsRGVsZXRlZDooVENIQ2hhbm5lbCAqKWNoYW5uZWwgewogIFtzZWxmLnRhYmxlVmlldyByZWxvYWREYXRhXTsKfQoKI3ByYWdtYSBtYXJrIC0gTG9nb3V0CgotICh2b2lkKXByb210cExvZ291dCB7CiAgVUlBbGVydENvbnRyb2xsZXIgKmFsZXJ0ID0gW1VJQWxlcnRDb250cm9sbGVyIGFsZXJ0Q29udHJvbGxlcldpdGhUaXRsZTpuaWwKICAgIG1lc3NhZ2U6QCJZb3UgYXJlIGFib3V0IHRvIExvZ291dC4iIHByZWZlcnJlZFN0eWxlOlVJQWxlcnRDb250cm9sbGVyU3R5bGVBbGVydF07CiAgCiAgVUlBbGVydEFjdGlvbiAqY2FuY2VsQWN0aW9uID0gW1VJQWxlcnRBY3Rpb24gYWN0aW9uV2l0aFRpdGxlOkAiQ2FuY2VsIgogICAgc3R5bGU6VUlBbGVydEFjdGlvblN0eWxlQ2FuY2VsIGhhbmRsZXI6bmlsXTsKCiAgVUlBbGVydEFjdGlvbiAqY29uZmlybUFjdGlvbiA9IFtVSUFsZXJ0QWN0aW9uIGFjdGlvbldpdGhUaXRsZTpAIkNvbmZpcm0iCiAgICBzdHlsZTpVSUFsZXJ0QWN0aW9uU3R5bGVEZWZhdWx0CiAgICBoYW5kbGVyOl4oVUlBbGVydEFjdGlvbiAqYWN0aW9uKSB7CiAgICAgIFtzZWxmIGxvZ091dF07CiAgICB9XTsKCiAgW2FsZXJ0IGFkZEFjdGlvbjpjYW5jZWxBY3Rpb25dOwogIFthbGVydCBhZGRBY3Rpb246Y29uZmlybUFjdGlvbl07CiAgW3NlbGYgcHJlc2VudFZpZXdDb250cm9sbGVyOmFsZXJ0IGFuaW1hdGVkOllFUyBjb21wbGV0aW9uOm5pbF07Cn0KCi0gKHZvaWQpbG9nT3V0IHsKICBbW01lc3NhZ2luZ01hbmFnZXIgc2hhcmVkTWFuYWdlcl0gbG9nb3V0XTsKICBbW01lc3NhZ2luZ01hbmFnZXIgc2hhcmVkTWFuYWdlcl0gcHJlc2VudFJvb3RWaWV3Q29udHJvbGxlcl07Cn0KCiNwcmFnbWEgbWFyayBBY3Rpb25zCgotIChJQkFjdGlvbilsb2dvdXRCdXR0b25Ub3VjaGVkOihVSUJ1dHRvbiAqKXNlbmRlciB7CiAgW3NlbGYgcHJvbXRwTG9nb3V0XTsKfQoKLSAoSUJBY3Rpb24pbmV3Q2hhbm5lbEJ1dHRvblRvdWNoZWQ6KFVJQnV0dG9uICopc2VuZGVyIHsKICBbc2VsZiBjcmVhdGVOZXdDaGFubmVsRGlhbG9nXTsKfQoKI3ByYWdtYSBtYXJrIC0gTmF2aWdhdGlvbgoKLSAodm9pZClwcmVwYXJlRm9yU2VndWU6KFVJU3Rvcnlib2FyZFNlZ3VlICopc2VndWUgc2VuZGVyOihpZClzZW5kZXIgewogIGlmIChbc2VndWUuaWRlbnRpZmllciBpc0VxdWFsVG9TdHJpbmc6VFdDT3BlbkNoYW5uZWxTZWd1ZV0pIHsKICAgIE5TSW5kZXhQYXRoICppbmRleFBhdGggPSAoTlNJbmRleFBhdGggKilzZW5kZXI7CiAgICAKICAgIFRDSENoYW5uZWwgKmNoYW5uZWwgPSBbW0NoYW5uZWxNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdLmNoYW5uZWxzIG9iamVjdEF0SW5kZXg6aW5kZXhQYXRoLnJvd107CiAgICBVSU5hdmlnYXRpb25Db250cm9sbGVyICpuYXZpZ2F0aW9uQ29udHJvbGxlciA9IFtzZWd1ZSBkZXN0aW5hdGlvblZpZXdDb250cm9sbGVyXTsKICAgIE1haW5DaGF0Vmlld0NvbnRyb2xsZXIgKmNoYXRWaWV3Q29udHJvbGxlciA9IChNYWluQ2hhdFZpZXdDb250cm9sbGVyICopW25hdmlnYXRpb25Db250cm9sbGVyIHZpc2libGVWaWV3Q29udHJvbGxlcl07CiAgICBjaGF0Vmlld0NvbnRyb2xsZXIuY2hhbm5lbCA9IGNoYW5uZWw7CiAgfQp9CgojcHJhZ21hIG1hcmsgU3R5bGUKCi0gKFVJU3RhdHVzQmFyU3R5bGUpcHJlZmVycmVkU3RhdHVzQmFyU3R5bGUgewogIHJldHVybiBVSVN0YXR1c0JhclN0eWxlTGlnaHRDb250ZW50Owp9CgoKQGVuZAo=</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div><a href="https://github.com/TwilioDevEd/twiliochat-objc" target="_blank" class="explorer-get-code"> <i class="fa fa-lg fa-github-square"> </i>View Code on GitHub</a></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>