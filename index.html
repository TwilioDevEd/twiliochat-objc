<!DOCTYPE html><html><head><title>Twilio Chat</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Twilio Chat"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Twilio Chat</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>Learn to implement a simple chat application using Twilio IP Messaging Client</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Twilio Chat Objective-C" class="chapter"><div data-title="Introduction" data-file="twiliochat/AppDelegate.m" class="step"><h2 id="introduction">Introduction</h2>
<p>Ready to implement a chat application using Twilio IP Messaging Client?
Here is how it works at a high level:</p>
<ol>
<li><p>We use <a href="//www.parse.com/">Parse</a> to handle session management and user
registration in our app. </p>
</li>
<li><p><a href="//www.twilio.com/ip-messaging">Twilio IP Messaging</a> is the core product
we&#39;ll be using to handle all the chat functionality.</p>
</li>
<li><p>We use a server side app to generate <a href="//www.twilio.com/docs/api/ip-messaging/guides/identity">user access
tokens</a> which contains
all your Twilio account information. The IP Messaging Client uses this token
to connect with the API</p>
</li>
<li><p><a href="//media.twiliocdn.com/sdk/rtc/ios/common/releases/0.1.7.b23-4ca8945/docs/">Twilio Common</a>
is the part of the SDK than handles access tokens and even refreshes them upon token
expiration.</p>
</li>
</ol>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="//www.twilio.com/docs/api/ip-messaging">IP Messaging API</a></li>
<li><a href="//www.twilio.com/docs/api/ip-messaging/guides/quickstart-ios">iOS QuickStart</a></li>
<li><a href="//www.twilio.com/docs/api/ip-messaging/guides/channels">Channels and Messages</a></li>
<li><a href="//www.twilio.com/docs/api/ip-messaging/guides/channels">User Identity &amp; Access Tokens</a></li>
<li><a href="//media.twiliocdn.com/sdk/rtc/ios/ip-messaging/releases/0.13.3.b181-17abeb8/docs/">Twilio IP Messaging Client Reference</a></li>
<li><a href="//media.twiliocdn.com/sdk/rtc/ios/common/releases/0.1.7.b23-4ca8945/docs/">Twilio Common Reference</a></li>
</ul>
</div><div data-title="Initializing the Client" data-file="twiliochat/IPMessagingManager.m" data-highlight="105-154" class="step"><h2 id="initializing-the-ip-messaging-client">Initializing the IP Messaging Client</h2>
<p>The only thing you need to create a client, is an access token. This token
holds information about your Twilio account and IP Messaging API keys. You
can find an example application written in node that demonstrates how to
generate the token <a href="//github.com/TwilioDevEd/twiliochat">here</a>.</p>
<p>We use <a href="//parse.com/docs/cloudcode/guide#cloud-code-advanced-cloud-code-webhooks">Parse cloud code
webhooks</a>
to make a request to our server and get the access token.</p>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="//parse.com/docs/cloudcode/guide#cloud-code-advanced-cloud-code-webhooks">Parse cloud code webhooks</a></li>
</ul>
</div><div data-title="Getting the Channel List" data-file="twiliochat/ChannelManager.m" data-highlight="86-124" class="step"><h2 id="getting-the-channel-list">Getting the Channel List</h2>
<p>Our <code>ChannelManager</code> class takes care of everything related to channels.
The first thing we need to do when the class is initialized, is to store
a list of channels of type <code>TWMChannelList</code> that we get by calling the method <code>channelsListWithCompletion</code>
from the IP Messaging Client.</p>
<p>Once we have a <code>TWMChannelList</code> we can fetch the actual channels using the
<code>channelsList&#39;s</code> method <code>loadChannelsWithCompletion</code>. Once that operation
finishes successfully, call the method <code>allObjects</code> on the same object, to
get an array of channels.</p>
</div><div data-title="Join the General Channel" data-file="twiliochat/ChannelManager.m" data-highlight="37-82" class="step"><h2 id="join-the-general-channel">Join the General Channel</h2>
<p>This application will try to join a channel called &quot;General Channel&quot; when it starts.
If the channel doesn&#39;t exist, we&#39;ll create one with that name. The scope of
this example application will show you how to work only with public channels,
but the IP Messaging client allows you to create private channels and handle
invitations.</p>
<p>Once you have joined a channel, you can register a class as the <code>TWMChannelDelegate</code>
so you can start listening to events such as <code>messageAdded</code> or <code>memberJoined</code>.
We&#39;ll show you how to do this in the next step.</p>
</div><div data-title="Listen to Channel Events" data-file="twiliochat/MainChatViewController.m" data-highlight="226-253" class="step"><h2 id="listen-to-channel-events">Listen to Channel Events</h2>
<p>We registered <code>MainChatViewController</code> as the <code>TWMChannelDelegate</code>, and here
we implemented the following methods that listen to channel events:</p>
<ul>
<li><code>messageAdded</code>: When someone sends a message to the channel you are connected to.</li>
<li><code>channelDeleted</code>: When someone deletes a channel.</li>
<li><code>memberJoined</code>: When someone joins the channel.</li>
<li><code>memberLeft</code>: When someone leaves the channel.</li>
</ul>
<p>As you may have noticed, each one of these methods include useful objects
as parameters, such as the actual message that was added to the channel.</p>
</div><div data-title="Joining Other Channels" data-file="twiliochat/MainChatViewController.m" data-highlight="88-115" class="step"><h2 id="joining-other-channels">Joining Other Channels</h2>
<p>The application uses <a href="//github.com/John-Lluch/SWRevealViewController">SWRevealViewController</a>
to show a sidebar that contains a list of the channels created for that Twilio account.</p>
<p>When you tap on the name of a channel from the sidebar, that channel is set
on the <code>MainChatViewController</code>. The <code>setChannel</code> method takes care of joining
to the selected channel and loading the messages.</p>
</div><div data-title="Creating a Channel" data-file="twiliochat/ChannelManager.m" data-highlight="136-160" class="step"><h2 id="creating-a-channel">Creating a Channel</h2>
<p>We use an input dialog so the user can type the name of the new channel.
The only restriction here, is that the user can&#39;t create a channel called
&quot;General Channel&quot;. Other than that, creating a channel is as simple as calling
<code>createChannelWithFriendlyName</code></p>
</div><div data-title="Deleting a Channel" data-file="twiliochat/MenuViewController.m" data-highlight="81-93" class="step"><h2 id="deleting-a-channel">Deleting a Channel</h2>
<p>Deleting a channel is as simple as creating one. We&#39;ll use the <code>UITableView</code>
hability to delete a cell. Once you have figured out what channel is meant
to be deleted (from the selected cell index path), deleting it is as simple
as calling the channel&#39;s method <code>destroyWithCompletion</code>.</p>
</div><div data-title="Where to Next?" class="step"><h2 id="where-to-next-">Where to Next?</h2>
<p>That&#39;s it! We&#39;ve just implemented a simple chat application in objective-c.</p>
<p>Thanks for checking out this tutorial! If you have any feedback to share
with us, we&#39;d love to hear it. Tweet
<a href="http://twitter.com/twilio">@twilio</a> to let us know what you think.</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="twiliochat/AppDelegate.m" data-mode="objectivec">I2ltcG9ydCA8UGFyc2UvUGFyc2UuaD4KI2ltcG9ydCAiQXBwRGVsZWdhdGUuaCIKI2ltcG9ydCAiSVBNZXNzYWdpbmdNYW5hZ2VyLmgiCkBpbXBvcnQgRm91bmRhdGlvbjsKCgpAaW50ZXJmYWNlIEFwcERlbGVnYXRlICgpCgpAZW5kCgpAaW1wbGVtZW50YXRpb24gQXBwRGVsZWdhdGUKCgotIChCT09MKWFwcGxpY2F0aW9uOihVSUFwcGxpY2F0aW9uICopYXBwbGljYXRpb24gZGlkRmluaXNoTGF1bmNoaW5nV2l0aE9wdGlvbnM6KE5TRGljdGlvbmFyeSAqKWxhdW5jaE9wdGlvbnMgewogICAgW1BhcnNlIGVuYWJsZUxvY2FsRGF0YXN0b3JlXTsKICAgIAogICAgTlNEaWN0aW9uYXJ5ICpkaWN0aW9uYXJ5ID0gW05TRGljdGlvbmFyeSBkaWN0aW9uYXJ5V2l0aENvbnRlbnRzT2ZGaWxlOltbTlNCdW5kbGUgbWFpbkJ1bmRsZV0gcGF0aEZvclJlc291cmNlOkAiS2V5cyIgb2ZUeXBlOkAicGxpc3QiXV07CiAgICBOU1N0cmluZyAqcGFyc2VBcHBsaWNhdGlvbklkID0gW2RpY3Rpb25hcnkgb2JqZWN0Rm9yS2V5OkAiUGFyc2VBcHBsaWNhdGlvbklkIl07CiAgICBOU1N0cmluZyAqcGFyc2VDbGllbnRLZXkgPSBbZGljdGlvbmFyeSBvYmplY3RGb3JLZXk6QCJQYXJzZUNsaWVudEtleSJdOwoKICAgIFtQYXJzZSBzZXRBcHBsaWNhdGlvbklkOnBhcnNlQXBwbGljYXRpb25JZAogICAgICAgICAgICAgICAgICBjbGllbnRLZXk6cGFyc2VDbGllbnRLZXldOwogICAgCiAgICBQRkFDTCAqZGVmYXVsdEFDTCA9IFtQRkFDTCBBQ0xdOwogICAgW2RlZmF1bHRBQ0wgc2V0UHVibGljUmVhZEFjY2VzczpZRVNdOwogICAgW1BGQUNMIHNldERlZmF1bHRBQ0w6ZGVmYXVsdEFDTCB3aXRoQWNjZXNzRm9yQ3VycmVudFVzZXI6WUVTXTsKCiAgICBbW0lQTWVzc2FnaW5nTWFuYWdlciBzaGFyZWRNYW5hZ2VyXSBwcmVzZW50TGF1bmNoU2NyZWVuXTsKICAgIFtbSVBNZXNzYWdpbmdNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdIHByZXNlbnRSb290Vmlld0NvbnRyb2xsZXJdOwogICAgCiAgICByZXR1cm4gWUVTOwp9CgotICh2b2lkKWFwcGxpY2F0aW9uV2lsbFJlc2lnbkFjdGl2ZTooVUlBcHBsaWNhdGlvbiAqKWFwcGxpY2F0aW9uIHsKICAgIC8vIFNlbnQgd2hlbiB0aGUgYXBwbGljYXRpb24gaXMgYWJvdXQgdG8gbW92ZSBmcm9tIGFjdGl2ZSB0byBpbmFjdGl2ZSBzdGF0ZS4gVGhpcyBjYW4gb2NjdXIgZm9yIGNlcnRhaW4gdHlwZXMgb2YgdGVtcG9yYXJ5IGludGVycnVwdGlvbnMgKHN1Y2ggYXMgYW4gaW5jb21pbmcgcGhvbmUgY2FsbCBvciBTTVMgbWVzc2FnZSkgb3Igd2hlbiB0aGUgdXNlciBxdWl0cyB0aGUgYXBwbGljYXRpb24gYW5kIGl0IGJlZ2lucyB0aGUgdHJhbnNpdGlvbiB0byB0aGUgYmFja2dyb3VuZCBzdGF0ZS4KICAgIC8vIFVzZSB0aGlzIG1ldGhvZCB0byBwYXVzZSBvbmdvaW5nIHRhc2tzLCBkaXNhYmxlIHRpbWVycywgYW5kIHRocm90dGxlIGRvd24gT3BlbkdMIEVTIGZyYW1lIHJhdGVzLiBHYW1lcyBzaG91bGQgdXNlIHRoaXMgbWV0aG9kIHRvIHBhdXNlIHRoZSBnYW1lLgp9CgotICh2b2lkKWFwcGxpY2F0aW9uRGlkRW50ZXJCYWNrZ3JvdW5kOihVSUFwcGxpY2F0aW9uICopYXBwbGljYXRpb24gewogICAgLy8gVXNlIHRoaXMgbWV0aG9kIHRvIHJlbGVhc2Ugc2hhcmVkIHJlc291cmNlcywgc2F2ZSB1c2VyIGRhdGEsIGludmFsaWRhdGUgdGltZXJzLCBhbmQgc3RvcmUgZW5vdWdoIGFwcGxpY2F0aW9uIHN0YXRlIGluZm9ybWF0aW9uIHRvIHJlc3RvcmUgeW91ciBhcHBsaWNhdGlvbiB0byBpdHMgY3VycmVudCBzdGF0ZSBpbiBjYXNlIGl0IGlzIHRlcm1pbmF0ZWQgbGF0ZXIuCiAgICAvLyBJZiB5b3VyIGFwcGxpY2F0aW9uIHN1cHBvcnRzIGJhY2tncm91bmQgZXhlY3V0aW9uLCB0aGlzIG1ldGhvZCBpcyBjYWxsZWQgaW5zdGVhZCBvZiBhcHBsaWNhdGlvbldpbGxUZXJtaW5hdGU6IHdoZW4gdGhlIHVzZXIgcXVpdHMuCn0KCi0gKHZvaWQpYXBwbGljYXRpb25XaWxsRW50ZXJGb3JlZ3JvdW5kOihVSUFwcGxpY2F0aW9uICopYXBwbGljYXRpb24gewogICAgLy8gQ2FsbGVkIGFzIHBhcnQgb2YgdGhlIHRyYW5zaXRpb24gZnJvbSB0aGUgYmFja2dyb3VuZCB0byB0aGUgaW5hY3RpdmUgc3RhdGU7IGhlcmUgeW91IGNhbiB1bmRvIG1hbnkgb2YgdGhlIGNoYW5nZXMgbWFkZSBvbiBlbnRlcmluZyB0aGUgYmFja2dyb3VuZC4KfQoKLSAodm9pZClhcHBsaWNhdGlvbkRpZEJlY29tZUFjdGl2ZTooVUlBcHBsaWNhdGlvbiAqKWFwcGxpY2F0aW9uIHsKICAgIC8vIFJlc3RhcnQgYW55IHRhc2tzIHRoYXQgd2VyZSBwYXVzZWQgKG9yIG5vdCB5ZXQgc3RhcnRlZCkgd2hpbGUgdGhlIGFwcGxpY2F0aW9uIHdhcyBpbmFjdGl2ZS4gSWYgdGhlIGFwcGxpY2F0aW9uIHdhcyBwcmV2aW91c2x5IGluIHRoZSBiYWNrZ3JvdW5kLCBvcHRpb25hbGx5IHJlZnJlc2ggdGhlIHVzZXIgaW50ZXJmYWNlLgp9CgotICh2b2lkKWFwcGxpY2F0aW9uV2lsbFRlcm1pbmF0ZTooVUlBcHBsaWNhdGlvbiAqKWFwcGxpY2F0aW9uIHsKICAgIC8vIENhbGxlZCB3aGVuIHRoZSBhcHBsaWNhdGlvbiBpcyBhYm91dCB0byB0ZXJtaW5hdGUuIFNhdmUgZGF0YSBpZiBhcHByb3ByaWF0ZS4gU2VlIGFsc28gYXBwbGljYXRpb25EaWRFbnRlckJhY2tncm91bmQ6Lgp9CgpAZW5kCg==</textarea>
<textarea class="saurus-file" data-file="twiliochat/IPMessagingManager.m" data-mode="objectivec">I2ltcG9ydCA8UGFyc2UvUGFyc2UuaD4KI2ltcG9ydCAiSVBNZXNzYWdpbmdNYW5hZ2VyLmgiCiNpbXBvcnQgIkNoYW5uZWxNYW5hZ2VyLmgiCgpAaW50ZXJmYWNlIElQTWVzc2FnaW5nTWFuYWdlciAoKQpAcHJvcGVydHkgKG5vbmF0b21pYywgc3Ryb25nKSBUd2lsaW9JUE1lc3NhZ2luZ0NsaWVudCAqY2xpZW50OwpAcHJvcGVydHkgKG5vbmF0b21pYykgQk9PTCBjb25uZWN0ZWQ7CkBlbmQKCkBpbXBsZW1lbnRhdGlvbiBJUE1lc3NhZ2luZ01hbmFnZXIKKyAoaW5zdGFuY2V0eXBlKXNoYXJlZE1hbmFnZXIgewogICAgc3RhdGljIElQTWVzc2FnaW5nTWFuYWdlciAqc2hhcmVkTXlNYW5hZ2VyID0gbmlsOwogICAgc3RhdGljIGRpc3BhdGNoX29uY2VfdCBvbmNlVG9rZW47CiAgICBkaXNwYXRjaF9vbmNlKCZvbmNlVG9rZW4sIF57CiAgICAgICAgc2hhcmVkTXlNYW5hZ2VyID0gW1tzZWxmIGFsbG9jXSBpbml0XTsKICAgIH0pOwogICAgcmV0dXJuIHNoYXJlZE15TWFuYWdlcjsKfQoKIyBwcmFnbWEgbWFyayBQcmVzZW50IHZpZXcgY29udHJvbGxlcnMKCi0gKHZvaWQpcHJlc2VudFJvb3RWaWV3Q29udHJvbGxlciB7CiAgICBpZiAoIXNlbGYuaGFzSWRlbnRpdHkpIHsKICAgICAgICBbc2VsZiBwcmVzZW50Vmlld0NvbnRyb2xsZXJCeU5hbWU6QCJMb2dpblZpZXdDb250cm9sbGVyIl07CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgaWYgKCFzZWxmLmNvbm5lY3RlZCkgewogICAgICAgIFtzZWxmIGNvbm5lY3RDbGllbnRXaXRoQ29tcGxldGlvbjpeKEJPT0wgc3VjY2VzcywgTlNFcnJvciAqZXJyb3IpIHsKICAgICAgICAgICAgTlNTdHJpbmcgKnZpZXdDb250cm9sbGVyID0gc3VjY2VzcyA/IEAiUmV2ZWFsVmlld0NvbnRyb2xsZXIiIDogQCJMb2dpblZpZXdDb250cm9sbGVyIjsKICAgICAgICAgICAgW3NlbGYgcHJlc2VudFZpZXdDb250cm9sbGVyQnlOYW1lOnZpZXdDb250cm9sbGVyXTsKICAgICAgICB9XTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBbc2VsZiBwcmVzZW50Vmlld0NvbnRyb2xsZXJCeU5hbWU6QCJSZXZlYWxWaWV3Q29udHJvbGxlciJdOwp9CgotICh2b2lkKXByZXNlbnRWaWV3Q29udHJvbGxlckJ5TmFtZTooTlNTdHJpbmcgKil2aWV3Q29udHJvbGxlciB7CiAgICBbc2VsZiBwcmVzZW50Vmlld0NvbnRyb2xsZXI6W1tzZWxmIHN0b3J5Ym9hcmRXaXRoTmFtZTpAIk1haW4iXSBpbnN0YW50aWF0ZVZpZXdDb250cm9sbGVyV2l0aElkZW50aWZpZXI6dmlld0NvbnRyb2xsZXJdXTsKfQoKLSAodm9pZClwcmVzZW50TGF1bmNoU2NyZWVuIHsKICAgIFtzZWxmIHByZXNlbnRWaWV3Q29udHJvbGxlcjpbW3NlbGYgc3Rvcnlib2FyZFdpdGhOYW1lOkAiTGF1bmNoU2NyZWVuIl0gaW5zdGFudGlhdGVJbml0aWFsVmlld0NvbnRyb2xsZXJdXTsKfQoKLSAodm9pZClwcmVzZW50Vmlld0NvbnRyb2xsZXI6KFVJVmlld0NvbnRyb2xsZXIgKil2aWV3Q29udHJvbGxlciB7CiAgICBVSVdpbmRvdyAqd2luZG93ID0gW1tVSUFwcGxpY2F0aW9uIHNoYXJlZEFwcGxpY2F0aW9uXS5kZWxlZ2F0ZSB3aW5kb3ddOwogICAgd2luZG93LnJvb3RWaWV3Q29udHJvbGxlciA9IHZpZXdDb250cm9sbGVyOwp9CgotIChVSVN0b3J5Ym9hcmQgKilzdG9yeWJvYXJkV2l0aE5hbWU6KE5TU3RyaW5nICopbmFtZSB7CiAgICByZXR1cm4gW1VJU3Rvcnlib2FyZCBzdG9yeWJvYXJkV2l0aE5hbWU6IG5hbWUgYnVuZGxlOiBbTlNCdW5kbGUgbWFpbkJ1bmRsZV1dOwp9CgojIHByYWdtYSBtYXJrIFVzZXIgYW5kIHNlc3Npb24gbWFuYWdlbWVudAoKLSAoQk9PTCloYXNJZGVudGl0eSB7CiAgICByZXR1cm4gW1BGVXNlciBjdXJyZW50VXNlcl0gJiYgW1tQRlVzZXIgY3VycmVudFVzZXJdIGlzQXV0aGVudGljYXRlZF07Cn0KCi0gKHZvaWQpcmVnaXN0ZXJXaXRoVXNlcm5hbWU6KE5TU3RyaW5nICopdXNlcm5hbWUKICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDooTlNTdHJpbmcgKilwYXNzd29yZAogICAgICAgICAgICAgICAgICAgIGZ1bGxOYW1lOihOU1N0cmluZyAqKWZ1bGxOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgZW1haWw6KE5TU3RyaW5nICopZW1haWwKICAgICAgICAgICAgICAgICAgY29tcGxldGlvbjooU3RhdHVzV2l0aEVycm9ySGFuZGxlciljb21wbGV0aW9uIHsKICAgIFBGVXNlciAqdXNlciA9IFtQRlVzZXIgdXNlcl07CiAgICB1c2VyLnVzZXJuYW1lID0gdXNlcm5hbWU7CiAgICB1c2VyLnBhc3N3b3JkID0gcGFzc3dvcmQ7CiAgICB1c2VyLmVtYWlsID0gZW1haWw7CiAgICB1c2VyW0AiZnVsbE5hbWUiXSA9IGZ1bGxOYW1lOwogICAgCiAgICBbdXNlciBzaWduVXBJbkJhY2tncm91bmRXaXRoQmxvY2s6XihCT09MIHN1Y2NlZWRlZCwgTlNFcnJvciAqZXJyb3IpIHsKICAgICAgICBpZiAoc3VjY2VlZGVkKSB7CiAgICAgICAgICAgIFtzZWxmIGNvbm5lY3RDbGllbnRXaXRoQ29tcGxldGlvbjpjb21wbGV0aW9uXTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoY29tcGxldGlvbikgY29tcGxldGlvbihzdWNjZWVkZWQsIGVycm9yKTsKICAgIH1dOwp9CgotICh2b2lkKWxvZ2luV2l0aFVzZXJuYW1lOihOU1N0cmluZyAqKXVzZXJuYW1lIHBhc3N3b3JkOihOU1N0cmluZyAqKXBhc3N3b3JkCiAgICAgICAgICAgICAgIGNvbXBsZXRpb246KFN0YXR1c1dpdGhFcnJvckhhbmRsZXIpY29tcGxldGlvbiB7CiAgICBbUEZVc2VyIGxvZ0luV2l0aFVzZXJuYW1lSW5CYWNrZ3JvdW5kOnVzZXJuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOnBhc3N3b3JkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrOl4oUEZVc2VyICp1c2VyLCBOU0Vycm9yICplcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtzZWxmIGNvbm5lY3RDbGllbnRXaXRoQ29tcGxldGlvbjpjb21wbGV0aW9uXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29tcGxldGlvbikgY29tcGxldGlvbighZXJyb3IsIGVycm9yKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfV07Cn0KCi0gKHZvaWQpbG9nb3V0IHsKICAgIFtQRlVzZXIgbG9nT3V0XTsKICAgIHNlbGYuY29ubmVjdGVkID0gTk87CiAgICAKICAgIGRpc3BhdGNoX2FzeW5jKGRpc3BhdGNoX2dldF9nbG9iYWxfcXVldWUoRElTUEFUQ0hfUVVFVUVfUFJJT1JJVFlfREVGQVVMVCwgMCksIF57CiAgICAgICAgW3NlbGYuY2xpZW50IHNodXRkb3duXTsKICAgICAgICBzZWxmLmNsaWVudCA9IG5pbDsKICAgIH0pOwp9CgojIHByYWdtYSBtYXJrIFR3aWxpbyBDbGllbnQKCi0gKHZvaWQpY29ubmVjdENsaWVudFdpdGhDb21wbGV0aW9uOihTdGF0dXNXaXRoRXJyb3JIYW5kbGVyKWNvbXBsZXRpb24gewogICAgaWYgKHNlbGYuY2xpZW50KSB7CiAgICAgICAgW3NlbGYgbG9nb3V0XTsKICAgIH0KICAgIAogICAgW3NlbGYgcmVxdWVzdFRva2VuV2l0aENvbXBsZXRpb246XihCT09MIHN1Y2NlZWRlZCwgTlNTdHJpbmcgKnRva2VuKSB7CiAgICAgICAgaWYgKHN1Y2NlZWRlZCkgewogICAgICAgICAgICBbc2VsZiBpbml0aWFsaXplQ2xpZW50V2l0aFRva2VuOiB0b2tlbl07CiAgICAgICAgICAgIFtzZWxmIGxvYWRHZW5lcmFsQ2hhdFJvb21XaXRoQ29tcGxldGlvbjpjb21wbGV0aW9uXTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIE5TRXJyb3IgKmVycm9yID0gW3NlbGYgZXJyb3JXaXRoRGVzY3JpcHRpb246QCJDb3VsZCBub3QgZ2V0IGFjY2VzcyB0b2tlbiIgY29kZTozMDFdOwogICAgICAgICAgICBpZiAoY29tcGxldGlvbikgY29tcGxldGlvbihzdWNjZWVkZWQsIGVycm9yKTsKICAgICAgICB9CiAgICB9XTsKfQoKLSAodm9pZClpbml0aWFsaXplQ2xpZW50V2l0aFRva2VuOihOU1N0cmluZyAqKXRva2VuIHsKICAgIFR3aWxpb0FjY2Vzc01hbmFnZXIgKmFjY2Vzc01hbmFnZXIgPSBbVHdpbGlvQWNjZXNzTWFuYWdlciBhY2Nlc3NNYW5hZ2VyV2l0aFRva2VuOnRva2VuIGRlbGVnYXRlOiBzZWxmXTsKICAgIHNlbGYuY2xpZW50ID0gW1R3aWxpb0lQTWVzc2FnaW5nQ2xpZW50IGlwTWVzc2FnaW5nQ2xpZW50V2l0aEFjY2Vzc01hbmFnZXI6YWNjZXNzTWFuYWdlciBkZWxlZ2F0ZTpuaWxdOwp9CgotICh2b2lkKWxvYWRHZW5lcmFsQ2hhdFJvb21XaXRoQ29tcGxldGlvbjooU3RhdHVzV2l0aEVycm9ySGFuZGxlciljb21wbGV0aW9uIHsKICAgIFtbQ2hhbm5lbE1hbmFnZXIgc2hhcmVkTWFuYWdlcl0gam9pbkdlbmVyYWxDaGF0Um9vbVdpdGhDb21wbGV0aW9uOl4oQk9PTCBzdWNjZWVkZWQpIHsKICAgICAgICBpZiAoc3VjY2VlZGVkKQogICAgICAgIHsKICAgICAgICAgICAgc2VsZi5jb25uZWN0ZWQgPSBZRVM7CiAgICAgICAgICAgIGlmIChjb21wbGV0aW9uKSBjb21wbGV0aW9uKHN1Y2NlZWRlZCwgbmlsKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIE5TRXJyb3IgKmVycm9yID0gW3NlbGYgZXJyb3JXaXRoRGVzY3JpcHRpb246QCJDb3VsZCBub3Qgam9pbiBHZW5lcmFsIGNoYW5uZWwiIGNvZGU6MzAwXTsKICAgICAgICAgICAgaWYgKGNvbXBsZXRpb24pIGNvbXBsZXRpb24oc3VjY2VlZGVkLCBlcnJvcik7CiAgICAgICAgfQogICAgfV07Cn0KCi0gKHZvaWQpcmVxdWVzdFRva2VuV2l0aENvbXBsZXRpb246KFN0YXR1c1dpdGhUb2tlbkhhbmRsZXIpY29tcGxldGlvbiB7CiAgICBOU1N0cmluZyAqdXVpZCA9IFtbVUlEZXZpY2UgY3VycmVudERldmljZV0gaWRlbnRpZmllckZvclZlbmRvcl0uVVVJRFN0cmluZzsKICAgIE5TRGljdGlvbmFyeSAqcGFyYW1ldGVycyA9IEB7QCJkZXZpY2UiOiB1dWlkfTsKICAgIAogICAgW1BGQ2xvdWQgY2FsbEZ1bmN0aW9uSW5CYWNrZ3JvdW5kOkAidG9rZW4iCiAgICAgICAgICAgICAgICAgICAgICAgd2l0aFBhcmFtZXRlcnM6cGFyYW1ldGVycwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrOl4oTlNEaWN0aW9uYXJ5ICpyZXN1bHRzLCBOU0Vycm9yICplcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOU1N0cmluZyAqdG9rZW4gPSBbcmVzdWx0cyBvYmplY3RGb3JLZXk6QCJ0b2tlbiJdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCT09MIGVycm9yQ29uZGl0aW9uID0gZXJyb3IgfHwgIXRva2VuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBsZXRpb24pIGNvbXBsZXRpb24oIWVycm9yQ29uZGl0aW9uLCB0b2tlbik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfV07CiAgICAKfQoKLSAoTlNFcnJvciAqKWVycm9yV2l0aERlc2NyaXB0aW9uOihOU1N0cmluZyAqKWRlc2NyaXB0aW9uIGNvZGU6KE5TSW50ZWdlciljb2RlIHsKICAgIE5TRGljdGlvbmFyeSAqdXNlckluZm8gPSBAe05TTG9jYWxpemVkRGVzY3JpcHRpb25LZXk6IGRlc2NyaXB0aW9ufTsKICAgIE5TRXJyb3IgKmVycm9yID0gW05TRXJyb3IgZXJyb3JXaXRoRG9tYWluOkAiYXBwIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6Y29kZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlckluZm86dXNlckluZm9dOwogICAgcmV0dXJuIGVycm9yOwp9CgojIHByYWdtYSBtYXJrIFR3aWxpb0FjY2Vzc01hbmFnZXJEZWxlZ2F0ZQoKLSAodm9pZClhY2Nlc3NNYW5hZ2VyVG9rZW5FeHBpcmVkOihUd2lsaW9BY2Nlc3NNYW5hZ2VyICopYWNjZXNzTWFuYWdlciB7CiAgICBbc2VsZiByZXF1ZXN0VG9rZW5XaXRoQ29tcGxldGlvbjpeKEJPT0wgc3VjY2VlZGVkLCBOU1N0cmluZyAqdG9rZW4pIHsKICAgICAgICBpZiAoc3VjY2VlZGVkKSB7CiAgICAgICAgICAgIFthY2Nlc3NNYW5hZ2VyIHVwZGF0ZVRva2VuOnRva2VuXTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIE5TTG9nKEAiRXJyb3Igd2hpbGUgdHJ5aW5nIHRvIGdldCBuZXcgYWNjZXNzIHRva2VuIik7CiAgICAgICAgfQogICAgfV07Cn0KCi0gKHZvaWQpYWNjZXNzTWFuYWdlcjooVHdpbGlvQWNjZXNzTWFuYWdlciAqKWFjY2Vzc01hbmFnZXIgZXJyb3I6KE5TRXJyb3IgKillcnJvciB7CiAgICBOU0xvZyhAIkFjY2VzcyBtYW5hZ2VyIGVycm9yOiAlQCIsIFtlcnJvciBsb2NhbGl6ZWREZXNjcmlwdGlvbl0pOwp9CgojcHJhZ21hIG1hcmsgSW50ZXJuYWwgaGVscGVycwoKLSAoTlNTdHJpbmcgKil1c2VySWRlbnRpdHkgewogICAgcmV0dXJuIFtbUEZVc2VyIGN1cnJlbnRVc2VyXSB1c2VybmFtZV07Cn0KCkBlbmQK</textarea>
<textarea class="saurus-file" data-file="twiliochat/ChannelManager.m" data-mode="objectivec">I2ltcG9ydCAiQ2hhbm5lbE1hbmFnZXIuaCIKI2ltcG9ydCAiSVBNZXNzYWdpbmdNYW5hZ2VyLmgiCgpAaW50ZXJmYWNlIENoYW5uZWxNYW5hZ2VyICgpCnsKICAgIFRXTUNoYW5uZWwgKl9nZW5lcmFsQ2hhdHJvb207Cn0KQGVuZAoKTlNTdHJpbmcgKmRlZmF1bHRDaGFubmVsVW5pcXVlTmFtZSA9IEAiZ2VuZXJhbCI7Ck5TU3RyaW5nICpkZWZhdWx0Q2hhbm5lbE5hbWUgPSBAIkdlbmVyYWwgQ2hhbm5lbCI7CgpAaW1wbGVtZW50YXRpb24gQ2hhbm5lbE1hbmFnZXIKCisgKGluc3RhbmNldHlwZSlzaGFyZWRNYW5hZ2VyIHsKICAgIHN0YXRpYyBDaGFubmVsTWFuYWdlciAqc2hhcmVkTXlNYW5hZ2VyID0gbmlsOwogICAgc3RhdGljIGRpc3BhdGNoX29uY2VfdCBvbmNlVG9rZW47CiAgICBkaXNwYXRjaF9vbmNlKCZvbmNlVG9rZW4sIF57CiAgICAgICAgc2hhcmVkTXlNYW5hZ2VyID0gW1tzZWxmIGFsbG9jXSBpbml0XTsKICAgIH0pOwogICAgcmV0dXJuIHNoYXJlZE15TWFuYWdlcjsKfQoKLSAoaW5zdGFuY2V0eXBlKWluaXQgewogICAgCiAgICBzZWxmLmNoYW5uZWxzID0gW1tOU011dGFibGVPcmRlcmVkU2V0IGFsbG9jXSBpbml0XTsKICAgIFtJUE1lc3NhZ2luZ01hbmFnZXIgc2hhcmVkTWFuYWdlcl0uY2xpZW50LmRlbGVnYXRlID0gc2VsZjsKICAgIHJldHVybiBzZWxmOwp9CgojcHJhZ21hIG1hcmsgR2VuZXJhbCBjaGFubmVsCgotIChUV01DaGFubmVsICopZ2VuZXJhbENoYXRyb29tIHsKICAgIHJldHVybiBfZ2VuZXJhbENoYXRyb29tOwp9CgotICh2b2lkKWpvaW5HZW5lcmFsQ2hhdFJvb21XaXRoQ29tcGxldGlvbjooU3VjY2VlZEhhbmRsZXIpY29tcGxldGlvbiB7CiAgICBbc2VsZiBwb3B1bGF0ZUNoYW5uZWxzV2l0aENvbXBsZXRpb246XihCT09MIHN1Y2NlZWRlZCkgewogICAgICAgIF9nZW5lcmFsQ2hhdHJvb20gPSBbc2VsZi5jaGFubmVsc0xpc3QgY2hhbm5lbFdpdGhVbmlxdWVOYW1lOmRlZmF1bHRDaGFubmVsVW5pcXVlTmFtZV07CiAgICAgICAgaWYgKF9nZW5lcmFsQ2hhdHJvb20pIHsKICAgICAgICAgICAgW3NlbGYgam9pbkdlbmVyYWxDaGF0Um9vbVdpdGhVbmlxdWVOYW1lOm5pbCBjb21wbGV0aW9uOmNvbXBsZXRpb25dOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgW3NlbGYgY3JlYXRlR2VuZXJhbENoYXRSb29tV2l0aENvbXBsZXRpb246XihCT09MIHN1Y2NlZWRlZCkgewogICAgICAgICAgICAgICAgaWYgKHN1Y2NlZWRlZCkgewogICAgICAgICAgICAgICAgICAgIFtzZWxmIGpvaW5HZW5lcmFsQ2hhdFJvb21XaXRoVW5pcXVlTmFtZTpkZWZhdWx0Q2hhbm5lbFVuaXF1ZU5hbWUgY29tcGxldGlvbjpjb21wbGV0aW9uXTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoY29tcGxldGlvbikgY29tcGxldGlvbihOTyk7CiAgICAgICAgICAgIH1dOwogICAgICAgIH0KICAgIH1dOwp9CgotICh2b2lkKWpvaW5HZW5lcmFsQ2hhdFJvb21XaXRoVW5pcXVlTmFtZTooTlNTdHJpbmcgKil1bmlxdWVOYW1lIGNvbXBsZXRpb246KFN1Y2NlZWRIYW5kbGVyKWNvbXBsZXRpb24gewogICAgW19nZW5lcmFsQ2hhdHJvb20gam9pbldpdGhDb21wbGV0aW9uOl4oVFdNUmVzdWx0IHJlc3VsdCkgewogICAgICAgIGlmIChyZXN1bHQgPT0gVFdNUmVzdWx0U3VjY2VzcykgewogICAgICAgICAgICBpZiAodW5pcXVlTmFtZSkgewogICAgICAgICAgICAgICAgW3NlbGYgc2V0R2VuZXJhbENoYXRSb29tVW5pcXVlTmFtZVdpdGhDb21wbGV0aW9uOmNvbXBsZXRpb25dOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChjb21wbGV0aW9uKSBjb21wbGV0aW9uKHJlc3VsdCA9PSBUV01SZXN1bHRTdWNjZXNzKTsKICAgIH1dOwp9CgotICh2b2lkKWNyZWF0ZUdlbmVyYWxDaGF0Um9vbVdpdGhDb21wbGV0aW9uOihTdWNjZWVkSGFuZGxlciljb21wbGV0aW9uIHsKICAgIFtzZWxmLmNoYW5uZWxzTGlzdCBjcmVhdGVDaGFubmVsV2l0aEZyaWVuZGx5TmFtZTpkZWZhdWx0Q2hhbm5lbE5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTpUV01DaGFubmVsVHlwZVB1YmxpYwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0aW9uOl4oVFdNUmVzdWx0IHJlc3VsdCwgVFdNQ2hhbm5lbCAqY2hhbm5lbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCA9PSBUV01SZXN1bHRTdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2dlbmVyYWxDaGF0cm9vbSA9IGNoYW5uZWw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29tcGxldGlvbikgY29tcGxldGlvbihyZXN1bHQgPT0gVFdNUmVzdWx0U3VjY2Vzcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dOwp9CgotICh2b2lkKXNldEdlbmVyYWxDaGF0Um9vbVVuaXF1ZU5hbWVXaXRoQ29tcGxldGlvbjooU3VjY2VlZEhhbmRsZXIpY29tcGxldGlvbiB7CiAgICBbX2dlbmVyYWxDaGF0cm9vbSBzZXRVbmlxdWVOYW1lOmRlZmF1bHRDaGFubmVsVW5pcXVlTmFtZSBjb21wbGV0aW9uOl4oVFdNUmVzdWx0IHJlc3VsdCkgewogICAgICAgIGlmIChjb21wbGV0aW9uKSBjb21wbGV0aW9uKHJlc3VsdCA9PSBUV01SZXN1bHRTdWNjZXNzKTsKICAgIH1dOwp9CgojcHJhZ21hIG1hcmsgUG9wdWxhdGUgY2hhbm5lbHMKCi0gKHZvaWQpcG9wdWxhdGVDaGFubmVsc1dpdGhDb21wbGV0aW9uOihTdWNjZWVkSGFuZGxlciljb21wbGV0aW9uIHsKICAgIHNlbGYuY2hhbm5lbHMgPSBuaWw7CiAgICAKICAgIFtzZWxmIGxvYWRDaGFubmVsTGlzdFdpdGhDb21wbGV0aW9uOl4oQk9PTCBzdWNjZWVkZWQsIFRXTUNoYW5uZWxzICpjaGFubmVsc0xpc3QpIHsKICAgICAgICBpZiAoIXN1Y2NlZWRlZCkgewogICAgICAgICAgICBzZWxmLmNoYW5uZWxzTGlzdCA9IG5pbDsKICAgICAgICAgICAgc2VsZi5jaGFubmVscyA9IG5pbDsKICAgICAgICAgICAgaWYgKGNvbXBsZXRpb24pIGNvbXBsZXRpb24oc3VjY2VlZGVkKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBkaXNwYXRjaF9hc3luYyhkaXNwYXRjaF9nZXRfZ2xvYmFsX3F1ZXVlKERJU1BBVENIX1FVRVVFX1BSSU9SSVRZX0RFRkFVTFQsIDApLCBeewogICAgICAgICAgICBbc2VsZi5jaGFubmVsc0xpc3QgbG9hZENoYW5uZWxzV2l0aENvbXBsZXRpb246XihUV01SZXN1bHQgcmVzdWx0KSB7CiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09IFRXTVJlc3VsdFN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICBzZWxmLmNoYW5uZWxzID0gW1tOU011dGFibGVPcmRlcmVkU2V0IGFsbG9jXSBpbml0XTsKICAgICAgICAgICAgICAgICAgICBbc2VsZi5jaGFubmVscyBhZGRPYmplY3RzRnJvbUFycmF5OltzZWxmLmNoYW5uZWxzTGlzdCBhbGxPYmplY3RzXV07CiAgICAgICAgICAgICAgICAgICAgW3NlbGYgc29ydENoYW5uZWxzXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRpc3BhdGNoX2FzeW5jKGRpc3BhdGNoX2dldF9tYWluX3F1ZXVlKCksIF57CiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBsZXRpb24pIGNvbXBsZXRpb24oc3VjY2VlZGVkKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9XTsKICAgICAgICB9KTsKICAgIH1dOwp9CgotICh2b2lkKWxvYWRDaGFubmVsTGlzdFdpdGhDb21wbGV0aW9uOihDaGFubmVsc0xpc3RIYW5kbGVyKWNvbXBsZXRpb24gewogICAgc2VsZi5jaGFubmVsc0xpc3QgPSBuaWw7CiAgICAKICAgIGRpc3BhdGNoX2FzeW5jKGRpc3BhdGNoX2dldF9nbG9iYWxfcXVldWUoRElTUEFUQ0hfUVVFVUVfUFJJT1JJVFlfREVGQVVMVCwgMCksIF57CiAgICAgICAgW1tJUE1lc3NhZ2luZ01hbmFnZXIgc2hhcmVkTWFuYWdlcl0uY2xpZW50IGNoYW5uZWxzTGlzdFdpdGhDb21wbGV0aW9uOl4oVFdNUmVzdWx0IHJlc3VsdCwgVFdNQ2hhbm5lbHMgKmNoYW5uZWxzTGlzdCkgewogICAgICAgICAgICBpZiAocmVzdWx0ID09IFRXTVJlc3VsdFN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgIHNlbGYuY2hhbm5lbHNMaXN0ID0gY2hhbm5lbHNMaXN0OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGRpc3BhdGNoX2FzeW5jKGRpc3BhdGNoX2dldF9tYWluX3F1ZXVlKCksIF57CiAgICAgICAgICAgICAgICBpZiAoY29tcGxldGlvbikgY29tcGxldGlvbihyZXN1bHQgPT0gVFdNUmVzdWx0U3VjY2Vzcywgc2VsZi5jaGFubmVsc0xpc3QpOwogICAgICAgICAgICB9KTsKICAgICAgICB9XTsKICAgIH0pOwp9CgotICh2b2lkKXNvcnRDaGFubmVscyB7CiAgICBTRUwgc29ydFNlbGVjdG9yID0gQHNlbGVjdG9yKGxvY2FsaXplZENhc2VJbnNlbnNpdGl2ZUNvbXBhcmU6KTsKICAgIE5TU29ydERlc2NyaXB0b3IgKmRlc2NyaXB0b3IgPSBbW05TU29ydERlc2NyaXB0b3IgYWxsb2NdIGluaXRXaXRoS2V5OkAiZnJpZW5kbHlOYW1lIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc2NlbmRpbmc6WUVTCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rvcjpzb3J0U2VsZWN0b3JdOwogICAgW3NlbGYuY2hhbm5lbHMgc29ydFVzaW5nRGVzY3JpcHRvcnM6QFtkZXNjcmlwdG9yXV07Cn0KCiMgcHJhZ21hIG1hcmsgQ3JlYXRlIGNoYW5uZWwKCi0gKHZvaWQpY3JlYXRlQ2hhbm5lbFdpdGhOYW1lOihOU1N0cmluZyAqKW5hbWUgY29tcGxldGlvbjooQ2hhbm5lbEhhbmRsZXIpY29tcGxldGlvbiB7CiAgICBpZiAoW25hbWUgaXNFcXVhbFRvU3RyaW5nOmRlZmF1bHRDaGFubmVsTmFtZV0pIHsKICAgICAgICBpZiAoY29tcGxldGlvbikgY29tcGxldGlvbihOTywgbmlsKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICAKICAgIGlmICghc2VsZi5jaGFubmVsc0xpc3QpCiAgICB7CiAgICAgICAgW3NlbGYgbG9hZENoYW5uZWxMaXN0V2l0aENvbXBsZXRpb246XihCT09MIHN1Y2NlZWRlZCwgVFdNQ2hhbm5lbHMgKmNoYW5uZWxzTGlzdCkgewogICAgICAgICAgICBpZiAoc3VjY2VlZGVkKSB7CiAgICAgICAgICAgICAgICBbc2VsZiBjcmVhdGVDaGFubmVsV2l0aE5hbWU6bmFtZSBjb21wbGV0aW9uOmNvbXBsZXRpb25dOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYoY29tcGxldGlvbikgewogICAgICAgICAgICAgICAgY29tcGxldGlvbihzdWNjZWVkZWQsIG5pbCk7CiAgICAgICAgICAgIH0KICAgICAgICB9XTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICAKICAgIFtzZWxmLmNoYW5uZWxzTGlzdCBjcmVhdGVDaGFubmVsV2l0aEZyaWVuZGx5TmFtZTpuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6VFdNQ2hhbm5lbFR5cGVQdWJsaWMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxldGlvbjpeKFRXTVJlc3VsdCByZXN1bHQsIFRXTUNoYW5uZWwgKmNoYW5uZWwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb21wbGV0aW9uKSBjb21wbGV0aW9uKHJlc3VsdCA9PSBUV01SZXN1bHRTdWNjZXNzLCBjaGFubmVsKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfV07Cn0KCiMgcHJhZ21hIG1hcmsgVHdpbGlvSVBNZXNzYWdpbmdDbGllbnREZWxlZ2F0ZQoKLSAodm9pZClpcE1lc3NhZ2luZ0NsaWVudDooVHdpbGlvSVBNZXNzYWdpbmdDbGllbnQgKiljbGllbnQgY2hhbm5lbEFkZGVkOihUV01DaGFubmVsICopY2hhbm5lbCB7CiAgICBkaXNwYXRjaF9hc3luYyhkaXNwYXRjaF9nZXRfbWFpbl9xdWV1ZSgpLCBeewogICAgICAgIFtzZWxmLmNoYW5uZWxzIGFkZE9iamVjdDpjaGFubmVsXTsKICAgICAgICBbc2VsZiBzb3J0Q2hhbm5lbHNdOwogICAgICAgIFtzZWxmLmRlbGVnYXRlIGlwTWVzc2FnaW5nQ2xpZW50OmNsaWVudCBjaGFubmVsQWRkZWQ6Y2hhbm5lbF07CiAgICB9KTsKfQoKLSAodm9pZClpcE1lc3NhZ2luZ0NsaWVudDooVHdpbGlvSVBNZXNzYWdpbmdDbGllbnQgKiljbGllbnQgY2hhbm5lbENoYW5nZWQ6KFRXTUNoYW5uZWwgKiljaGFubmVsIHsKICAgIGRpc3BhdGNoX2FzeW5jKGRpc3BhdGNoX2dldF9tYWluX3F1ZXVlKCksIF57CiAgICAgICAgW3NlbGYuZGVsZWdhdGUgaXBNZXNzYWdpbmdDbGllbnQ6Y2xpZW50IGNoYW5uZWxDaGFuZ2VkOmNoYW5uZWxdOwogICAgfSk7Cn0KCi0gKHZvaWQpaXBNZXNzYWdpbmdDbGllbnQ6KFR3aWxpb0lQTWVzc2FnaW5nQ2xpZW50ICopY2xpZW50IGNoYW5uZWxEZWxldGVkOihUV01DaGFubmVsICopY2hhbm5lbCB7CiAgICBkaXNwYXRjaF9hc3luYyhkaXNwYXRjaF9nZXRfbWFpbl9xdWV1ZSgpLCBeewogICAgICAgIFtbQ2hhbm5lbE1hbmFnZXIgc2hhcmVkTWFuYWdlcl0uY2hhbm5lbHMgcmVtb3ZlT2JqZWN0OmNoYW5uZWxdOwogICAgICAgIFtzZWxmLmRlbGVnYXRlIGlwTWVzc2FnaW5nQ2xpZW50OmNsaWVudCBjaGFubmVsRGVsZXRlZDpjaGFubmVsXTsKICAgIH0pOwp9CgpAZW5kCg==</textarea>
<textarea class="saurus-file" data-file="twiliochat/MainChatViewController.m" data-mode="objectivec">I2ltcG9ydCA8UGFyc2UvUGFyc2UuaD4KI2ltcG9ydCA8VHdpbGlvSVBNZXNzYWdpbmdDbGllbnQvVHdpbGlvSVBNZXNzYWdpbmdDbGllbnQuaD4KI2ltcG9ydCAiTWFpbkNoYXRWaWV3Q29udHJvbGxlci5oIgojaW1wb3J0ICJDaGF0VGFibGVDZWxsLmgiCiNpbXBvcnQgIk5TRGF0ZStJU084NjAxUGFyc2VyLmgiCiNpbXBvcnQgIlNXUmV2ZWFsVmlld0NvbnRyb2xsZXIuaCIKI2ltcG9ydCAiQ2hhbm5lbE1hbmFnZXIuaCIKI2ltcG9ydCAiU3RhdHVzRW50cnkuaCIKI2ltcG9ydCAiRGF0ZVRvZGF5Rm9ybWF0dGVyLmgiCgpAaW50ZXJmYWNlIE1haW5DaGF0Vmlld0NvbnRyb2xsZXIgKCkKQHByb3BlcnR5ICh3ZWFrLCBub25hdG9taWMpIElCT3V0bGV0IFVJQmFyQnV0dG9uSXRlbSAqcmV2ZWFsQnV0dG9uSXRlbTsKQHByb3BlcnR5ICh3ZWFrLCBub25hdG9taWMpIElCT3V0bGV0IFVJQmFyQnV0dG9uSXRlbSAqYWN0aW9uQnV0dG9uSXRlbTsKCkBwcm9wZXJ0eSAoc3Ryb25nLCBub25hdG9taWMpIE5TTXV0YWJsZU9yZGVyZWRTZXQgKm1lc3NhZ2VzOwoKQGVuZAoKc3RhdGljIE5TU3RyaW5nICpDaGF0Q2VsbElkZW50aWZpZXIgPSBAIkNoYXRUYWJsZUNlbGwiOwpzdGF0aWMgTlNTdHJpbmcgKkNoYXRTdGF0dXNDZWxsSWRlbnRpZmllciA9IEAiQ2hhdFN0YXR1c1RhYmxlQ2VsbCI7CgpAaW1wbGVtZW50YXRpb24gTWFpbkNoYXRWaWV3Q29udHJvbGxlcgoKI3ByYWdtYSBtYXJrIEluaXRpYWxpemF0aW9uCgotICh2b2lkKXZpZXdEaWRMb2FkIHsKICAgIFtzdXBlciB2aWV3RGlkTG9hZF07CiAgICAKICAgIGlmIChzZWxmLnJldmVhbFZpZXdDb250cm9sbGVyKQogICAgewogICAgICAgIFtzZWxmLnJldmVhbEJ1dHRvbkl0ZW0gc2V0VGFyZ2V0OiBzZWxmLnJldmVhbFZpZXdDb250cm9sbGVyXTsKICAgICAgICBbc2VsZi5yZXZlYWxCdXR0b25JdGVtIHNldEFjdGlvbjogQHNlbGVjdG9yKCByZXZlYWxUb2dnbGU6ICldOwogICAgICAgIFtzZWxmLm5hdmlnYXRpb25Db250cm9sbGVyLm5hdmlnYXRpb25CYXIgYWRkR2VzdHVyZVJlY29nbml6ZXI6IHNlbGYucmV2ZWFsVmlld0NvbnRyb2xsZXIucGFuR2VzdHVyZVJlY29nbml6ZXJdOwogICAgICAgIHNlbGYucmV2ZWFsVmlld0NvbnRyb2xsZXIucmVhclZpZXdSZXZlYWxPdmVyZHJhdyA9IDAuZjsKICAgIH0KCiAgICBzZWxmLmJvdW5jZXMgPSBZRVM7CiAgICBzZWxmLnNoYWtlVG9DbGVhckVuYWJsZWQgPSBZRVM7CiAgICBzZWxmLmtleWJvYXJkUGFubmluZ0VuYWJsZWQgPSBZRVM7CiAgICBzZWxmLnNob3VsZFNjcm9sbFRvQm90dG9tQWZ0ZXJLZXlib2FyZFNob3dzID0gTk87CiAgICBzZWxmLmludmVydGVkID0gWUVTOwogICAgCiAgICBVSU5pYiAqY2VsbE5pYiA9IFtVSU5pYiBuaWJXaXRoTmliTmFtZTpDaGF0Q2VsbElkZW50aWZpZXIgYnVuZGxlOm5pbF07CiAgICBbc2VsZi50YWJsZVZpZXcgcmVnaXN0ZXJOaWI6Y2VsbE5pYgogICAgICAgICBmb3JDZWxsUmV1c2VJZGVudGlmaWVyOkNoYXRDZWxsSWRlbnRpZmllcl07CiAgICAKICAgIFVJTmliICpjZWxsU3RhdHVzTmliID0gW1VJTmliIG5pYldpdGhOaWJOYW1lOkNoYXRTdGF0dXNDZWxsSWRlbnRpZmllciBidW5kbGU6bmlsXTsKICAgIFtzZWxmLnRhYmxlVmlldyByZWdpc3Rlck5pYjpjZWxsU3RhdHVzTmliCiAgICAgICAgIGZvckNlbGxSZXVzZUlkZW50aWZpZXI6Q2hhdFN0YXR1c0NlbGxJZGVudGlmaWVyXTsKICAgIAogICAgc2VsZi50ZXh0SW5wdXRiYXIuYXV0b0hpZGVSaWdodEJ1dHRvbiA9IFlFUzsKICAgIHNlbGYudGV4dElucHV0YmFyLm1heENoYXJDb3VudCA9IDI1NjsKICAgIHNlbGYudGV4dElucHV0YmFyLmNvdW50ZXJTdHlsZSA9IFNMS0NvdW50ZXJTdHlsZVNwbGl0OwogICAgc2VsZi50ZXh0SW5wdXRiYXIuY291bnRlclBvc2l0aW9uID0gU0xLQ291bnRlclBvc2l0aW9uVG9wOwogICAgCiAgICBVSUZvbnQgKmZvbnQgPSBbVUlGb250IGZvbnRXaXRoTmFtZTpAIkF2ZW5pci1MaWdodCIgc2l6ZToxNF07CiAgICBbc2VsZi50ZXh0VmlldyBzZXRGb250OmZvbnRdOwogICAgCiAgICBbc2VsZi5yaWdodEJ1dHRvbiBzZXRUaXRsZUNvbG9yOltVSUNvbG9yIGNvbG9yV2l0aFJlZDowLjk3MyBncmVlbjowLjU1NyBibHVlOjAuNTAyIGFscGhhOjFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvclN0YXRlOlVJQ29udHJvbFN0YXRlTm9ybWFsXTsKICAgIAogICAgZm9udCA9IFtVSUZvbnQgZm9udFdpdGhOYW1lOkAiQXZlbmlyLUhlYXZ5IiBzaXplOjE3XTsKICAgIFtzZWxmLm5hdmlnYXRpb25Db250cm9sbGVyLm5hdmlnYXRpb25CYXIgc2V0VGl0bGVUZXh0QXR0cmlidXRlczoKICAgICBAe05TRm9udEF0dHJpYnV0ZU5hbWU6Zm9udH1dOwogICAgCiAgICBzZWxmLnRhYmxlVmlldy5lc3RpbWF0ZWRSb3dIZWlnaHQgPSA3MDsKICAgIHNlbGYudGFibGVWaWV3LnJvd0hlaWdodCA9IFVJVGFibGVWaWV3QXV0b21hdGljRGltZW5zaW9uOwogICAgc2VsZi50YWJsZVZpZXcuc2VwYXJhdG9yU3R5bGUgPSBVSVRhYmxlVmlld0NlbGxTZXBhcmF0b3JTdHlsZU5vbmU7CiAgICAKICAgIGlmICghX2NoYW5uZWwpCiAgICB7CiAgICAgICAgc2VsZi5jaGFubmVsID0gW0NoYW5uZWxNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdLmdlbmVyYWxDaGF0cm9vbTsKICAgIH0KfQoKLSAodm9pZCl2aWV3RGlkQXBwZWFyOihCT09MKWFuaW1hdGVkIHsKICAgIFtzdXBlciB2aWV3RGlkQXBwZWFyOmFuaW1hdGVkXTsKICAgIFtzZWxmIHNjcm9sbFRvQm90dG9tTWVzc2FnZV07Cn0KCi0gKE5TTXV0YWJsZU9yZGVyZWRTZXQgKiltZXNzYWdlcyB7CiAgICBpZiAoIV9tZXNzYWdlcykgewogICAgICAgIF9tZXNzYWdlcyA9IFtbTlNNdXRhYmxlT3JkZXJlZFNldCBhbGxvY10gaW5pdF07CiAgICB9CiAgICByZXR1cm4gX21lc3NhZ2VzOwp9CgotICh2b2lkKXNldENoYW5uZWw6KFRXTUNoYW5uZWwgKiljaGFubmVsIHsKICAgIF9jaGFubmVsID0gY2hhbm5lbDsKICAgIHNlbGYudGl0bGUgPSBzZWxmLmNoYW5uZWwuZnJpZW5kbHlOYW1lOwogICAgCiAgICBpZiAoc2VsZi5jaGFubmVsID09IFtDaGFubmVsTWFuYWdlciBzaGFyZWRNYW5hZ2VyXS5nZW5lcmFsQ2hhdHJvb20pIHsKICAgICAgICBzZWxmLm5hdmlnYXRpb25JdGVtLnJpZ2h0QmFyQnV0dG9uSXRlbSA9IG5pbDsKICAgIH0KICAgCiAgICBpZiAoc2VsZi5jaGFubmVsLnN0YXR1cyA9PSBUV01DaGFubmVsU3RhdHVzSm9pbmVkKQogICAgewogICAgICAgIFtzZWxmIGxvYWRNZXNzYWdlc107CiAgICAgICAgc2VsZi5jaGFubmVsLmRlbGVnYXRlID0gc2VsZjsKICAgIH0KICAgIGVsc2UgewogICAgICAgIFtVSUFwcGxpY2F0aW9uIHNoYXJlZEFwcGxpY2F0aW9uXS5uZXR3b3JrQWN0aXZpdHlJbmRpY2F0b3JWaXNpYmxlID0gWUVTOwogICAgICAgIHNlbGYudGV4dElucHV0YmFySGlkZGVuID0gWUVTOwogICAgICAgIFtzZWxmLmNoYW5uZWwgam9pbldpdGhDb21wbGV0aW9uOl4oVFdNUmVzdWx0IHJlc3VsdCkgewogICAgICAgICAgICBkaXNwYXRjaF9hc3luYyhkaXNwYXRjaF9nZXRfZ2xvYmFsX3F1ZXVlKERJU1BBVENIX1FVRVVFX1BSSU9SSVRZX0RFRkFVTFQsIDApLCBeewogICAgICAgICAgICAgICAgW3NlbGYgbG9hZE1lc3NhZ2VzXTsKICAgICAgICAgICAgICAgIGRpc3BhdGNoX2FzeW5jKGRpc3BhdGNoX2dldF9tYWluX3F1ZXVlKCksIF57CiAgICAgICAgICAgICAgICAgICAgc2VsZi5jaGFubmVsLmRlbGVnYXRlID0gc2VsZjsKICAgICAgICAgICAgICAgICAgICBbVUlBcHBsaWNhdGlvbiBzaGFyZWRBcHBsaWNhdGlvbl0ubmV0d29ya0FjdGl2aXR5SW5kaWNhdG9yVmlzaWJsZSA9IE5POwogICAgICAgICAgICAgICAgICAgIFtzZWxmIHNldFRleHRJbnB1dGJhckhpZGRlbjpOTyBhbmltYXRlZDpZRVNdOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH1dOwogICAgfQp9CgotIChOU0ludGVnZXIpbnVtYmVyT2ZTZWN0aW9uc0luVGFibGVWaWV3OihVSVRhYmxlVmlldyAqKXRhYmxlVmlldyB7CiAgICByZXR1cm4gMTsKfQoKLSAoTlNJbnRlZ2VyKXRhYmxlVmlldzooVUlUYWJsZVZpZXcgKil0YWJsZVZpZXcgbnVtYmVyT2ZSb3dzSW5TZWN0aW9uOihOU0ludGVnZXIpc2VjdGlvbiB7CiAgICByZXR1cm4gc2VsZi5tZXNzYWdlcy5jb3VudDsKfQoKLSAoVUlUYWJsZVZpZXdDZWxsICopdGFibGVWaWV3OihVSVRhYmxlVmlldyAqKXRhYmxlVmlldyBjZWxsRm9yUm93QXRJbmRleFBhdGg6KE5TSW5kZXhQYXRoICopaW5kZXhQYXRoIHsKICAgIFVJVGFibGVWaWV3Q2VsbCAqY2VsbCA9IG5pbDsKICAgIAogICAgaWQgbWVzc2FnZSA9IFtzZWxmLm1lc3NhZ2VzIG9iamVjdEF0SW5kZXg6aW5kZXhQYXRoLnJvd107CiAgICAKICAgIGlmIChbbWVzc2FnZSBpc0tpbmRPZkNsYXNzOltUV01NZXNzYWdlIGNsYXNzXV0pIHsKICAgICAgICBjZWxsID0gW3NlbGYgZ2V0Q2hhdENlbGxGb3JUYWJsZVZpZXc6dGFibGVWaWV3IGZvckluZGV4UGF0aDppbmRleFBhdGggbWVzc2FnZTptZXNzYWdlXTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIGNlbGwgPSBbc2VsZiBnZXRTdGF0dUNlbGxGb3JUYWJsZVZpZXc6dGFibGVWaWV3IGZvckluZGV4UGF0aDppbmRleFBhdGggbWVzc2FnZTptZXNzYWdlXTsKICAgIH0KICAgIAogICAgY2VsbC50cmFuc2Zvcm0gPSB0YWJsZVZpZXcudHJhbnNmb3JtOwogICAgcmV0dXJuIGNlbGw7Cn0KCi0gKENoYXRUYWJsZUNlbGwgKilnZXRDaGF0Q2VsbEZvclRhYmxlVmlldzooVUlUYWJsZVZpZXcgKil0YWJsZVZpZXcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ySW5kZXhQYXRoOihOU0luZGV4UGF0aCAqKWluZGV4UGF0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6KFRXTU1lc3NhZ2UgKiltZXNzYWdlIHsKICAgIFVJVGFibGVWaWV3Q2VsbCAqY2VsbCA9IFtzZWxmLnRhYmxlVmlldyBkZXF1ZXVlUmV1c2FibGVDZWxsV2l0aElkZW50aWZpZXI6Q2hhdENlbGxJZGVudGlmaWVyIGZvckluZGV4UGF0aDppbmRleFBhdGhdOwogICAgCiAgICBDaGF0VGFibGVDZWxsICpjaGF0Q2VsbCA9IChDaGF0VGFibGVDZWxsICopY2VsbDsKICAgIGNoYXRDZWxsLnVzZXIgPSBtZXNzYWdlLmF1dGhvcjsKICAgIGNoYXRDZWxsLmRhdGUgPSBbW1tEYXRlVG9kYXlGb3JtYXR0ZXIgYWxsb2NdIGluaXRdIHN0cmluZ0Zyb21EYXRlOltOU0RhdGUgZGF0ZVdpdGhJU084NjAxU3RyaW5nOm1lc3NhZ2UudGltZXN0YW1wXV07CiAgICBjaGF0Q2VsbC5tZXNzYWdlID0gbWVzc2FnZS5ib2R5OwogICAgCiAgICByZXR1cm4gY2hhdENlbGw7Cn0KCi0gKFVJVGFibGVWaWV3Q2VsbCAqKWdldFN0YXR1Q2VsbEZvclRhYmxlVmlldzooVUlUYWJsZVZpZXcgKil0YWJsZVZpZXcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ySW5kZXhQYXRoOihOU0luZGV4UGF0aCAqKWluZGV4UGF0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6KFN0YXR1c0VudHJ5ICopbWVzc2FnZSB7CiAgICBVSVRhYmxlVmlld0NlbGwgKmNlbGwgPSBbc2VsZi50YWJsZVZpZXcgZGVxdWV1ZVJldXNhYmxlQ2VsbFdpdGhJZGVudGlmaWVyOkNoYXRTdGF0dXNDZWxsSWRlbnRpZmllciBmb3JJbmRleFBhdGg6aW5kZXhQYXRoXTsKICAgIAogICAgVUlMYWJlbCAqbGFiZWwgPSBbY2VsbCB2aWV3V2l0aFRhZzoyMDBdOwogICAgbGFiZWwudGV4dCA9IFtOU1N0cmluZyBzdHJpbmdXaXRoRm9ybWF0OkAiVXNlciAlQCBoYXMgJUAiLAogICAgICAgICAgICAgICAgICBtZXNzYWdlLm1lbWJlci5pZGVudGl0eSwKICAgICAgICAgICAgICAgICAgKG1lc3NhZ2Uuc3RhdHVzID09IE1lbWJlclN0YXR1c0pvaW5lZD8gQCJqb2luZWQiIDogQCJsZWZ0IildOwogICAgCiAgICByZXR1cm4gY2VsbDsKfQoKLSAodm9pZClkaWRQcmVzc1JpZ2h0QnV0dG9uOihpZClzZW5kZXIgewogICAgW3NlbGYudGV4dFZpZXcgcmVmcmVzaEZpcnN0UmVzcG9uZGVyXTsKICAgIFtzZWxmIHNlbmRNZXNzYWdlOiBbc2VsZi50ZXh0Vmlldy50ZXh0IGNvcHldXTsKICAgIFtzdXBlciBkaWRQcmVzc1JpZ2h0QnV0dG9uOnNlbmRlcl07Cn0KCiNwcmFnbWEgbWFyayBDaGF0IFNlcnZpY2UKLSAodm9pZClzZW5kTWVzc2FnZTogKE5TU3RyaW5nICopaW5wdXRNZXNzYWdlIHsKICAgIFRXTU1lc3NhZ2UgKm1lc3NhZ2UgPSBbc2VsZi5jaGFubmVsLm1lc3NhZ2VzIGNyZWF0ZU1lc3NhZ2VXaXRoQm9keTppbnB1dE1lc3NhZ2VdOwogICAgW3NlbGYuY2hhbm5lbC5tZXNzYWdlcyBzZW5kTWVzc2FnZTptZXNzYWdlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0aW9uOm5pbF07Cn0KCgoKLSAodm9pZClhZGRNZXNzYWdlczooTlNBcnJheSAqKW1lc3NhZ2VzIHsKICAgIFtzZWxmLm1lc3NhZ2VzIGFkZE9iamVjdHNGcm9tQXJyYXk6bWVzc2FnZXNdOwogICAgW3NlbGYgc29ydE1lc3NhZ2VzXTsKICAgIGRpc3BhdGNoX2FzeW5jKGRpc3BhdGNoX2dldF9tYWluX3F1ZXVlKCksIF57CiAgICAgICAgW3NlbGYudGFibGVWaWV3IHJlbG9hZERhdGFdOwogICAgICAgIGlmIChzZWxmLm1lc3NhZ2VzLmNvdW50ID4gMCkgewogICAgICAgICAgICBbc2VsZiBzY3JvbGxUb0JvdHRvbU1lc3NhZ2VdOwogICAgICAgIH0KICAgIH0pOwp9CgoKLSAodm9pZClzb3J0TWVzc2FnZXMgewogICAgW3NlbGYubWVzc2FnZXMgc29ydFVzaW5nRGVzY3JpcHRvcnM6QFtbW05TU29ydERlc2NyaXB0b3IgYWxsb2NdIGluaXRXaXRoS2V5OkAidGltZXN0YW1wIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNjZW5kaW5nOk5PXV1dOwp9CgotICh2b2lkKXNjcm9sbFRvQm90dG9tTWVzc2FnZSB7CiAgICBpZiAoc2VsZi5tZXNzYWdlcy5jb3VudCA9PSAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgCiAgICBOU0luZGV4UGF0aCAqYm90dG9tTWVzc2FnZUluZGV4ID0gW05TSW5kZXhQYXRoIGluZGV4UGF0aEZvclJvdzowCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluU2VjdGlvbjowXTsKICAgIFtzZWxmLnRhYmxlVmlldyBzY3JvbGxUb1Jvd0F0SW5kZXhQYXRoOmJvdHRvbU1lc3NhZ2VJbmRleAogICAgICAgICAgICAgICAgICAgICAgICAgIGF0U2Nyb2xsUG9zaXRpb246VUlUYWJsZVZpZXdTY3JvbGxQb3NpdGlvbkJvdHRvbQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0ZWQ6Tk9dOwp9CgotICh2b2lkKWxvYWRNZXNzYWdlcyB7CiAgICBbc2VsZi5tZXNzYWdlcyByZW1vdmVBbGxPYmplY3RzXTsKICAgIFtzZWxmIGFkZE1lc3NhZ2VzOnNlbGYuY2hhbm5lbC5tZXNzYWdlcy5hbGxPYmplY3RzXTsKfQoKLSAodm9pZClsZWF2ZUNoYW5uZWwgewogICAgW3NlbGYuY2hhbm5lbCBsZWF2ZVdpdGhDb21wbGV0aW9uOl4oVFdNUmVzdWx0IHJlc3VsdCkgewogICAgICAgIGlmIChyZXN1bHQgPT0gVFdNUmVzdWx0U3VjY2VzcykgewogICAgICAgICAgICBbc2VsZi5yZXZlYWxWaWV3Q29udHJvbGxlci5yZWFyVmlld0NvbnRyb2xsZXIgcGVyZm9ybVNlZ3VlV2l0aElkZW50aWZpZXI6QCJPcGVuR2VuZXJhbENoYXQiIHNlbmRlcjpuaWxdOwogICAgICAgIH0KICAgIH1dOwp9CgojcHJhZ21hIG1hcmsgLSBUTU1lc3NhZ2VEZWxlZ2F0ZQoKLSAodm9pZClpcE1lc3NhZ2luZ0NsaWVudDooVHdpbGlvSVBNZXNzYWdpbmdDbGllbnQgKiljbGllbnQKICAgICAgICAgICAgICAgICAgY2hhbm5lbDooVFdNQ2hhbm5lbCAqKWNoYW5uZWwKICAgICAgICAgICAgIG1lc3NhZ2VBZGRlZDooVFdNTWVzc2FnZSAqKW1lc3NhZ2UgewogICAgaWYgKCFbc2VsZi5tZXNzYWdlcyBjb250YWluc09iamVjdDptZXNzYWdlXSkgewogICAgICAgIFtzZWxmIGFkZE1lc3NhZ2VzOkBbbWVzc2FnZV1dOwogICAgfQp9CgotICh2b2lkKWlwTWVzc2FnaW5nQ2xpZW50OihUd2lsaW9JUE1lc3NhZ2luZ0NsaWVudCAqKWNsaWVudAogICAgICAgICAgIGNoYW5uZWxEZWxldGVkOihUV01DaGFubmVsICopY2hhbm5lbCB7CiAgICBkaXNwYXRjaF9hc3luYyhkaXNwYXRjaF9nZXRfbWFpbl9xdWV1ZSgpLCBeewogICAgICAgIGlmIChjaGFubmVsID09IHNlbGYuY2hhbm5lbCkgewogICAgICAgICAgICBbc2VsZi5yZXZlYWxWaWV3Q29udHJvbGxlci5yZWFyVmlld0NvbnRyb2xsZXIgcGVyZm9ybVNlZ3VlV2l0aElkZW50aWZpZXI6QCJPcGVuR2VuZXJhbENoYXQiIHNlbmRlcjpuaWxdOwogICAgICAgIH0KICAgIH0pOwp9CgotICh2b2lkKWlwTWVzc2FnaW5nQ2xpZW50OihUd2lsaW9JUE1lc3NhZ2luZ0NsaWVudCAqKWNsaWVudAogICAgICAgICAgICAgICAgICBjaGFubmVsOihUV01DaGFubmVsICopY2hhbm5lbAogICAgICAgICAgICAgbWVtYmVySm9pbmVkOihUV01NZW1iZXIgKiltZW1iZXIgewogICAgW3NlbGYgYWRkTWVzc2FnZXM6QFtbU3RhdHVzRW50cnkgc3RhdHVzRW50cnlXaXRoTWVtYmVyOm1lbWJlciBzdGF0dXM6TWVtYmVyU3RhdHVzSm9pbmVkXV1dOwp9CgotICh2b2lkKWlwTWVzc2FnaW5nQ2xpZW50OihUd2lsaW9JUE1lc3NhZ2luZ0NsaWVudCAqKWNsaWVudAogICAgICAgICAgICAgICAgICBjaGFubmVsOihUV01DaGFubmVsICopY2hhbm5lbAogICAgICAgICAgICAgICBtZW1iZXJMZWZ0OihUV01NZW1iZXIgKiltZW1iZXIgewogICAgW3NlbGYgYWRkTWVzc2FnZXM6QFtbU3RhdHVzRW50cnkgc3RhdHVzRW50cnlXaXRoTWVtYmVyOm1lbWJlciBzdGF0dXM6TWVtYmVyU3RhdHVzTGVmdF1dXTsKfQoKCiNwcmFnbWEgbWFyayAtIEFjdGlvbnMKCi0gKElCQWN0aW9uKWFjdGlvbkJ1dHRvblRvdWNoZWQ6KFVJQmFyQnV0dG9uSXRlbSAqKXNlbmRlciB7CiAgICBbc2VsZiBsZWF2ZUNoYW5uZWxdOwp9CgotIChJQkFjdGlvbilyZXZlYWxCdXR0b25Ub3VjaGVkOihVSUJhckJ1dHRvbkl0ZW0gKilzZW5kZXIgewogICAgW3NlbGYucmV2ZWFsVmlld0NvbnRyb2xsZXIgcmV2ZWFsVG9nZ2xlQW5pbWF0ZWQ6WUVTXTsKfQoKQGVuZAo=</textarea>
<textarea class="saurus-file" data-file="twiliochat/MenuViewController.m" data-mode="objectivec">I2ltcG9ydCA8UGFyc2UvUGFyc2UuaD4KI2ltcG9ydCA8U1dSZXZlYWxWaWV3Q29udHJvbGxlci9TV1JldmVhbFZpZXdDb250cm9sbGVyLmg+CiNpbXBvcnQgIk1lbnVWaWV3Q29udHJvbGxlci5oIgojaW1wb3J0ICJNZW51VGFibGVDZWxsLmgiCiNpbXBvcnQgIklucHV0RGlhbG9nQ29udHJvbGxlci5oIgojaW1wb3J0ICJNYWluQ2hhdFZpZXdDb250cm9sbGVyLmgiCiNpbXBvcnQgIklQTWVzc2FnaW5nTWFuYWdlci5oIgojaW1wb3J0ICJBbGVydERpYWxvZ0NvbnRyb2xsZXIuaCIKI2ltcG9ydCAiQ2hhbm5lbE1hbmFnZXIuaCIKCkBpbnRlcmZhY2UgTWVudVZpZXdDb250cm9sbGVyICgpCkBwcm9wZXJ0eSAod2Vhaywgbm9uYXRvbWljKSBJQk91dGxldCBVSUxhYmVsICp1c2VybmFtZUxhYmVsOwpAcHJvcGVydHkgKHdlYWssIG5vbmF0b21pYykgSUJPdXRsZXQgVUlUYWJsZVZpZXcgKnRhYmxlVmlldzsKQHByb3BlcnR5IChzdHJvbmcsIG5vbmF0b21pYykgVUlSZWZyZXNoQ29udHJvbCAqcmVmcmVzaENvbnRyb2w7CgpAcHJvcGVydHkgKHN0cm9uZywgbm9uYXRvbWljKSBUV01DaGFubmVsICpyZWNlbnRseUFkZGVkQ2hhbm5lbDsKQGVuZAoKQGltcGxlbWVudGF0aW9uIE1lbnVWaWV3Q29udHJvbGxlcgoKI3ByYWdtYSBtYXJrIEluaXRpYWxpemF0aW9uCgotICh2b2lkKXZpZXdEaWRMb2FkIHsKICAgIFtzdXBlciB2aWV3RGlkTG9hZF07CiAgICAKICAgIENHUmVjdCB0YWJsZUZyYW1lID0gc2VsZi50YWJsZVZpZXcuZnJhbWU7CiAgICAKICAgIFVJSW1hZ2VWaWV3ICpiZ0ltYWdlID0gW1tVSUltYWdlVmlldyBhbGxvY10gaW5pdFdpdGhJbWFnZTpbVUlJbWFnZSBpbWFnZU5hbWVkOkAiaG9tZS1iZyJdXTsKICAgIFtiZ0ltYWdlIHNldEZyYW1lOnRhYmxlRnJhbWVdOwogICAgc2VsZi50YWJsZVZpZXcuYmFja2dyb3VuZFZpZXcgPSBiZ0ltYWdlOwogICAgCiAgICBzZWxmLnVzZXJuYW1lTGFiZWwudGV4dCA9IFtQRlVzZXIgY3VycmVudFVzZXJdLnVzZXJuYW1lOwogICAgCiAgICBzZWxmLnJlZnJlc2hDb250cm9sID0gW1tVSVJlZnJlc2hDb250cm9sIGFsbG9jXSBpbml0XTsKICAgIFtzZWxmLnRhYmxlVmlldyBhZGRTdWJ2aWV3OnNlbGYucmVmcmVzaENvbnRyb2xdOwogICAgW3NlbGYucmVmcmVzaENvbnRyb2wgYWRkVGFyZ2V0OnNlbGYKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbjpAc2VsZWN0b3IocmVmcmVzaENoYW5uZWxzKQogICAgICAgICAgICAgICAgICBmb3JDb250cm9sRXZlbnRzOlVJQ29udHJvbEV2ZW50VmFsdWVDaGFuZ2VkXTsKICAgIHNlbGYucmVmcmVzaENvbnRyb2wudGludENvbG9yID0gW1VJQ29sb3Igd2hpdGVDb2xvcl07CiAgICAKICAgIENHUmVjdCBmcmFtZSA9IHNlbGYucmVmcmVzaENvbnRyb2wuZnJhbWU7CiAgICBmcmFtZS5vcmlnaW4ueCAtPSAxMjA7CiAgICBzZWxmLnJlZnJlc2hDb250cm9sLmZyYW1lID0gZnJhbWU7CiAgICAKICAgIFtDaGFubmVsTWFuYWdlciBzaGFyZWRNYW5hZ2VyXS5kZWxlZ2F0ZSA9IHNlbGY7CiAgICBbc2VsZiBwb3B1bGF0ZUNoYW5uZWxzXTsKfQoKI3ByYWdtYSBtYXJrIC0gVGFibGUgdmlldyBkYXRhIHNvdXJjZQoKLSAoTlNJbnRlZ2VyKXRhYmxlVmlldzooVUlUYWJsZVZpZXcgKil0YWJsZVZpZXcgbnVtYmVyT2ZSb3dzSW5TZWN0aW9uOihOU0ludGVnZXIpc2VjdGlvbiB7CiAgICBpZiAoIVtDaGFubmVsTWFuYWdlciBzaGFyZWRNYW5hZ2VyXS5jaGFubmVscykgewogICAgICAgIHJldHVybiAxOwogICAgfQogICAgCiAgICByZXR1cm4gW0NoYW5uZWxNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdLmNoYW5uZWxzLmNvdW50Owp9CgotIChVSVRhYmxlVmlld0NlbGwgKil0YWJsZVZpZXc6KFVJVGFibGVWaWV3ICopdGFibGVWaWV3IGNlbGxGb3JSb3dBdEluZGV4UGF0aDooTlNJbmRleFBhdGggKilpbmRleFBhdGggewogICAgVUlUYWJsZVZpZXdDZWxsICpjZWxsID0gbmlsOwogICAgCiAgICBpZiAoIVtDaGFubmVsTWFuYWdlciBzaGFyZWRNYW5hZ2VyXS5jaGFubmVscykgewogICAgICAgIGNlbGwgPSBbc2VsZiBsb2FkaW5nQ2VsbEZvclRhYmxlVmlldzp0YWJsZVZpZXddOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgY2VsbCA9IFtzZWxmIGNoYW5uZWxDZWxsRm9yVGFibGVWaWV3OnRhYmxlVmlldyBhdEluZGV4UGF0aDppbmRleFBhdGhdOwogICAgfQogICAgW2NlbGwgbGF5b3V0SWZOZWVkZWRdOwogICAgCiAgICByZXR1cm4gY2VsbDsKfQoKI3ByYWdtYSBtYXJrIC0gVGFibGUgdmlldyBkZWxlZ2F0ZQoKLSAoQk9PTCl0YWJsZVZpZXc6KFVJVGFibGVWaWV3ICopdGFibGVWaWV3IGNhbkVkaXRSb3dBdEluZGV4UGF0aDooTlNJbmRleFBhdGggKilpbmRleFBhdGggewogICAgVFdNQ2hhbm5lbCAqY2hhbm5lbCA9IFtbQ2hhbm5lbE1hbmFnZXIgc2hhcmVkTWFuYWdlcl0uY2hhbm5lbHMgb2JqZWN0QXRJbmRleDppbmRleFBhdGgucm93XTsKICAgIHJldHVybiBjaGFubmVsICE9IFtDaGFubmVsTWFuYWdlciBzaGFyZWRNYW5hZ2VyXS5nZW5lcmFsQ2hhdHJvb207Cn0KCgotICh2b2lkKXRhYmxlVmlldzooVUlUYWJsZVZpZXcgKil0YWJsZVZpZXcgY29tbWl0RWRpdGluZ1N0eWxlOihVSVRhYmxlVmlld0NlbGxFZGl0aW5nU3R5bGUpZWRpdGluZ1N0eWxlIGZvclJvd0F0SW5kZXhQYXRoOihOU0luZGV4UGF0aCAqKWluZGV4UGF0aCB7CiAgICBpZiAoZWRpdGluZ1N0eWxlID09IFVJVGFibGVWaWV3Q2VsbEVkaXRpbmdTdHlsZURlbGV0ZSkgewogICAgICAgIFRXTUNoYW5uZWwgKmNoYW5uZWwgPSBbW0NoYW5uZWxNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdLmNoYW5uZWxzIG9iamVjdEF0SW5kZXg6aW5kZXhQYXRoLnJvd107CiAgICAgICAgW2NoYW5uZWwgZGVzdHJveVdpdGhDb21wbGV0aW9uOl4oVFdNUmVzdWx0IHJlc3VsdCkgewogICAgICAgICAgICBpZiAocmVzdWx0ID09IFRXTVJlc3VsdFN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgIFt0YWJsZVZpZXcgcmVsb2FkRGF0YV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBbQWxlcnREaWFsb2dDb250cm9sbGVyIHNob3dBbGVydFdpdGhNZXNzYWdlOkAiWW91IGNhbiBub3QgZGVsZXRlIHRoaXMgY2hhbm5lbCIgdGl0bGU6bmlsIHByZXNlbnRlcjpzZWxmXTsKICAgICAgICAgICAgfQogICAgICAgIH1dOwogICAgfQp9CgotKHZvaWQpdGFibGVWaWV3OihVSVRhYmxlVmlldyAqKXRhYmxlVmlldyBkaWRTZWxlY3RSb3dBdEluZGV4UGF0aDooTlNJbmRleFBhdGggKilpbmRleFBhdGggewogICAgW3NlbGYgcGVyZm9ybVNlZ3VlV2l0aElkZW50aWZpZXI6QCJPcGVuQ2hhdCIgc2VuZGVyOmluZGV4UGF0aF07Cn0KCiNwcmFnbWEgbWFyayAtIEludGVybmFsIG1ldGhvZHMKCi0gKFVJVGFibGVWaWV3Q2VsbCAqKWxvYWRpbmdDZWxsRm9yVGFibGVWaWV3OihVSVRhYmxlVmlldyAqKXRhYmxlVmlldyB7CiAgICByZXR1cm4gW3RhYmxlVmlldyBkZXF1ZXVlUmV1c2FibGVDZWxsV2l0aElkZW50aWZpZXI6QCJsb2FkaW5nQ2VsbCJdOwp9CgotIChVSVRhYmxlVmlld0NlbGwgKiljaGFubmVsQ2VsbEZvclRhYmxlVmlldzooVUlUYWJsZVZpZXcgKil0YWJsZVZpZXcgYXRJbmRleFBhdGg6KE5TSW5kZXhQYXRoICopaW5kZXhQYXRoIHsKICAgIE1lbnVUYWJsZUNlbGwgKm1lbnVDZWxsID0gKE1lbnVUYWJsZUNlbGwgKilbdGFibGVWaWV3IGRlcXVldWVSZXVzYWJsZUNlbGxXaXRoSWRlbnRpZmllcjpAImNoYW5uZWxDZWxsIiBmb3JJbmRleFBhdGg6aW5kZXhQYXRoXTsKICAgIAogICAgVFdNQ2hhbm5lbCAqY2hhbm5lbCA9IFtbQ2hhbm5lbE1hbmFnZXIgc2hhcmVkTWFuYWdlcl0uY2hhbm5lbHMgb2JqZWN0QXRJbmRleDppbmRleFBhdGgucm93XTsKICAgIE5TU3RyaW5nICpmcmllbmRseU5hbWUgPSBjaGFubmVsLmZyaWVuZGx5TmFtZTsKICAgIGlmIChjaGFubmVsLmZyaWVuZGx5TmFtZS5sZW5ndGggPT0gMCkgewogICAgICAgIGZyaWVuZGx5TmFtZSA9IEAiKG5vIGZyaWVuZGx5IG5hbWUpIjsKICAgIH0KICAgIG1lbnVDZWxsLmNoYW5uZWxOYW1lID0gZnJpZW5kbHlOYW1lOwogICAgCiAgICByZXR1cm4gbWVudUNlbGw7Cn0KCi0gKHZvaWQpcmVmcmVzaENoYW5uZWxzIHsKICAgIFtzZWxmLnJlZnJlc2hDb250cm9sIGJlZ2luUmVmcmVzaGluZ107CiAgICBbc2VsZiBwb3B1bGF0ZUNoYW5uZWxzXTsKfQoKLSAodm9pZClwb3B1bGF0ZUNoYW5uZWxzIHsKICAgIFtbQ2hhbm5lbE1hbmFnZXIgc2hhcmVkTWFuYWdlcl0gcG9wdWxhdGVDaGFubmVsc1dpdGhDb21wbGV0aW9uOl4oQk9PTCBzdWNjZWVkZWQpIHsKICAgICAgICBpZiAoIXN1Y2NlZWRlZCkgewogICAgICAgICAgICBbQWxlcnREaWFsb2dDb250cm9sbGVyIHNob3dBbGVydFdpdGhNZXNzYWdlOkAiRmFpbGVkIHRvIGxvYWQgY2hhbm5lbHMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6QCJJUCBNZXNzYWdpbmcgRGVtbyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXNlbnRlcjpzZWxmXTsKICAgICAgICB9CiAgICAgICAgW3NlbGYudGFibGVWaWV3IHJlbG9hZERhdGFdOwogICAgICAgIFtzZWxmLnJlZnJlc2hDb250cm9sIGVuZFJlZnJlc2hpbmddOwogICAgfV07Cn0KCiNwcmFnbWEgbWFyayAtIENoYW5uZWwKCi0gKHZvaWQpY3JlYXRlTmV3Q2hhbm5lbERpYWxvZyB7CiAgICBbSW5wdXREaWFsb2dDb250cm9sbGVyIHNob3dXaXRoVGl0bGU6QCJOZXcgQ2hhbm5lbCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTpAIkVudGVyIGEgbmFtZSBmb3IgdGhpcyBjaGFubmVsLiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjpAIk5hbWUiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVzZW50ZXI6c2VsZiBoYW5kbGVyOl4oTlNTdHJpbmcgKnRleHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbW0NoYW5uZWxNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdIGNyZWF0ZUNoYW5uZWxXaXRoTmFtZTp0ZXh0IGNvbXBsZXRpb246bmlsXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dOwp9CgojcHJhZ21hIG1hcmsgLSBUd2lsaW9JUE1lc3NhZ2luZ0NsaWVudERlbGVnYXRlIGRlbGVnYXRlCgotICh2b2lkKWlwTWVzc2FnaW5nQ2xpZW50OihUd2lsaW9JUE1lc3NhZ2luZ0NsaWVudCAqKWNsaWVudCBjaGFubmVsQWRkZWQ6KFRXTUNoYW5uZWwgKiljaGFubmVsIHsKICAgIFtzZWxmLnRhYmxlVmlldyByZWxvYWREYXRhXTsKfQoKLSAodm9pZClpcE1lc3NhZ2luZ0NsaWVudDooVHdpbGlvSVBNZXNzYWdpbmdDbGllbnQgKiljbGllbnQgY2hhbm5lbENoYW5nZWQ6KFRXTUNoYW5uZWwgKiljaGFubmVsIHsKICAgIFtzZWxmLnRhYmxlVmlldyByZWxvYWREYXRhXTsKfQoKLSAodm9pZClpcE1lc3NhZ2luZ0NsaWVudDooVHdpbGlvSVBNZXNzYWdpbmdDbGllbnQgKiljbGllbnQgY2hhbm5lbERlbGV0ZWQ6KFRXTUNoYW5uZWwgKiljaGFubmVsIHsKICAgIFtzZWxmLnRhYmxlVmlldyByZWxvYWREYXRhXTsKfQoKI3ByYWdtYSBtYXJrIC0gTG9nb3V0CgotICh2b2lkKXByb210cExvZ291dCB7CiAgICBVSUFsZXJ0Q29udHJvbGxlciogYWxlcnQgPSBbVUlBbGVydENvbnRyb2xsZXIgYWxlcnRDb250cm9sbGVyV2l0aFRpdGxlOm5pbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTpAIllvdSBhcmUgYWJvdXQgdG8gTG9nb3V0LiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlZmVycmVkU3R5bGU6VUlBbGVydENvbnRyb2xsZXJTdHlsZUFsZXJ0XTsKICAgIAogICAgVUlBbGVydEFjdGlvbiAqZGVmYXVsdEFjdGlvbiA9IFtVSUFsZXJ0QWN0aW9uIGFjdGlvbldpdGhUaXRsZTpAIkNhbmNlbCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6VUlBbGVydEFjdGlvblN0eWxlQ2FuY2VsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyOm5pbF07CiAgICBVSUFsZXJ0QWN0aW9uICpjb25maXJtQWN0aW9uID0gW1VJQWxlcnRBY3Rpb24gYWN0aW9uV2l0aFRpdGxlOkAiQ29uZmlybSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6VUlBbGVydEFjdGlvblN0eWxlRGVmYXVsdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlcjpeKFVJQWxlcnRBY3Rpb24gKmFjdGlvbikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtzZWxmIGxvZ091dF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XTsKICAgIAogICAgW2FsZXJ0IGFkZEFjdGlvbjpkZWZhdWx0QWN0aW9uXTsKICAgIFthbGVydCBhZGRBY3Rpb246Y29uZmlybUFjdGlvbl07CiAgICBbc2VsZiBwcmVzZW50Vmlld0NvbnRyb2xsZXI6YWxlcnQgYW5pbWF0ZWQ6WUVTIGNvbXBsZXRpb246bmlsXTsKfQoKLSh2b2lkKSBsb2dPdXQgewogICAgW1tJUE1lc3NhZ2luZ01hbmFnZXIgc2hhcmVkTWFuYWdlcl0gbG9nb3V0XTsKICAgIFtbSVBNZXNzYWdpbmdNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdIHByZXNlbnRSb290Vmlld0NvbnRyb2xsZXJdOwp9CgojcHJhZ21hIG1hcmsgQWN0aW9ucwoKLSAoSUJBY3Rpb24pbG9nb3V0QnV0dG9uVG91Y2hlZDooVUlCdXR0b24gKilzZW5kZXIgewogICAgW3NlbGYgcHJvbXRwTG9nb3V0XTsKfQoKLSAoSUJBY3Rpb24pbmV3Q2hhbm5lbEJ1dHRvblRvdWNoZWQ6KFVJQnV0dG9uICopc2VuZGVyIHsKICAgIFtzZWxmIGNyZWF0ZU5ld0NoYW5uZWxEaWFsb2ddOwp9CgojcHJhZ21hIG1hcmsgLSBOYXZpZ2F0aW9uCgotICh2b2lkKXByZXBhcmVGb3JTZWd1ZTooVUlTdG9yeWJvYXJkU2VndWUgKilzZWd1ZSBzZW5kZXI6KGlkKXNlbmRlciB7CiAgICBpZiAoW3NlZ3VlLmlkZW50aWZpZXIgaXNFcXVhbFRvU3RyaW5nOkAiT3BlbkNoYXQiXSkgewogICAgICAgIE5TSW5kZXhQYXRoICppbmRleFBhdGggPSAoTlNJbmRleFBhdGggKilzZW5kZXI7CiAgICAgICAgCiAgICAgICAgVFdNQ2hhbm5lbCAqY2hhbm5lbCA9IFtbQ2hhbm5lbE1hbmFnZXIgc2hhcmVkTWFuYWdlcl0uY2hhbm5lbHMgb2JqZWN0QXRJbmRleDppbmRleFBhdGgucm93XTsKICAgICAgICBVSU5hdmlnYXRpb25Db250cm9sbGVyICpuYXZpZ2F0aW9uQ29udHJvbGxlciA9IFtzZWd1ZSBkZXN0aW5hdGlvblZpZXdDb250cm9sbGVyXTsKICAgICAgICBNYWluQ2hhdFZpZXdDb250cm9sbGVyICpjaGF0Vmlld0NvbnRyb2xsZXIgPSAoTWFpbkNoYXRWaWV3Q29udHJvbGxlciAqKVtuYXZpZ2F0aW9uQ29udHJvbGxlciB2aXNpYmxlVmlld0NvbnRyb2xsZXJdOwogICAgICAgIGNoYXRWaWV3Q29udHJvbGxlci5jaGFubmVsID0gY2hhbm5lbDsKICAgIH0KfQoKI3ByYWdtYSBtYXJrIFN0eWxlCgotIChVSVN0YXR1c0JhclN0eWxlKXByZWZlcnJlZFN0YXR1c0JhclN0eWxlIHsKICAgIHJldHVybiBVSVN0YXR1c0JhclN0eWxlTGlnaHRDb250ZW50Owp9CgoKQGVuZAo=</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div><a href="https://github.com/TwilioDevEd/twiliochat-objc" target="_blank" class="explorer-get-code"> <i class="fa fa-lg fa-github-square"> </i>View Code on GitHub</a></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>