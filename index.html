<!DOCTYPE html><html><head><title>Twilio Chat</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Twilio Chat"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Twilio Chat</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>Learn to implement a simple chat application using Twilio IP Messaging Client</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Twilio Chat Objective-C" class="chapter"><div data-title="Introduction" data-file="twiliochat/AppDelegate.m" class="step"><h2 id="introduction">Introduction</h2>
<p>Ready to implement a chat application using Twilio IP Messaging Client?
Here is how it works at a high level:</p>
<ol>
<li><p>We use <a href="//www.parse.com/">Parse</a> to handle session management and user
registration in our app. </p>
</li>
<li><p><a href="//www.twilio.com/ip-messaging">Twilio IP Messaging</a> is the core product
we&#39;ll be using to handle all the chat functionality. </p>
</li>
<li><p>TODO: Much more information about Twilio services.</p>
</li>
</ol>
</div><div data-title="Initializing the Client" data-file="twiliochat/IPMessagingManager.m" data-highlight="99-126" class="step"><h2 id="initializing-the-ip-messaging-client">Initializing the IP Messaging Client</h2>
<p>The only thing you need to create a client, is an access token. This token
holds information about your Twilio account and IP Messaging API keys. You
can find an example application written in node that demonstrates how to
generate the token <a href="//github.com/TwilioDevEd/twiliochat">here</a>.</p>
<p>We use <a href="//parse.com/docs/cloudcode/guide#cloud-code-advanced-cloud-code-webhooks">Parse cloud code
webhooks</a>
to make a request to our server and get the access token.</p>
<hr>
<p><strong>See Also:</strong></p>
<ul>
<li><a href="//parse.com/docs/cloudcode/guide#cloud-code-advanced-cloud-code-webhooks">Parse cloud code webhooks</a></li>
</ul>
</div><div data-title="Getting the Channel List" data-file="twiliochat/ChannelManager.m" data-highlight="28-55" class="step"><h2 id="getting-the-channel-list">Getting the Channel List</h2>
<p>Our <code>ChannelManager</code> class takes care of everything related to channels.
The first thing we need to do when the class is initialized, is to store
a list of channels of type <code>TWMChannelList</code> that we get by calling the method <code>channelsListWithCompletion</code>
from the IP Messaging Client.</p>
<p>Once we have a <code>TWMChannelList</code> we can fetch the actual channels using the
<code>channelsList&#39;s</code> method <code>loadChannelsWithCompletion</code>. Once that operation
finishes successfully, call the method <code>allObjects</code> on the same object, to
get an array of channels.</p>
</div><div data-title="Join the General Room" data-file="twiliochat/ChannelManager.m" data-highlight="57-83" class="step"><h2 id="join-the-general-channel">Join the General Channel</h2>
<p>This application will try to join a channel called &quot;General&quot; when it starts.
If the channel doesn&#39;t exist, we&#39;ll create one with that name. The scope of
this example application will show you how to work only with public channels,
but the IP Messaging client allows you to create private channels and handle
invitations.</p>
<p>Once you have joined a channel, you can register a class as the <code>TWMChannelDelegate</code>
so you can start listening to events such as <code>messageAdded</code> or <code>memberJoined</code>.
We&#39;ll show you how to do this in the next step.</p>
</div><div data-title="Listen to Chat Events" data-file="twiliochat/MainChatViewController.m" data-highlight="232-259" class="step"><p>We registered <code>MainChatViewCOntroller</code> as the <code>TWMChannelDelegate</code>, and here
we implemented the following methods that listen to channel events:</p>
<ul>
<li><code>messageAdded</code>: When someone sends a message to the channel you are connected to.</li>
<li><code>channelDeleted</code>: When someone deletes a channel.</li>
<li><code>memberJoined</code>: When someone joins the channel.</li>
<li><code>memberLeft</code>: When someone leaves the channel.</li>
</ul>
<p>As you may have noticed, each one of these methods include useful objects
as parameters, such as the actual message that was added to the channel.</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="twiliochat/AppDelegate.m" data-mode="objectivec">I2ltcG9ydCA8UGFyc2UvUGFyc2UuaD4KI2ltcG9ydCAiQXBwRGVsZWdhdGUuaCIKI2ltcG9ydCAiSVBNZXNzYWdpbmdNYW5hZ2VyLmgiCkBpbXBvcnQgRm91bmRhdGlvbjsKCgpAaW50ZXJmYWNlIEFwcERlbGVnYXRlICgpCgpAZW5kCgpAaW1wbGVtZW50YXRpb24gQXBwRGVsZWdhdGUKCgotIChCT09MKWFwcGxpY2F0aW9uOihVSUFwcGxpY2F0aW9uICopYXBwbGljYXRpb24gZGlkRmluaXNoTGF1bmNoaW5nV2l0aE9wdGlvbnM6KE5TRGljdGlvbmFyeSAqKWxhdW5jaE9wdGlvbnMgewogICAgW1BhcnNlIGVuYWJsZUxvY2FsRGF0YXN0b3JlXTsKICAgIAogICAgTlNEaWN0aW9uYXJ5ICpkaWN0aW9uYXJ5ID0gW05TRGljdGlvbmFyeSBkaWN0aW9uYXJ5V2l0aENvbnRlbnRzT2ZGaWxlOltbTlNCdW5kbGUgbWFpbkJ1bmRsZV0gcGF0aEZvclJlc291cmNlOkAiS2V5cyIgb2ZUeXBlOkAicGxpc3QiXV07CiAgICBOU1N0cmluZyAqcGFyc2VBcHBsaWNhdGlvbklkID0gW2RpY3Rpb25hcnkgb2JqZWN0Rm9yS2V5OkAiUGFyc2VBcHBsaWNhdGlvbklkIl07CiAgICBOU1N0cmluZyAqcGFyc2VDbGllbnRLZXkgPSBbZGljdGlvbmFyeSBvYmplY3RGb3JLZXk6QCJQYXJzZUNsaWVudEtleSJdOwoKICAgIFtQYXJzZSBzZXRBcHBsaWNhdGlvbklkOnBhcnNlQXBwbGljYXRpb25JZAogICAgICAgICAgICAgICAgICBjbGllbnRLZXk6cGFyc2VDbGllbnRLZXldOwogICAgCiAgICBQRkFDTCAqZGVmYXVsdEFDTCA9IFtQRkFDTCBBQ0xdOwogICAgW2RlZmF1bHRBQ0wgc2V0UHVibGljUmVhZEFjY2VzczpZRVNdOwogICAgW1BGQUNMIHNldERlZmF1bHRBQ0w6ZGVmYXVsdEFDTCB3aXRoQWNjZXNzRm9yQ3VycmVudFVzZXI6WUVTXTsKCiAgICBbW0lQTWVzc2FnaW5nTWFuYWdlciBzaGFyZWRNYW5hZ2VyXSBwcmVzZW50TGF1bmNoU2NyZWVuXTsKICAgIFtbSVBNZXNzYWdpbmdNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdIHByZXNlbnRSb290Vmlld0NvbnRyb2xsZXJdOwogICAgCiAgICByZXR1cm4gWUVTOwp9CgotICh2b2lkKWFwcGxpY2F0aW9uV2lsbFJlc2lnbkFjdGl2ZTooVUlBcHBsaWNhdGlvbiAqKWFwcGxpY2F0aW9uIHsKICAgIC8vIFNlbnQgd2hlbiB0aGUgYXBwbGljYXRpb24gaXMgYWJvdXQgdG8gbW92ZSBmcm9tIGFjdGl2ZSB0byBpbmFjdGl2ZSBzdGF0ZS4gVGhpcyBjYW4gb2NjdXIgZm9yIGNlcnRhaW4gdHlwZXMgb2YgdGVtcG9yYXJ5IGludGVycnVwdGlvbnMgKHN1Y2ggYXMgYW4gaW5jb21pbmcgcGhvbmUgY2FsbCBvciBTTVMgbWVzc2FnZSkgb3Igd2hlbiB0aGUgdXNlciBxdWl0cyB0aGUgYXBwbGljYXRpb24gYW5kIGl0IGJlZ2lucyB0aGUgdHJhbnNpdGlvbiB0byB0aGUgYmFja2dyb3VuZCBzdGF0ZS4KICAgIC8vIFVzZSB0aGlzIG1ldGhvZCB0byBwYXVzZSBvbmdvaW5nIHRhc2tzLCBkaXNhYmxlIHRpbWVycywgYW5kIHRocm90dGxlIGRvd24gT3BlbkdMIEVTIGZyYW1lIHJhdGVzLiBHYW1lcyBzaG91bGQgdXNlIHRoaXMgbWV0aG9kIHRvIHBhdXNlIHRoZSBnYW1lLgp9CgotICh2b2lkKWFwcGxpY2F0aW9uRGlkRW50ZXJCYWNrZ3JvdW5kOihVSUFwcGxpY2F0aW9uICopYXBwbGljYXRpb24gewogICAgLy8gVXNlIHRoaXMgbWV0aG9kIHRvIHJlbGVhc2Ugc2hhcmVkIHJlc291cmNlcywgc2F2ZSB1c2VyIGRhdGEsIGludmFsaWRhdGUgdGltZXJzLCBhbmQgc3RvcmUgZW5vdWdoIGFwcGxpY2F0aW9uIHN0YXRlIGluZm9ybWF0aW9uIHRvIHJlc3RvcmUgeW91ciBhcHBsaWNhdGlvbiB0byBpdHMgY3VycmVudCBzdGF0ZSBpbiBjYXNlIGl0IGlzIHRlcm1pbmF0ZWQgbGF0ZXIuCiAgICAvLyBJZiB5b3VyIGFwcGxpY2F0aW9uIHN1cHBvcnRzIGJhY2tncm91bmQgZXhlY3V0aW9uLCB0aGlzIG1ldGhvZCBpcyBjYWxsZWQgaW5zdGVhZCBvZiBhcHBsaWNhdGlvbldpbGxUZXJtaW5hdGU6IHdoZW4gdGhlIHVzZXIgcXVpdHMuCn0KCi0gKHZvaWQpYXBwbGljYXRpb25XaWxsRW50ZXJGb3JlZ3JvdW5kOihVSUFwcGxpY2F0aW9uICopYXBwbGljYXRpb24gewogICAgLy8gQ2FsbGVkIGFzIHBhcnQgb2YgdGhlIHRyYW5zaXRpb24gZnJvbSB0aGUgYmFja2dyb3VuZCB0byB0aGUgaW5hY3RpdmUgc3RhdGU7IGhlcmUgeW91IGNhbiB1bmRvIG1hbnkgb2YgdGhlIGNoYW5nZXMgbWFkZSBvbiBlbnRlcmluZyB0aGUgYmFja2dyb3VuZC4KfQoKLSAodm9pZClhcHBsaWNhdGlvbkRpZEJlY29tZUFjdGl2ZTooVUlBcHBsaWNhdGlvbiAqKWFwcGxpY2F0aW9uIHsKICAgIC8vIFJlc3RhcnQgYW55IHRhc2tzIHRoYXQgd2VyZSBwYXVzZWQgKG9yIG5vdCB5ZXQgc3RhcnRlZCkgd2hpbGUgdGhlIGFwcGxpY2F0aW9uIHdhcyBpbmFjdGl2ZS4gSWYgdGhlIGFwcGxpY2F0aW9uIHdhcyBwcmV2aW91c2x5IGluIHRoZSBiYWNrZ3JvdW5kLCBvcHRpb25hbGx5IHJlZnJlc2ggdGhlIHVzZXIgaW50ZXJmYWNlLgp9CgotICh2b2lkKWFwcGxpY2F0aW9uV2lsbFRlcm1pbmF0ZTooVUlBcHBsaWNhdGlvbiAqKWFwcGxpY2F0aW9uIHsKICAgIC8vIENhbGxlZCB3aGVuIHRoZSBhcHBsaWNhdGlvbiBpcyBhYm91dCB0byB0ZXJtaW5hdGUuIFNhdmUgZGF0YSBpZiBhcHByb3ByaWF0ZS4gU2VlIGFsc28gYXBwbGljYXRpb25EaWRFbnRlckJhY2tncm91bmQ6Lgp9CgpAZW5kCg==</textarea>
<textarea class="saurus-file" data-file="twiliochat/IPMessagingManager.m" data-mode="objectivec">I2ltcG9ydCA8UGFyc2UvUGFyc2UuaD4KI2ltcG9ydCAiSVBNZXNzYWdpbmdNYW5hZ2VyLmgiCiNpbXBvcnQgIkNoYW5uZWxNYW5hZ2VyLmgiCgpAaW50ZXJmYWNlIElQTWVzc2FnaW5nTWFuYWdlciAoKQpAcHJvcGVydHkgKG5vbmF0b21pYywgc3Ryb25nKSBUd2lsaW9JUE1lc3NhZ2luZ0NsaWVudCAqY2xpZW50OwpAcHJvcGVydHkgKG5vbmF0b21pYywgc3Ryb25nKSBOU0RhdGEgKmxhc3RUb2tlbjsKQHByb3BlcnR5IChub25hdG9taWMsIHN0cm9uZykgTlNEaWN0aW9uYXJ5ICpsYXN0Tm90aWZpY2F0aW9uOwpAcHJvcGVydHkgKG5vbmF0b21pYykgQk9PTCBjb25uZWN0aW5nOwpAZW5kCgpAaW1wbGVtZW50YXRpb24gSVBNZXNzYWdpbmdNYW5hZ2VyCisgKGluc3RhbmNldHlwZSlzaGFyZWRNYW5hZ2VyIHsKICAgIHN0YXRpYyBJUE1lc3NhZ2luZ01hbmFnZXIgKnNoYXJlZE15TWFuYWdlciA9IG5pbDsKICAgIHN0YXRpYyBkaXNwYXRjaF9vbmNlX3Qgb25jZVRva2VuOwogICAgZGlzcGF0Y2hfb25jZSgmb25jZVRva2VuLCBeewogICAgICAgIHNoYXJlZE15TWFuYWdlciA9IFtbc2VsZiBhbGxvY10gaW5pdF07CiAgICB9KTsKICAgIHJldHVybiBzaGFyZWRNeU1hbmFnZXI7Cn0KCi0gKHZvaWQpcHJlc2VudFJvb3RWaWV3Q29udHJvbGxlciB7CiAgICBpZiAoW3NlbGYgaGFzSWRlbnRpdHldKSB7CiAgICAgICAgaWYgKHNlbGYuY29ubmVjdGluZykgewogICAgICAgICAgICBbc2VsZiBwcmVzZW50Vmlld0NvbnRyb2xsZXJCeU5hbWU6QCJSZXZlYWxWaWV3Q29udHJvbGxlciJdOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgW3NlbGYgY29ubmVjdENsaWVudDpeKEJPT0wgc3VjY2VzcywgTlNFcnJvciAqZXJyb3IpIHsKICAgICAgICAgICAgICAgIGlmIChzdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgW3NlbGYgcHJlc2VudFZpZXdDb250cm9sbGVyQnlOYW1lOkAiUmV2ZWFsVmlld0NvbnRyb2xsZXIiXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIFtzZWxmIHByZXNlbnRWaWV3Q29udHJvbGxlckJ5TmFtZTpAIkxvZ2luVmlld0NvbnRyb2xsZXIiXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfV07CiAgICAgICAgfQogICAgfQogICAgZWxzZSB7CiAgICAgICAgW3NlbGYgcHJlc2VudFZpZXdDb250cm9sbGVyQnlOYW1lOkAiTG9naW5WaWV3Q29udHJvbGxlciJdOwogICAgfQp9CgotICh2b2lkKXByZXNlbnRWaWV3Q29udHJvbGxlckJ5TmFtZTooTlNTdHJpbmcgKil2aWV3Q29udHJvbGxlciB7CiAgICBbc2VsZiBwcmVzZW50Vmlld0NvbnRyb2xsZXI6W1tzZWxmIHN0b3J5Ym9hcmRXaXRoTmFtZTpAIk1haW4iXSBpbnN0YW50aWF0ZVZpZXdDb250cm9sbGVyV2l0aElkZW50aWZpZXI6dmlld0NvbnRyb2xsZXJdXTsKfQoKLSAodm9pZClwcmVzZW50TGF1bmNoU2NyZWVuIHsKICAgIFtzZWxmIHByZXNlbnRWaWV3Q29udHJvbGxlcjpbW3NlbGYgc3Rvcnlib2FyZFdpdGhOYW1lOkAiTGF1bmNoU2NyZWVuIl0gaW5zdGFudGlhdGVJbml0aWFsVmlld0NvbnRyb2xsZXJdXTsKfQoKLSAodm9pZClwcmVzZW50Vmlld0NvbnRyb2xsZXI6KFVJVmlld0NvbnRyb2xsZXIgKil2aWV3Q29udHJvbGxlciB7CiAgICBVSVdpbmRvdyAqd2luZG93ID0gW1tVSUFwcGxpY2F0aW9uIHNoYXJlZEFwcGxpY2F0aW9uXS5kZWxlZ2F0ZSB3aW5kb3ddOwogICAgd2luZG93LnJvb3RWaWV3Q29udHJvbGxlciA9IHZpZXdDb250cm9sbGVyOwp9CgotIChVSVN0b3J5Ym9hcmQgKilzdG9yeWJvYXJkV2l0aE5hbWU6KE5TU3RyaW5nICopbmFtZSB7CiAgICByZXR1cm4gW1VJU3Rvcnlib2FyZCBzdG9yeWJvYXJkV2l0aE5hbWU6IG5hbWUgYnVuZGxlOiBbTlNCdW5kbGUgbWFpbkJ1bmRsZV1dOwp9CgotIChCT09MKWhhc0lkZW50aXR5IHsKICAgIHJldHVybiBbUEZVc2VyIGN1cnJlbnRVc2VyXSAmJiBbW1BGVXNlciBjdXJyZW50VXNlcl0gaXNBdXRoZW50aWNhdGVkXTsKfQoKLSAodm9pZClyZWdpc3RlcldpdGhVc2VybmFtZTooTlNTdHJpbmcgKil1c2VybmFtZQogICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOihOU1N0cmluZyAqKXBhc3N3b3JkCiAgICAgICAgICAgICAgICAgICAgZnVsbE5hbWU6KE5TU3RyaW5nICopZnVsbE5hbWUKICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDooTlNTdHJpbmcgKillbWFpbAogICAgICAgICAgICAgICAgICAgICBoYW5kbGVyOih2b2lkKF4pKEJPT0wgc3VjY2VlZGVkLCBOU0Vycm9yICplcnJvcikpaGFuZGxlciB7CiAgICBQRlVzZXIgKnVzZXIgPSBbUEZVc2VyIHVzZXJdOwogICAgdXNlci51c2VybmFtZSA9IHVzZXJuYW1lOwogICAgdXNlci5wYXNzd29yZCA9IHBhc3N3b3JkOwogICAgdXNlci5lbWFpbCA9IGVtYWlsOwogICAgdXNlcltAImZ1bGxOYW1lIl0gPSBmdWxsTmFtZTsKICAgIAogICAgW3VzZXIgc2lnblVwSW5CYWNrZ3JvdW5kV2l0aEJsb2NrOl4oQk9PTCBzdWNjZWVkZWQsIE5TRXJyb3IgKmVycm9yKSB7CiAgICAgICAgaWYgKHN1Y2NlZWRlZCkgewogICAgICAgICAgICBbc2VsZiBjb25uZWN0Q2xpZW50OmhhbmRsZXJdOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgaWYgKGhhbmRsZXIpIGhhbmRsZXIoc3VjY2VlZGVkLCBlcnJvcik7CiAgICAgICAgfQogICAgfV07Cn0KCi0gKHZvaWQpbG9naW5XaXRoVXNlcm5hbWU6KE5TU3RyaW5nICopdXNlcm5hbWUgcGFzc3dvcmQ6KE5TU3RyaW5nICopcGFzc3dvcmQKICAgICAgICAgICAgICAgICAgaGFuZGxlcjoodm9pZCheKShCT09MIHN1Y2NlZWRlZCwgTlNFcnJvciAqZXJyb3IpKWhhbmRsZXIgewogICAgW1BGVXNlciBsb2dJbldpdGhVc2VybmFtZUluQmFja2dyb3VuZDp1c2VybmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDpwYXNzd29yZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jazpeKFBGVXNlciAqdXNlciwgTlNFcnJvciAqZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbc2VsZiBjb25uZWN0Q2xpZW50OmhhbmRsZXJdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhbmRsZXIpIGhhbmRsZXIoIWVycm9yLCBlcnJvcik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dOwp9CgotICh2b2lkKWNvbm5lY3RDbGllbnQ6KHZvaWQoXikoQk9PTCBzdWNjZWVkZWQsIE5TRXJyb3IgKmVycm9yKSloYW5kbGVyIHsKICAgIGlmIChzZWxmLmNsaWVudCkgewogICAgICAgIFtzZWxmIGxvZ291dF07CiAgICB9CiAgICAKICAgIFtQRkNsb3VkIGNhbGxGdW5jdGlvbkluQmFja2dyb3VuZDpAInRva2VuIgogICAgICAgICAgICAgICAgICAgICAgIHdpdGhQYXJhbWV0ZXJzOkB7QCJkZXZpY2UiOiBbW1VJRGV2aWNlIGN1cnJlbnREZXZpY2VdIGlkZW50aWZpZXJGb3JWZW5kb3JdLlVVSURTdHJpbmd9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2s6XihOU0RpY3Rpb25hcnkgKnJlc3VsdHMsIE5TRXJyb3IgKmVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5TU3RyaW5nICp0b2tlbiA9IFtyZXN1bHRzIG9iamVjdEZvcktleTpAInRva2VuIl07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJPT0wgZXJyb3JDb25kaXRpb24gPSBlcnJvciB8fCAhdG9rZW47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWVycm9yQ29uZGl0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOU0xvZyhAIiVAIixyZXN1bHRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY2xpZW50ID0gW1R3aWxpb0lQTWVzc2FnaW5nQ2xpZW50IGlwTWVzc2FnaW5nQ2xpZW50V2l0aFRva2VuOnRva2VuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxlZ2F0ZTpuaWxdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3NlbGYgbG9hZEdlbmVyYWxDaGF0Um9vbTpoYW5kbGVyXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYW5kbGVyKSBoYW5kbGVyKCFlcnJvciwgZXJyb3IpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfV07Cn0KCi0gKHZvaWQpbG9hZEdlbmVyYWxDaGF0Um9vbToodm9pZCheKShCT09MIHN1Y2NlZWRlZCwgTlNFcnJvciAqZXJyb3IpKWhhbmRsZXIgewogICAgW1tDaGFubmVsTWFuYWdlciBzaGFyZWRNYW5hZ2VyXSBjcmVhdGVHZW5lcmFsQ2hhdFJvb21XaXRoQmxvY2s6XihUV01SZXN1bHQgcmVzdWx0LCBUV01DaGFubmVsICpjaGFubmVsKSB7CiAgICAgICAgc2VsZi5jb25uZWN0aW5nID0gWUVTOwogICAgICAgIGlmIChyZXN1bHQgPT0gVFdNUmVzdWx0U3VjY2VzcykKICAgICAgICB7CiAgICAgICAgICAgIGlmIChoYW5kbGVyKSBoYW5kbGVyKFlFUywgbmlsKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmIChoYW5kbGVyKSBoYW5kbGVyKE5PLCBbTlNFcnJvciBlcnJvcldpdGhEb21haW46QCJjaGFubmVsIiBjb2RlOjEwMDAgdXNlckluZm86bmlsXSk7CiAgICAgICAgfQogICAgICAgIHNlbGYuY29ubmVjdGluZyA9IE5POwogICAgfV07Cn0KCi0gKHZvaWQpbG9nb3V0IHsKICAgIFtQRlVzZXIgbG9nT3V0XTsKICAgIAogICAgZGlzcGF0Y2hfYXN5bmMoZGlzcGF0Y2hfZ2V0X2dsb2JhbF9xdWV1ZShESVNQQVRDSF9RVUVVRV9QUklPUklUWV9ERUZBVUxULCAwKSwgXnsKICAgICAgICBbc2VsZi5jbGllbnQgc2h1dGRvd25dOwogICAgICAgIHNlbGYuY2xpZW50ID0gbmlsOwogICAgfSk7Cn0KCi0gKHZvaWQpdXBkYXRlUHVzaFRva2VuOihOU0RhdGEgKil0b2tlbiB7CiAgICBzZWxmLmxhc3RUb2tlbiA9IHRva2VuOwogICAgW3NlbGYgdXBkYXRlSXBNZXNzYWdpbmdDbGllbnRdOwp9CgotICh2b2lkKXJlY2VpdmVkTm90aWZpY2F0aW9uOihOU0RpY3Rpb25hcnkgKilub3RpZmljYXRpb24gewogICAgc2VsZi5sYXN0Tm90aWZpY2F0aW9uID0gbm90aWZpY2F0aW9uOwogICAgW3NlbGYgdXBkYXRlSXBNZXNzYWdpbmdDbGllbnRdOwp9CgoKI3ByYWdtYSBtYXJrIFB1c2ggZnVuY3Rpb25hbGl0eQoKLSAodm9pZCl1cGRhdGVJcE1lc3NhZ2luZ0NsaWVudCB7CiAgICBpZiAoc2VsZi5sYXN0VG9rZW4pIHsKICAgICAgICBbc2VsZi5jbGllbnQgcmVnaXN0ZXJXaXRoVG9rZW46c2VsZi5sYXN0VG9rZW5dOwogICAgICAgIHNlbGYubGFzdFRva2VuID0gbmlsOwogICAgfQogICAgCiAgICBpZiAoc2VsZi5sYXN0Tm90aWZpY2F0aW9uKSB7CiAgICAgICAgW3NlbGYuY2xpZW50IGhhbmRsZU5vdGlmaWNhdGlvbjpzZWxmLmxhc3ROb3RpZmljYXRpb25dOwogICAgICAgIHNlbGYubGFzdE5vdGlmaWNhdGlvbiA9IG5pbDsKICAgIH0KfQoKI3ByYWdtYSBtYXJrIEludGVybmFsIGhlbHBlcnMKCi0gKE5TU3RyaW5nICopdXNlcklkZW50aXR5IHsKICAgIHJldHVybiBbW1BGVXNlciBjdXJyZW50VXNlcl0gdXNlcm5hbWVdOwp9CgpAZW5kCg==</textarea>
<textarea class="saurus-file" data-file="twiliochat/ChannelManager.m" data-mode="objectivec">I2ltcG9ydCAiQ2hhbm5lbE1hbmFnZXIuaCIKI2ltcG9ydCAiSVBNZXNzYWdpbmdNYW5hZ2VyLmgiCgpAaW50ZXJmYWNlIENoYW5uZWxNYW5hZ2VyICgpCkBlbmQKCk5TU3RyaW5nICpkZWZhdWx0Q2hhbm5lbFVuaXF1ZU5hbWUgPSBAImdlbmVyYWwiOwpOU1N0cmluZyAqZGVmYXVsdENoYW5uZWxOYW1lID0gQCJHZW5lcmFsIjsKCkBpbXBsZW1lbnRhdGlvbiBDaGFubmVsTWFuYWdlcgoKKyAoaW5zdGFuY2V0eXBlKXNoYXJlZE1hbmFnZXIgewogICAgc3RhdGljIENoYW5uZWxNYW5hZ2VyICpzaGFyZWRNeU1hbmFnZXIgPSBuaWw7CiAgICBzdGF0aWMgZGlzcGF0Y2hfb25jZV90IG9uY2VUb2tlbjsKICAgIGRpc3BhdGNoX29uY2UoJm9uY2VUb2tlbiwgXnsKICAgICAgICBzaGFyZWRNeU1hbmFnZXIgPSBbW3NlbGYgYWxsb2NdIGluaXRdOwogICAgfSk7CiAgICByZXR1cm4gc2hhcmVkTXlNYW5hZ2VyOwp9CgotIChpbnN0YW5jZXR5cGUpaW5pdCB7CiAgICAKICAgIHNlbGYuY2hhbm5lbHMgPSBbW05TTXV0YWJsZU9yZGVyZWRTZXQgYWxsb2NdIGluaXRdOwogICAgW0lQTWVzc2FnaW5nTWFuYWdlciBzaGFyZWRNYW5hZ2VyXS5jbGllbnQuZGVsZWdhdGUgPSBzZWxmOwogICAgcmV0dXJuIHNlbGY7Cn0KCi0gKHZvaWQpY3JlYXRlR2VuZXJhbENoYXRSb29tV2l0aEJsb2NrOih2b2lkKF4pKFRXTVJlc3VsdCByZXN1bHQsIFRXTUNoYW5uZWwgKmNoYW5uZWwpKWJsb2NrIHsKICAgIFtzZWxmIHBvcHVsYXRlQ2hhbm5lbHNXaXRoQmxvY2s6XihUV01SZXN1bHQgcmVzdWx0KSB7CiAgICAgICAgaWYgKHJlc3VsdCA9PSBUV01SZXN1bHRTdWNjZXNzKSB7CiAgICAgICAgICAgIHNlbGYuZ2VuZXJhbENoYXRyb29tID0gW3NlbGYuY2hhbm5lbHNMaXN0IGNoYW5uZWxXaXRoVW5pcXVlTmFtZTpkZWZhdWx0Q2hhbm5lbFVuaXF1ZU5hbWVdOwogICAgICAgICAgICBpZiAoc2VsZi5nZW5lcmFsQ2hhdHJvb20pIHsKICAgICAgICAgICAgICAgIFtzZWxmIGpvaW5HZW5lcmFsQ2hhdFJvb21XaXRoQmxvY2s6YmxvY2tdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgW3NlbGYuY2hhbm5lbHNMaXN0IGNyZWF0ZUNoYW5uZWxXaXRoRnJpZW5kbHlOYW1lOmRlZmF1bHRDaGFubmVsTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOlRXTUNoYW5uZWxUeXBlUHVibGljCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRpb246XihUV01SZXN1bHQgcmVzdWx0LCBUV01DaGFubmVsICpjaGFubmVsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmdlbmVyYWxDaGF0cm9vbSA9IGNoYW5uZWw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09IFRXTVJlc3VsdFN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmdlbmVyYWxDaGF0cm9vbSA9IGNoYW5uZWw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3NlbGYgam9pbkdlbmVyYWxDaGF0Um9vbVdpdGhVbmlxdWVOYW1lOmRlZmF1bHRDaGFubmVsVW5pcXVlTmFtZSBibG9jazpibG9ja107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2socmVzdWx0LCBzZWxmLmdlbmVyYWxDaGF0cm9vbSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayhyZXN1bHQsIG5pbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBibG9jayhyZXN1bHQsIG5pbCk7CiAgICAgICAgfQogICAgfV07Cn0KCi0gKHZvaWQpam9pbkdlbmVyYWxDaGF0Um9vbVdpdGhCbG9jazoodm9pZCheKShUV01SZXN1bHQgcmVzdWx0LCBUV01DaGFubmVsICpjaGFubmVsKSlibG9jayB7CiAgICBbc2VsZiBqb2luR2VuZXJhbENoYXRSb29tV2l0aFVuaXF1ZU5hbWU6bmlsIGJsb2NrOmJsb2NrXTsKfQoKLSAodm9pZClqb2luR2VuZXJhbENoYXRSb29tV2l0aFVuaXF1ZU5hbWU6KE5TU3RyaW5nICopdW5pcXVlTmFtZSBibG9jazoodm9pZCheKShUV01SZXN1bHQgcmVzdWx0LCBUV01DaGFubmVsICpjaGFubmVsKSlibG9jayB7CiAgICBfX3dlYWsgVFdNQ2hhbm5lbCAqd2Vha0dlbmVyYWxDaGF0Um9vbSA9IHNlbGYuZ2VuZXJhbENoYXRyb29tOwogICAgW3NlbGYuZ2VuZXJhbENoYXRyb29tIGpvaW5XaXRoQ29tcGxldGlvbjpeKFRXTVJlc3VsdCByZXN1bHQpIHsKICAgICAgICBpZiAocmVzdWx0ID09IFRXTVJlc3VsdFN1Y2Nlc3MpIHsKICAgICAgICAgICAgaWYgKHVuaXF1ZU5hbWUpIHsKICAgICAgICAgICAgICAgIFtzZWxmLmdlbmVyYWxDaGF0cm9vbSBzZXRVbmlxdWVOYW1lOmRlZmF1bHRDaGFubmVsVW5pcXVlTmFtZSBjb21wbGV0aW9uOl4oVFdNUmVzdWx0IHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgPT0gVFdNUmVzdWx0U3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgICAgICBibG9jayhyZXN1bHQsIHdlYWtHZW5lcmFsQ2hhdFJvb20pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2socmVzdWx0LCBuaWwpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH1dOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgYmxvY2socmVzdWx0LCBzZWxmLmdlbmVyYWxDaGF0cm9vbSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGJsb2NrKHJlc3VsdCwgbmlsKTsKICAgICAgICB9CiAgICB9XTsKfQoKLSAodm9pZClsb2FkQ2hhbm5lbExpc3RXaXRoQmxvY2s6KHZvaWQoXikoVFdNUmVzdWx0IHJlc3VsdCwgVFdNQ2hhbm5lbHMgKmNoYW5uZWxzTGlzdCkpYmxvY2sgewogICAgc2VsZi5jaGFubmVsc0xpc3QgPSBuaWw7CiAgICAKICAgIGRpc3BhdGNoX2FzeW5jKGRpc3BhdGNoX2dldF9nbG9iYWxfcXVldWUoRElTUEFUQ0hfUVVFVUVfUFJJT1JJVFlfREVGQVVMVCwgMCksIF57CiAgICAgICAgW1tJUE1lc3NhZ2luZ01hbmFnZXIgc2hhcmVkTWFuYWdlcl0uY2xpZW50IGNoYW5uZWxzTGlzdFdpdGhDb21wbGV0aW9uOl4oVFdNUmVzdWx0IHJlc3VsdCwgVFdNQ2hhbm5lbHMgKmNoYW5uZWxzTGlzdCkgewogICAgICAgICAgICBpZiAocmVzdWx0ID09IFRXTVJlc3VsdFN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgIHNlbGYuY2hhbm5lbHNMaXN0ID0gY2hhbm5lbHNMaXN0OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgLy8gU2hvdyBlcnJvcgogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChibG9jaykgYmxvY2socmVzdWx0LCBzZWxmLmNoYW5uZWxzTGlzdCk7CiAgICAgICAgfV07CiAgICB9KTsKfQoKLSAodm9pZClwb3B1bGF0ZUNoYW5uZWxzV2l0aEJsb2NrOih2b2lkKF4pKFRXTVJlc3VsdCByZXN1bHQpKWJsb2NrIHsKICAgIHNlbGYuY2hhbm5lbHMgPSBuaWw7CiAgICAKICAgIFtzZWxmIGxvYWRDaGFubmVsTGlzdFdpdGhCbG9jazpeKFRXTVJlc3VsdCByZXN1bHQsIFRXTUNoYW5uZWxzICpjaGFubmVsc0xpc3QpIHsKICAgICAgICBpZiAocmVzdWx0ID09IFRXTVJlc3VsdFN1Y2Nlc3MpIHsKICAgICAgICAgICAgZGlzcGF0Y2hfYXN5bmMoZGlzcGF0Y2hfZ2V0X2dsb2JhbF9xdWV1ZShESVNQQVRDSF9RVUVVRV9QUklPUklUWV9ERUZBVUxULCAwKSwgXnsKICAgICAgICAgICAgICAgIFtzZWxmLmNoYW5uZWxzTGlzdCBsb2FkQ2hhbm5lbHNXaXRoQ29tcGxldGlvbjpeKFRXTVJlc3VsdCByZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09IFRXTVJlc3VsdFN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jaGFubmVscyA9IFtbTlNNdXRhYmxlT3JkZXJlZFNldCBhbGxvY10gaW5pdF07CiAgICAgICAgICAgICAgICAgICAgICAgIFtzZWxmLmNoYW5uZWxzIGFkZE9iamVjdHNGcm9tQXJyYXk6W3NlbGYuY2hhbm5lbHNMaXN0IGFsbE9iamVjdHNdXTsKICAgICAgICAgICAgICAgICAgICAgICAgW3NlbGYgc29ydENoYW5uZWxzXTsgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIE5TTG9nKEAiRXJyb3IgY3JlYXRpbmcgY2hhbm5lbCIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaF9hc3luYyhkaXNwYXRjaF9nZXRfbWFpbl9xdWV1ZSgpLCBeewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmxvY2spIGJsb2NrKHJlc3VsdCk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9XTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBkaXNwYXRjaF9hc3luYyhkaXNwYXRjaF9nZXRfbWFpbl9xdWV1ZSgpLCBeewogICAgICAgICAgICAgICAgTlNMb2coQCJFcnJvciBjcmVhdGluZyBjaGFubmVsIik7CiAgICAgICAgICAgICAgICBzZWxmLmNoYW5uZWxzTGlzdCA9IG5pbDsKICAgICAgICAgICAgICAgIHNlbGYuY2hhbm5lbHMgPSBuaWw7CiAgICAgICAgICAgICAgICBpZiAoYmxvY2spIGJsb2NrKHJlc3VsdCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH1dOwp9CgotICh2b2lkKXNvcnRDaGFubmVscyB7CiAgICBbc2VsZi5jaGFubmVscyBzb3J0VXNpbmdEZXNjcmlwdG9yczpAW1tbTlNTb3J0RGVzY3JpcHRvciBhbGxvY10gaW5pdFdpdGhLZXk6QCJmcmllbmRseU5hbWUiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc2NlbmRpbmc6WUVTCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3I6QHNlbGVjdG9yKGxvY2FsaXplZENhc2VJbnNlbnNpdGl2ZUNvbXBhcmU6KV1dXTsKfQoKLSAodm9pZCljcmVhdGVDaGFubmVsV2l0aE5hbWU6KE5TU3RyaW5nICopbmFtZSBibG9jazoodm9pZCheKShUV01SZXN1bHQgcmVzdWx0LCBUV01DaGFubmVsICpjaGFubmVsKSlibG9jayB7CiAgICBpZiAoW25hbWUgaXNFcXVhbFRvU3RyaW5nOmRlZmF1bHRDaGFubmVsTmFtZV0pIHsKICAgICAgICBpZiAoYmxvY2spIGJsb2NrKFRXTVJlc3VsdEZhaWx1cmUsIG5pbCk7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgCiAgICBpZiAoIXNlbGYuY2hhbm5lbHNMaXN0KQogICAgewogICAgICAgIFtzZWxmIGxvYWRDaGFubmVsTGlzdFdpdGhCbG9jazpeKFRXTVJlc3VsdCByZXN1bHQsIFRXTUNoYW5uZWxzICpjaGFubmVsc0xpc3QpIHsKICAgICAgICAgICAgaWYgKHJlc3VsdCA9PSBUV01SZXN1bHRTdWNjZXNzKSB7CiAgICAgICAgICAgICAgICBbc2VsZiBjcmVhdGVDaGFubmVsV2l0aE5hbWU6bmFtZSBibG9jazpibG9ja107CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBOU0xvZyhAIkVycm9yIGNyZWF0aW5nIGNoYW5uZWwiKTsKICAgICAgICAgICAgICAgIGlmIChibG9jaykgYmxvY2socmVzdWx0LCBuaWwpOwogICAgICAgICAgICB9CiAgICAgICAgfV07CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgCiAgICBbc2VsZi5jaGFubmVsc0xpc3QgY3JlYXRlQ2hhbm5lbFdpdGhGcmllbmRseU5hbWU6bmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOlRXTUNoYW5uZWxUeXBlUHVibGljCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRpb246XihUV01SZXN1bHQgcmVzdWx0LCBUV01DaGFubmVsICpjaGFubmVsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX3dlYWsgVFdNQ2hhbm5lbCAqY2ggPSBjaGFubmVsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCA9PSBUV01SZXN1bHRTdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2NoYW5uZWwgam9pbldpdGhDb21wbGV0aW9uOl4oVFdNUmVzdWx0IHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbY2hhbm5lbCBzZXRBdHRyaWJ1dGVzOkB7QCJvd25lciI6IFtbSVBNZXNzYWdpbmdNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdIHVzZXJJZGVudGl0eV19CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRpb246XihUV01SZXN1bHQgcmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmxvY2spIGJsb2NrKHJlc3VsdCwgY2gpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5TTG9nKEAiRXJyb3IgY3JlYXRpbmcgY2hhbm5lbCIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChibG9jaykgYmxvY2socmVzdWx0LCBuaWwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XTsKfQoKLSAodm9pZClpcE1lc3NhZ2luZ0NsaWVudDooVHdpbGlvSVBNZXNzYWdpbmdDbGllbnQgKiljbGllbnQgY2hhbm5lbEFkZGVkOihUV01DaGFubmVsICopY2hhbm5lbCB7CiAgICBkaXNwYXRjaF9hc3luYyhkaXNwYXRjaF9nZXRfbWFpbl9xdWV1ZSgpLCBeewogICAgICAgIFtzZWxmLmNoYW5uZWxzIGFkZE9iamVjdDpjaGFubmVsXTsKICAgICAgICBbc2VsZiBzb3J0Q2hhbm5lbHNdOwogICAgICAgIFtzZWxmLmRlbGVnYXRlIGlwTWVzc2FnaW5nQ2xpZW50OmNsaWVudCBjaGFubmVsQWRkZWQ6Y2hhbm5lbF07CiAgICB9KTsKfQoKLSAodm9pZClpcE1lc3NhZ2luZ0NsaWVudDooVHdpbGlvSVBNZXNzYWdpbmdDbGllbnQgKiljbGllbnQgY2hhbm5lbENoYW5nZWQ6KFRXTUNoYW5uZWwgKiljaGFubmVsIHsKICAgIGRpc3BhdGNoX2FzeW5jKGRpc3BhdGNoX2dldF9tYWluX3F1ZXVlKCksIF57CiAgICAgICAgW3NlbGYuZGVsZWdhdGUgaXBNZXNzYWdpbmdDbGllbnQ6Y2xpZW50IGNoYW5uZWxDaGFuZ2VkOmNoYW5uZWxdOwogICAgfSk7Cn0KCi0gKHZvaWQpaXBNZXNzYWdpbmdDbGllbnQ6KFR3aWxpb0lQTWVzc2FnaW5nQ2xpZW50ICopY2xpZW50IGNoYW5uZWxEZWxldGVkOihUV01DaGFubmVsICopY2hhbm5lbCB7CiAgICBkaXNwYXRjaF9hc3luYyhkaXNwYXRjaF9nZXRfbWFpbl9xdWV1ZSgpLCBeewogICAgICAgIFtbQ2hhbm5lbE1hbmFnZXIgc2hhcmVkTWFuYWdlcl0uY2hhbm5lbHMgcmVtb3ZlT2JqZWN0OmNoYW5uZWxdOwogICAgICAgIFtzZWxmLmRlbGVnYXRlIGlwTWVzc2FnaW5nQ2xpZW50OmNsaWVudCBjaGFubmVsRGVsZXRlZDpjaGFubmVsXTsKICAgIH0pOwp9CgoKQGVuZAo=</textarea>
<textarea class="saurus-file" data-file="twiliochat/MainChatViewController.m" data-mode="objectivec">I2ltcG9ydCA8UGFyc2UvUGFyc2UuaD4KI2ltcG9ydCA8VHdpbGlvSVBNZXNzYWdpbmdDbGllbnQvVHdpbGlvSVBNZXNzYWdpbmdDbGllbnQuaD4KI2ltcG9ydCAiTWFpbkNoYXRWaWV3Q29udHJvbGxlci5oIgojaW1wb3J0ICJDaGF0VGFibGVDZWxsLmgiCiNpbXBvcnQgIk5TRGF0ZStJU084NjAxUGFyc2VyLmgiCiNpbXBvcnQgIlNXUmV2ZWFsVmlld0NvbnRyb2xsZXIuaCIKI2ltcG9ydCAiQ2hhbm5lbE1hbmFnZXIuaCIKI2ltcG9ydCAiU3RhdHVzRW50cnkuaCIKCkBpbnRlcmZhY2UgTWFpbkNoYXRWaWV3Q29udHJvbGxlciAoKQpAcHJvcGVydHkgKHdlYWssIG5vbmF0b21pYykgSUJPdXRsZXQgVUlCYXJCdXR0b25JdGVtICpyZXZlYWxCdXR0b25JdGVtOwpAcHJvcGVydHkgKHdlYWssIG5vbmF0b21pYykgSUJPdXRsZXQgVUlCYXJCdXR0b25JdGVtICphY3Rpb25CdXR0b25JdGVtOwoKQHByb3BlcnR5IChzdHJvbmcsIG5vbmF0b21pYykgTlNNdXRhYmxlT3JkZXJlZFNldCAqbWVzc2FnZXM7CgpAZW5kCgpzdGF0aWMgTlNTdHJpbmcgKkNoYXRDZWxsSWRlbnRpZmllciA9IEAiQ2hhdFRhYmxlQ2VsbCI7CnN0YXRpYyBOU1N0cmluZyAqQ2hhdFN0YXR1c0NlbGxJZGVudGlmaWVyID0gQCJDaGF0U3RhdHVzVGFibGVDZWxsIjsKCkBpbXBsZW1lbnRhdGlvbiBNYWluQ2hhdFZpZXdDb250cm9sbGVyCgojcHJhZ21hIG1hcmsgSW5pdGlhbGl6YXRpb24KCi0gKHZvaWQpdmlld0RpZExvYWQgewogICAgW3N1cGVyIHZpZXdEaWRMb2FkXTsKICAgIAogICAgaWYgKHNlbGYucmV2ZWFsVmlld0NvbnRyb2xsZXIpCiAgICB7CiAgICAgICAgW3NlbGYucmV2ZWFsQnV0dG9uSXRlbSBzZXRUYXJnZXQ6IHNlbGYucmV2ZWFsVmlld0NvbnRyb2xsZXJdOwogICAgICAgIFtzZWxmLnJldmVhbEJ1dHRvbkl0ZW0gc2V0QWN0aW9uOiBAc2VsZWN0b3IoIHJldmVhbFRvZ2dsZTogKV07CiAgICAgICAgW3NlbGYubmF2aWdhdGlvbkNvbnRyb2xsZXIubmF2aWdhdGlvbkJhciBhZGRHZXN0dXJlUmVjb2duaXplcjogc2VsZi5yZXZlYWxWaWV3Q29udHJvbGxlci5wYW5HZXN0dXJlUmVjb2duaXplcl07CiAgICAgICAgc2VsZi5yZXZlYWxWaWV3Q29udHJvbGxlci5yZWFyVmlld1JldmVhbE92ZXJkcmF3ID0gMC5mOwogICAgfQoKICAgIHNlbGYuYm91bmNlcyA9IFlFUzsKICAgIHNlbGYuc2hha2VUb0NsZWFyRW5hYmxlZCA9IFlFUzsKICAgIHNlbGYua2V5Ym9hcmRQYW5uaW5nRW5hYmxlZCA9IFlFUzsKICAgIHNlbGYuc2hvdWxkU2Nyb2xsVG9Cb3R0b21BZnRlcktleWJvYXJkU2hvd3MgPSBOTzsKICAgIHNlbGYuaW52ZXJ0ZWQgPSBZRVM7CiAgICAKICAgIFVJTmliICpjZWxsTmliID0gW1VJTmliIG5pYldpdGhOaWJOYW1lOkNoYXRDZWxsSWRlbnRpZmllciBidW5kbGU6bmlsXTsKICAgIFtzZWxmLnRhYmxlVmlldyByZWdpc3Rlck5pYjpjZWxsTmliCiAgICAgICAgIGZvckNlbGxSZXVzZUlkZW50aWZpZXI6Q2hhdENlbGxJZGVudGlmaWVyXTsKICAgIAogICAgVUlOaWIgKmNlbGxTdGF0dXNOaWIgPSBbVUlOaWIgbmliV2l0aE5pYk5hbWU6Q2hhdFN0YXR1c0NlbGxJZGVudGlmaWVyIGJ1bmRsZTpuaWxdOwogICAgW3NlbGYudGFibGVWaWV3IHJlZ2lzdGVyTmliOmNlbGxTdGF0dXNOaWIKICAgICAgICAgZm9yQ2VsbFJldXNlSWRlbnRpZmllcjpDaGF0U3RhdHVzQ2VsbElkZW50aWZpZXJdOwogICAgCiAgICBzZWxmLnRleHRJbnB1dGJhci5hdXRvSGlkZVJpZ2h0QnV0dG9uID0gWUVTOwogICAgc2VsZi50ZXh0SW5wdXRiYXIubWF4Q2hhckNvdW50ID0gMjU2OwogICAgc2VsZi50ZXh0SW5wdXRiYXIuY291bnRlclN0eWxlID0gU0xLQ291bnRlclN0eWxlU3BsaXQ7CiAgICBzZWxmLnRleHRJbnB1dGJhci5jb3VudGVyUG9zaXRpb24gPSBTTEtDb3VudGVyUG9zaXRpb25Ub3A7CiAgICAKICAgIFVJRm9udCAqZm9udCA9IFtVSUZvbnQgZm9udFdpdGhOYW1lOkAiQXZlbmlyLUxpZ2h0IiBzaXplOjE0XTsKICAgIFtzZWxmLnRleHRWaWV3IHNldEZvbnQ6Zm9udF07CiAgICAKICAgIFtzZWxmLnJpZ2h0QnV0dG9uIHNldFRpdGxlQ29sb3I6W1VJQ29sb3IgY29sb3JXaXRoUmVkOjAuOTczIGdyZWVuOjAuNTU3IGJsdWU6MC41MDIgYWxwaGE6MV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yU3RhdGU6VUlDb250cm9sU3RhdGVOb3JtYWxdOwogICAgCiAgICBmb250ID0gW1VJRm9udCBmb250V2l0aE5hbWU6QCJBdmVuaXItSGVhdnkiIHNpemU6MTddOwogICAgW3NlbGYubmF2aWdhdGlvbkNvbnRyb2xsZXIubmF2aWdhdGlvbkJhciBzZXRUaXRsZVRleHRBdHRyaWJ1dGVzOgogICAgIEB7TlNGb250QXR0cmlidXRlTmFtZTpmb250fV07CiAgICAKICAgIHNlbGYudGFibGVWaWV3LmVzdGltYXRlZFJvd0hlaWdodCA9IDcwOwogICAgc2VsZi50YWJsZVZpZXcucm93SGVpZ2h0ID0gVUlUYWJsZVZpZXdBdXRvbWF0aWNEaW1lbnNpb247CiAgICBzZWxmLnRhYmxlVmlldy5zZXBhcmF0b3JTdHlsZSA9IFVJVGFibGVWaWV3Q2VsbFNlcGFyYXRvclN0eWxlTm9uZTsKICAgIAogICAgaWYgKCFfY2hhbm5lbCkKICAgIHsKICAgICAgICBzZWxmLmNoYW5uZWwgPSBbQ2hhbm5lbE1hbmFnZXIgc2hhcmVkTWFuYWdlcl0uZ2VuZXJhbENoYXRyb29tOwogICAgfQp9CgotICh2b2lkKXZpZXdEaWRBcHBlYXI6KEJPT0wpYW5pbWF0ZWQgewogICAgW3N1cGVyIHZpZXdEaWRBcHBlYXI6YW5pbWF0ZWRdOwogICAgW3NlbGYgc2Nyb2xsVG9Cb3R0b21NZXNzYWdlXTsKfQoKLSAoTlNNdXRhYmxlT3JkZXJlZFNldCAqKW1lc3NhZ2VzIHsKICAgIGlmICghX21lc3NhZ2VzKSB7CiAgICAgICAgX21lc3NhZ2VzID0gW1tOU011dGFibGVPcmRlcmVkU2V0IGFsbG9jXSBpbml0XTsKICAgIH0KICAgIHJldHVybiBfbWVzc2FnZXM7Cn0KCi0gKHZvaWQpc2V0Q2hhbm5lbDooVFdNQ2hhbm5lbCAqKWNoYW5uZWwgewogICAgX2NoYW5uZWwgPSBjaGFubmVsOwogICAgc2VsZi50aXRsZSA9IHNlbGYuY2hhbm5lbC5mcmllbmRseU5hbWU7CiAgICAKICAgIGlmIChzZWxmLmNoYW5uZWwgPT0gW0NoYW5uZWxNYW5hZ2VyIHNoYXJlZE1hbmFnZXJdLmdlbmVyYWxDaGF0cm9vbSkgewogICAgICAgIHNlbGYubmF2aWdhdGlvbkl0ZW0ucmlnaHRCYXJCdXR0b25JdGVtID0gbmlsOwogICAgfQogICAKICAgIGlmIChzZWxmLmNoYW5uZWwuc3RhdHVzID09IFRXTUNoYW5uZWxTdGF0dXNKb2luZWQpCiAgICB7CiAgICAgICAgW3NlbGYgbG9hZE1lc3NhZ2VzXTsKICAgICAgICBzZWxmLmNoYW5uZWwuZGVsZWdhdGUgPSBzZWxmOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgW1VJQXBwbGljYXRpb24gc2hhcmVkQXBwbGljYXRpb25dLm5ldHdvcmtBY3Rpdml0eUluZGljYXRvclZpc2libGUgPSBZRVM7CiAgICAgICAgc2VsZi50ZXh0SW5wdXRiYXJIaWRkZW4gPSBZRVM7CiAgICAgICAgW3NlbGYuY2hhbm5lbCBqb2luV2l0aENvbXBsZXRpb246XihUV01SZXN1bHQgcmVzdWx0KSB7CiAgICAgICAgICAgIGRpc3BhdGNoX2FzeW5jKGRpc3BhdGNoX2dldF9nbG9iYWxfcXVldWUoRElTUEFUQ0hfUVVFVUVfUFJJT1JJVFlfREVGQVVMVCwgMCksIF57CiAgICAgICAgICAgICAgICBbc2VsZiBsb2FkTWVzc2FnZXNdOwogICAgICAgICAgICAgICAgZGlzcGF0Y2hfYXN5bmMoZGlzcGF0Y2hfZ2V0X21haW5fcXVldWUoKSwgXnsKICAgICAgICAgICAgICAgICAgICBzZWxmLmNoYW5uZWwuZGVsZWdhdGUgPSBzZWxmOwogICAgICAgICAgICAgICAgICAgIFtVSUFwcGxpY2F0aW9uIHNoYXJlZEFwcGxpY2F0aW9uXS5uZXR3b3JrQWN0aXZpdHlJbmRpY2F0b3JWaXNpYmxlID0gTk87CiAgICAgICAgICAgICAgICAgICAgW3NlbGYgc2V0VGV4dElucHV0YmFySGlkZGVuOk5PIGFuaW1hdGVkOllFU107CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfV07CiAgICB9Cn0KCi0gKE5TSW50ZWdlciludW1iZXJPZlNlY3Rpb25zSW5UYWJsZVZpZXc6KFVJVGFibGVWaWV3ICopdGFibGVWaWV3IHsKICAgIHJldHVybiAxOwp9CgotIChOU0ludGVnZXIpdGFibGVWaWV3OihVSVRhYmxlVmlldyAqKXRhYmxlVmlldyBudW1iZXJPZlJvd3NJblNlY3Rpb246KE5TSW50ZWdlcilzZWN0aW9uIHsKICAgIHJldHVybiBzZWxmLm1lc3NhZ2VzLmNvdW50Owp9CgotIChVSVRhYmxlVmlld0NlbGwgKil0YWJsZVZpZXc6KFVJVGFibGVWaWV3ICopdGFibGVWaWV3IGNlbGxGb3JSb3dBdEluZGV4UGF0aDooTlNJbmRleFBhdGggKilpbmRleFBhdGggewogICAgVUlUYWJsZVZpZXdDZWxsICpjZWxsID0gbmlsOwogICAgCiAgICBpZCBtZXNzYWdlID0gW3NlbGYubWVzc2FnZXMgb2JqZWN0QXRJbmRleDppbmRleFBhdGgucm93XTsKICAgIAogICAgaWYgKFttZXNzYWdlIGlzS2luZE9mQ2xhc3M6W1RXTU1lc3NhZ2UgY2xhc3NdXSkgewogICAgICAgIGNlbGwgPSBbc2VsZiBnZXRDaGF0Q2VsbEZvclRhYmxlVmlldzp0YWJsZVZpZXcgZm9ySW5kZXhQYXRoOmluZGV4UGF0aCBtZXNzYWdlOm1lc3NhZ2VdOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgY2VsbCA9IFtzZWxmIGdldFN0YXR1Q2VsbEZvclRhYmxlVmlldzp0YWJsZVZpZXcgZm9ySW5kZXhQYXRoOmluZGV4UGF0aCBtZXNzYWdlOm1lc3NhZ2VdOwogICAgfQogICAgCiAgICBjZWxsLnRyYW5zZm9ybSA9IHRhYmxlVmlldy50cmFuc2Zvcm07CiAgICByZXR1cm4gY2VsbDsKfQoKLSAoQ2hhdFRhYmxlQ2VsbCAqKWdldENoYXRDZWxsRm9yVGFibGVWaWV3OihVSVRhYmxlVmlldyAqKXRhYmxlVmlldwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JJbmRleFBhdGg6KE5TSW5kZXhQYXRoICopaW5kZXhQYXRoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTooVFdNTWVzc2FnZSAqKW1lc3NhZ2UgewogICAgVUlUYWJsZVZpZXdDZWxsICpjZWxsID0gW3NlbGYudGFibGVWaWV3IGRlcXVldWVSZXVzYWJsZUNlbGxXaXRoSWRlbnRpZmllcjpDaGF0Q2VsbElkZW50aWZpZXIgZm9ySW5kZXhQYXRoOmluZGV4UGF0aF07CiAgICAKICAgIENoYXRUYWJsZUNlbGwgKmNoYXRDZWxsID0gKENoYXRUYWJsZUNlbGwgKiljZWxsOwogICAgY2hhdENlbGwudXNlciA9IG1lc3NhZ2UuYXV0aG9yOwogICAgY2hhdENlbGwuZGF0ZSA9IFtOU0RhdGUgZGF0ZVdpdGhJU084NjAxU3RyaW5nOm1lc3NhZ2UudGltZXN0YW1wXTsKICAgIGNoYXRDZWxsLm1lc3NhZ2UgPSBtZXNzYWdlLmJvZHk7CiAgICAKICAgIHJldHVybiBjaGF0Q2VsbDsKfQoKLSAoVUlUYWJsZVZpZXdDZWxsICopZ2V0U3RhdHVDZWxsRm9yVGFibGVWaWV3OihVSVRhYmxlVmlldyAqKXRhYmxlVmlldwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JJbmRleFBhdGg6KE5TSW5kZXhQYXRoICopaW5kZXhQYXRoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTooU3RhdHVzRW50cnkgKiltZXNzYWdlIHsKICAgIFVJVGFibGVWaWV3Q2VsbCAqY2VsbCA9IFtzZWxmLnRhYmxlVmlldyBkZXF1ZXVlUmV1c2FibGVDZWxsV2l0aElkZW50aWZpZXI6Q2hhdFN0YXR1c0NlbGxJZGVudGlmaWVyIGZvckluZGV4UGF0aDppbmRleFBhdGhdOwogICAgCiAgICBVSUxhYmVsICpsYWJlbCA9IFtjZWxsIHZpZXdXaXRoVGFnOjIwMF07CiAgICBsYWJlbC50ZXh0ID0gW05TU3RyaW5nIHN0cmluZ1dpdGhGb3JtYXQ6QCJVc2VyICVAIGhhcyAlQCIsCiAgICAgICAgICAgICAgICAgIG1lc3NhZ2UubWVtYmVyLmlkZW50aXR5LAogICAgICAgICAgICAgICAgICAobWVzc2FnZS5zdGF0dXMgPT0gTWVtYmVyU3RhdHVzSm9pbmVkPyBAImpvaW5lZCIgOiBAImxlZnQiKV07CiAgICAKICAgIHJldHVybiBjZWxsOwp9CgotICh2b2lkKWRpZFByZXNzUmlnaHRCdXR0b246KGlkKXNlbmRlciB7CiAgICBbc2VsZi50ZXh0VmlldyByZWZyZXNoRmlyc3RSZXNwb25kZXJdOwogICAgW3NlbGYgc2VuZE1lc3NhZ2U6IFtzZWxmLnRleHRWaWV3LnRleHQgY29weV1dOwogICAgW3N1cGVyIGRpZFByZXNzUmlnaHRCdXR0b246c2VuZGVyXTsKfQoKI3ByYWdtYSBtYXJrIENoYXQgU2VydmljZQotICh2b2lkKXNlbmRNZXNzYWdlOiAoTlNTdHJpbmcgKilpbnB1dE1lc3NhZ2UgewogICAgVFdNTWVzc2FnZSAqbWVzc2FnZSA9IFtzZWxmLmNoYW5uZWwubWVzc2FnZXMgY3JlYXRlTWVzc2FnZVdpdGhCb2R5OmlucHV0TWVzc2FnZV07CiAgICBbc2VsZi5jaGFubmVsLm1lc3NhZ2VzIHNlbmRNZXNzYWdlOm1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRpb246XihUV01SZXN1bHQgcmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCA9PSBUV01SZXN1bHRGYWlsdXJlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5TTG9nKEAic2VuZCBtZXNzYWdlIGVycm9yIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfV07Cn0KCgoKLSAodm9pZClhZGRNZXNzYWdlczooTlNBcnJheSAqKW1lc3NhZ2VzIHsKICAgIFtzZWxmLm1lc3NhZ2VzIGFkZE9iamVjdHNGcm9tQXJyYXk6bWVzc2FnZXNdOwogICAgW3NlbGYgc29ydE1lc3NhZ2VzXTsKICAgIGRpc3BhdGNoX2FzeW5jKGRpc3BhdGNoX2dldF9tYWluX3F1ZXVlKCksIF57CiAgICAgICAgW3NlbGYudGFibGVWaWV3IHJlbG9hZERhdGFdOwogICAgICAgIGlmIChzZWxmLm1lc3NhZ2VzLmNvdW50ID4gMCkgewogICAgICAgICAgICBbc2VsZiBzY3JvbGxUb0JvdHRvbU1lc3NhZ2VdOwogICAgICAgIH0KICAgIH0pOwp9CgoKLSAodm9pZClzb3J0TWVzc2FnZXMgewogICAgW3NlbGYubWVzc2FnZXMgc29ydFVzaW5nRGVzY3JpcHRvcnM6QFtbW05TU29ydERlc2NyaXB0b3IgYWxsb2NdIGluaXRXaXRoS2V5OkAidGltZXN0YW1wIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNjZW5kaW5nOk5PXV1dOwp9CgotICh2b2lkKXNjcm9sbFRvQm90dG9tTWVzc2FnZSB7CiAgICBpZiAoc2VsZi5tZXNzYWdlcy5jb3VudCA9PSAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgCiAgICBOU0luZGV4UGF0aCAqYm90dG9tTWVzc2FnZUluZGV4ID0gW05TSW5kZXhQYXRoIGluZGV4UGF0aEZvclJvdzowCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluU2VjdGlvbjowXTsKICAgIFtzZWxmLnRhYmxlVmlldyBzY3JvbGxUb1Jvd0F0SW5kZXhQYXRoOmJvdHRvbU1lc3NhZ2VJbmRleAogICAgICAgICAgICAgICAgICAgICAgICAgIGF0U2Nyb2xsUG9zaXRpb246VUlUYWJsZVZpZXdTY3JvbGxQb3NpdGlvbkJvdHRvbQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0ZWQ6Tk9dOwp9CgotICh2b2lkKWxvYWRNZXNzYWdlcyB7CiAgICBbc2VsZi5tZXNzYWdlcyByZW1vdmVBbGxPYmplY3RzXTsKICAgIFtzZWxmIGFkZE1lc3NhZ2VzOnNlbGYuY2hhbm5lbC5tZXNzYWdlcy5hbGxPYmplY3RzXTsKfQoKLSAodm9pZClsZWF2ZUNoYW5uZWwgewogICAgW3NlbGYuY2hhbm5lbCBsZWF2ZVdpdGhDb21wbGV0aW9uOl4oVFdNUmVzdWx0IHJlc3VsdCkgewogICAgICAgIGlmIChyZXN1bHQgPT0gVFdNUmVzdWx0U3VjY2VzcykgewogICAgICAgICAgICBbc2VsZi5yZXZlYWxWaWV3Q29udHJvbGxlci5yZWFyVmlld0NvbnRyb2xsZXIgcGVyZm9ybVNlZ3VlV2l0aElkZW50aWZpZXI6QCJPcGVuR2VuZXJhbENoYXQiIHNlbmRlcjpuaWxdOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgTlNMb2coQCJFcnJvciBsZWF2aW5nIGNoYW5uZWwiKTsKICAgICAgICB9CiAgICB9XTsKfQoKI3ByYWdtYSBtYXJrIC0gVE1NZXNzYWdlRGVsZWdhdGUKCi0gKHZvaWQpaXBNZXNzYWdpbmdDbGllbnQ6KFR3aWxpb0lQTWVzc2FnaW5nQ2xpZW50ICopY2xpZW50CiAgICAgICAgICAgICAgICAgIGNoYW5uZWw6KFRXTUNoYW5uZWwgKiljaGFubmVsCiAgICAgICAgICAgICBtZXNzYWdlQWRkZWQ6KFRXTU1lc3NhZ2UgKiltZXNzYWdlIHsKICAgIGlmICghW3NlbGYubWVzc2FnZXMgY29udGFpbnNPYmplY3Q6bWVzc2FnZV0pIHsKICAgICAgICBbc2VsZiBhZGRNZXNzYWdlczpAW21lc3NhZ2VdXTsKICAgIH0KfQoKLSAodm9pZClpcE1lc3NhZ2luZ0NsaWVudDooVHdpbGlvSVBNZXNzYWdpbmdDbGllbnQgKiljbGllbnQKICAgICAgICAgICBjaGFubmVsRGVsZXRlZDooVFdNQ2hhbm5lbCAqKWNoYW5uZWwgewogICAgZGlzcGF0Y2hfYXN5bmMoZGlzcGF0Y2hfZ2V0X21haW5fcXVldWUoKSwgXnsKICAgICAgICBpZiAoY2hhbm5lbCA9PSBzZWxmLmNoYW5uZWwpIHsKICAgICAgICAgICAgW3NlbGYucmV2ZWFsVmlld0NvbnRyb2xsZXIucmVhclZpZXdDb250cm9sbGVyIHBlcmZvcm1TZWd1ZVdpdGhJZGVudGlmaWVyOkAiT3BlbkdlbmVyYWxDaGF0IiBzZW5kZXI6bmlsXTsKICAgICAgICB9CiAgICB9KTsKfQoKLSAodm9pZClpcE1lc3NhZ2luZ0NsaWVudDooVHdpbGlvSVBNZXNzYWdpbmdDbGllbnQgKiljbGllbnQKICAgICAgICAgICAgICAgICAgY2hhbm5lbDooVFdNQ2hhbm5lbCAqKWNoYW5uZWwKICAgICAgICAgICAgIG1lbWJlckpvaW5lZDooVFdNTWVtYmVyICopbWVtYmVyIHsKICAgIFtzZWxmIGFkZE1lc3NhZ2VzOkBbW1N0YXR1c0VudHJ5IHN0YXR1c0VudHJ5V2l0aE1lbWJlcjptZW1iZXIgc3RhdHVzOk1lbWJlclN0YXR1c0pvaW5lZF1dXTsKfQoKLSAodm9pZClpcE1lc3NhZ2luZ0NsaWVudDooVHdpbGlvSVBNZXNzYWdpbmdDbGllbnQgKiljbGllbnQKICAgICAgICAgICAgICAgICAgY2hhbm5lbDooVFdNQ2hhbm5lbCAqKWNoYW5uZWwKICAgICAgICAgICAgICAgbWVtYmVyTGVmdDooVFdNTWVtYmVyICopbWVtYmVyIHsKICAgIFtzZWxmIGFkZE1lc3NhZ2VzOkBbW1N0YXR1c0VudHJ5IHN0YXR1c0VudHJ5V2l0aE1lbWJlcjptZW1iZXIgc3RhdHVzOk1lbWJlclN0YXR1c0xlZnRdXV07Cn0KCgojcHJhZ21hIG1hcmsgLSBBY3Rpb25zCgotIChJQkFjdGlvbilhY3Rpb25CdXR0b25Ub3VjaGVkOihVSUJhckJ1dHRvbkl0ZW0gKilzZW5kZXIgewogICAgW3NlbGYgbGVhdmVDaGFubmVsXTsKfQoKLSAoSUJBY3Rpb24pcmV2ZWFsQnV0dG9uVG91Y2hlZDooVUlCYXJCdXR0b25JdGVtICopc2VuZGVyIHsKICAgIFtzZWxmLnJldmVhbFZpZXdDb250cm9sbGVyIHJldmVhbFRvZ2dsZUFuaW1hdGVkOllFU107Cn0KCkBlbmQK</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div><a href="https://github.com/TwilioDevEd/twiliochat-objc" target="_blank" class="explorer-get-code"> <i class="fa fa-lg fa-github-square"> </i>View Code on GitHub</a></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>